{"meta":{"title":"BLOG","subtitle":"","description":"","author":"æ‹¦äº‘","url":"http://blog.3amupupup.online","root":"/"},"pages":[],"posts":[{"title":"nginxæ•°ç»„","slug":"ngx_array","date":"2021-03-18T05:25:40.825Z","updated":"2021-03-18T07:03:09.442Z","comments":true,"path":"2021/03/18/ngx_array/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/ngx_array/","excerpt":"","text":"nginxæ•°æ®ç±»å‹ï¼šæ•°ç»„ typedef struct { void *elts; // æŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆ ngx_uint_t nelts; // æœªä½¿ç”¨çš„å…ƒç´ çš„ç´¢å¼• size_t size; // æ¯ä¸ªå…ƒç´ å¤§å° ngx_uint_t nalloc; // å…ƒç´ ä¸ªæ•° ngx_pool_t *pool; // å†…å­˜æ±  } ngx_array_t; æ•°ç»„æä¾›çš„æ¥å£ngx_array_t *ngx_array_create(ngx_pool_t *p, ngx_uint_t n, size_t size); // åˆ›å»ºæ•°ç»„çš„æ•°æ®ç»“æ„ void ngx_array_destroy(ngx_array_t *a); // é”€æ¯æ•°ç»„ void *ngx_array_push(ngx_array_t *a); // pushå•ä¸ªå…ƒç´  void *ngx_array_push_n(ngx_array_t *a, ngx_uint_t n); // push nä¸ªå…ƒç´  static ngx_inline ngx_int_t ngx_array_init(ngx_array_t *array, ngx_pool_t *pool, ngx_uint_t n, size_t size) // // ngx_array_createä¼šè°ƒç”¨æ­¤å‡½æ•°ï¼Œç”³è¯·ä¹‹åè°ƒç”¨è¿™ä¸ªå‡½æ•°è¿›è¡Œåˆå§‹åŒ–æ“ä½œ ngx_array_t *ngx_array_create(ngx_pool_t *p, ngx_uint_t n, size_t size);ngx_array_t * ngx_array_create(ngx_pool_t *p, ngx_uint_t n, size_t size) { ngx_array_t *a; // åœ¨å†…å­˜æ± ä¸Šä¸ºngx_array_tç»“æ„ä½“ç”³è¯·å†…å­˜,å…·ä½“åˆ†é…åˆ°å°æ•°æ®å—é“¾è¡¨è¿˜æ˜¯å¤§æ•°æ®å—é“¾è¡¨å–å†³äºsize,ä¸å†ä½œè§£é‡Š a = ngx_palloc(p, sizeof(ngx_array_t)); if (a == NULL) { return NULL; } if (ngx_array_init(a, p, n, size) != NGX_OK) { // å†æ¬¡ç”³è¯·å†…å­˜(ç»™æ•°ç»„åˆ†é…çš„) return NULL; } return a; } static ngx_inline ngx_int_t ngx_array_init(ngx_array_t *array, ngx_pool_t *pool, ngx_uint_t n, size_t size)// ngx_array_createä¼šè°ƒç”¨æ­¤å‡½æ•°ï¼Œç”³è¯·ä¹‹åè¿›è¡Œåˆå§‹åŒ–æ“ä½œ static ngx_inline ngx_int_t ngx_array_init(ngx_array_t *array, ngx_pool_t *pool, ngx_uint_t n, size_t size) { /* * set &quot;array-&gt;nelts&quot; before &quot;array-&gt;elts&quot;, otherwise MSVC thinks * that &quot;array-&gt;nelts&quot; may be used without having been initialized */ array-&gt;nelts = 0; array-&gt;size = size; array-&gt;nalloc = n; array-&gt;pool = pool; array-&gt;elts = ngx_palloc(pool, n * size); // å»å†…å­˜æ± ä¸Šåˆ†é…å†…å­˜ if (array-&gt;elts == NULL) { return NGX_ERROR; } return NGX_OK; } void ngx_array_destroy(ngx_array_t *a) /* * åœ¨ ngx_array_create() å‡½æ•°ä¸­ ngx_array_tç»“æ„çš„å†…å­˜å’Œæ•°ç»„çš„å†…å­˜æ˜¯åˆ†å¼€ç”³è¯·çš„ï¼Œä¸ä¸€å®šè¿ç»­ï¼Œ * æ‰€ä»¥åœ¨å°†å†…å­˜å½’è¿˜ç»™å†…å­˜æ± çš„æ—¶å€™ä¹Ÿå¾—åˆ†å¼€å½’è¿˜ */ void ngx_array_destroy(ngx_array_t *a) { ngx_pool_t *p; p = a-&gt;pool; // å†…å­˜æ± çš„åœ°å€æ˜¯è¢«ä¿å­˜åœ¨ngxæ•°ç»„æ•°æ®ç»“æ„ä¸­çš„ /* * å¦‚æœ æ•°ç»„é¦–å…ƒç´ åœ°å€ + å…ƒç´ å¤§å°*å…ƒç´ ä¸ªæ•° == lastçš„æŒ‡å‘ä½ç½®ï¼Œ * åˆ™è¯´æ˜è¿™ä¸ªæ•°ç»„çš„å†…å­˜æ®µæ˜¯åœ¨usedåŒºåŸŸçš„å°¾éƒ¨çš„ï¼Œlastç›´æ¥å‡å» å…ƒç´ å¤§å°*å…ƒç´ ä¸ªæ•° å°±ä»£è¡¨é”€æ¯äº†è¿™ä¸ªæ•°ç»„çš„å†…å­˜ */ if ((u_char *) a-&gt;elts + a-&gt;size * a-&gt;nalloc == p-&gt;d.last) { p-&gt;d.last -= a-&gt;size * a-&gt;nalloc; } /* * é“ç†å’Œä¸Šé¢ç±»ä¼¼ */ if ((u_char *) a + sizeof(ngx_array_t) == p-&gt;d.last) { p-&gt;d.last = (u_char *) a; } // å¦åˆ™å°±ä¸èƒ½ç§»åŠ¨last } 1ã€3æ˜¯å¯ä»¥ä¿®æ”¹lastæŒ‡å‘çš„ï¼Œ2ã€4ä¸è¡Œã€‚ è¿™é‡Œæœ‰ç–‘é—®ï¼š2ã€4è¿™ä¸¤ç§æƒ…å†µå†…å­˜å²‚ä¸æ˜¯æ— æ³•é‡Šæ”¾(å½’è¿˜ç»™å†…å­˜æ± )ï¼Œå†…å­˜æ± ä¼šè¶Šæ¥è¶Šå¤§ã€‚ void *ngx_array_push(ngx_array_t *a)void * ngx_array_push(ngx_array_t *a) // æ·»åŠ 1ä¸ªå…ƒç´  { void *elt, *new; size_t size; ngx_pool_t *p; if (a-&gt;nelts == a-&gt;nalloc) { /* the array is full */ size = a-&gt;size * a-&gt;nalloc; // è®¡ç®—å½“å‰æ•°ç»„çš„å¤§å° p = a-&gt;pool; if ((u_char *) a-&gt;elts + size == p-&gt;d.last &amp;&amp; p-&gt;d.last + a-&gt;size &lt;= p-&gt;d.end) /* * å¦‚æœeltsæŒ‡å‘çš„ä½ç½®åŠ ä¸Šå½“å‰æ•°ç»„çš„å¤§å°ç­‰äºlastä¸”laståˆ°endä¹‹é—´æœ‰è¶³å¤Ÿçš„ç©ºé—´å»å®¹çº³ä¸€ä¸ªå…ƒç´ åˆ™ç›´æ¥åœ¨è¿™ä¸ªå†…å­˜æ± ä¸Šæ·»åŠ å…ƒç´  * è¿™ä¸ªåˆ¤å®šæ˜¯è¦ä¿è¯æ·»åŠ çš„å…ƒç´ æ‰€åœ¨çš„å†…å­˜ä¸ä¹‹å‰æ•°ç»„çš„å†…å­˜æ˜¯è¿ç»­çš„ */ { /* * the array allocation is the last in the pool * and there is space for new allocation */ p-&gt;d.last += a-&gt;size; a-&gt;nalloc++; } else { // å¦åˆ™å°±æ˜¯ä¸èƒ½ä¿è¯å†…å­˜è¿ç»­æˆ–è€…ç©ºé—´ä¸è¶³ /* allocate a new array */ // ç”³è¯·ä¸€ä¸ªä¸¤å€çš„ç©ºé—´ï¼Œnewæ˜¯é¦–åœ°å€ new = ngx_palloc(p, 2 * size); if (new == NULL) { return NULL; } // #define ngx_memcpy(dst, src, n) (void) memcpy(dst, src, n) çœ‹åˆ°è¿™ä¸ªğŸ‘´ğŸ»æƒ³ç¬‘ ngx_memcpy(new, a-&gt;elts, size); // å°†åŸæ¥çš„å†…å­˜åœ°å€ä¸Šçš„æ•°ç»„éƒ¨åˆ†çš„å†…å®¹æ‹·è´åˆ°æ–°å†…å­˜æ± ä¸Š a-&gt;elts = new; // æŒ‡å‘æ–°å†…å­˜çš„ä½ç½® a-&gt;nalloc *= 2; // å…ƒç´ ä¸ªæ•°ç¿»å€ } } // æœªä½¿ç”¨çš„ç´¢å¼• elt = (u_char *) a-&gt;elts + a-&gt;size * a-&gt;nelts; a-&gt;nelts++; return elt; } void *ngx_array_push_n(ngx_array_t *a, ngx_uint_t n)void * ngx_array_push_n(ngx_array_t *a, ngx_uint_t n) { void *elt, *new; size_t size; ngx_uint_t nalloc; ngx_pool_t *p; size = n * a-&gt;size; if (a-&gt;nelts + n &gt; a-&gt;nalloc) { /* the array is full */ p = a-&gt;pool; /* * å¦‚æœeltsæŒ‡å‘çš„ä½ç½®åŠ ä¸Šå½“å‰æ•°ç»„çš„å¤§å°ç­‰äºlast ä¸” laståˆ°endä¹‹é—´ æœ‰è¶³å¤Ÿçš„ç©ºé—´å»å®¹çº³nä¸ªå…ƒç´ åˆ™ç›´æ¥åœ¨è¿™ä¸ªå†…å­˜æ± ä¸Šæ·»åŠ å…ƒç´  * è¿™ä¸ªåˆ¤å®šæ˜¯è¦ä¿è¯æ·»åŠ çš„å…ƒç´ æ‰€åœ¨çš„å†…å­˜ä¸ä¹‹å‰æ•°ç»„çš„å†…å­˜æ˜¯è¿ç»­çš„ */ if ((u_char *) a-&gt;elts + a-&gt;size * a-&gt;nalloc == p-&gt;d.last &amp;&amp; p-&gt;d.last + size &lt;= p-&gt;d.end) { /* * the array allocation is the last in the pool * and there is space for new allocation */ p-&gt;d.last += size; // size = n * a-&gt;size; è°ƒæ•´lastçš„æŒ‡å‘ a-&gt;nalloc += n; // æ›´æ–°å…ƒç´ ä¸ªæ•° } else { // å¦åˆ™æ‰©å®¹ /* allocate a new array */ nalloc = 2 * ((n &gt;= a-&gt;nalloc) ? n : a-&gt;nalloc); new = ngx_palloc(p, nalloc * a-&gt;size); if (new == NULL) { return NULL; } ngx_memcpy(new, a-&gt;elts, a-&gt;nelts * a-&gt;size); // å®å‡½æ•°ï¼Œå®é™…ä¸Šè°ƒç”¨çš„memcpyå‡½æ•° a-&gt;elts = new; a-&gt;nalloc = nalloc; } } elt = (u_char *) a-&gt;elts + a-&gt;size * a-&gt;nelts; a-&gt;nelts += n; return elt; }","categories":[{"name":"Cè¯­è¨€","slug":"Cè¯­è¨€","permalink":"http://blog.3amupupup.online/categories/C%E8%AF%AD%E8%A8%80/"}],"tags":[{"name":"nginx","slug":"nginx","permalink":"http://blog.3amupupup.online/tags/nginx/"}]},{"title":"æ’åº","slug":"æ’åº","date":"2021-03-18T03:09:52.078Z","updated":"2021-03-18T03:09:52.078Z","comments":true,"path":"2021/03/18/æ’åº/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/%E6%8E%92%E5%BA%8F/","excerpt":"","text":"å†’æ³¡æ’åº æ’åºæ€æƒ³ ä¸€ä¸ªæ— åºæ•°åˆ—ï¼Œä»ç¬¬ä¸€ä¸ªæ•°å¼€å§‹ï¼Œå¾ªç¯æ¯”è¾ƒç›¸é‚»ä¸¤ä¸ªæ•°çš„å¤§å°ï¼Œå¦‚æœå‰ä¸€ä¸ªæ•°å¤§äºåä¸€ä¸ªæ•°åˆ™äº¤æ¢å®ƒä»¬çš„ä½ç½®(å‡åº)ã€‚ ç¤ºæ„å›¾ ä¸€ä¸ªæ•°åˆ—ï¼š10 9 8 7 6 5 4 3 2 1 å®ç° void BubbleSort(int* arr, int arrSize) { for (int i = 0; i &lt; arrSize-1; ++i) { int flag = 0; for (int j = 0; j &lt; arrSize-i-1; ++j) // æ¯å¾ªç¯ä¸€æ¬¡æ„å‘³ç€ä¸€ä¸ªæœ€å¤§çš„æ•°è¢«ç§»åŠ¨åˆ°äº†æ•°ç»„æœ«å°¾ï¼Œåœ¨ä¸‹ä¸€æ¬¡å¾ªç¯æ—¶æœ€åä¸€ä¸ªæ•°æ²¡å¿…è¦å‚ä¸æ¯”è¾ƒ { if(arr[j] &gt; arr[j+1]) { flag = 1; // åˆ¤æ–­å¾ªç¯æ—¶æ˜¯å¦å‘ç”Ÿäº¤æ¢ï¼Œæ²¡æœ‰å‘ç”Ÿäº¤æ¢åˆ™è¯´æ˜å·²ç»æœ‰åºï¼Œç›´æ¥é€€å‡ºã€‚ int temp = arr[j]; arr[j] = arr[j+1]; arr[j+1] = temp; } } if (!flag) return; } } ç†è§£ å†’æ³¡æ’åºæ¯è¿­ä»£ä¸€æ¬¡æ•°ç»„ï¼Œæœ€å¤§æ•°ä¼šè¢«å†’åˆ°æœ€åï¼Œåœ¨ä¸‹ä¸€æ¬¡è¿­ä»£æ—¶æ’é™¤æ‰ä¹‹å‰è¿­ä»£å†’çš„å¤§æ•°ã€‚ æ—¶é—´å¤æ‚åº¦ï¼šN-1 + N-2 + â€¦â€¦ + 1 å³ O(N^2)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šåœ¨æ’åºè¿‡ç¨‹ä¸­æ— éœ€å€ŸåŠ©å…¶å®ƒç©ºé—´ä¿å­˜æ•°æ®ï¼Œå³O(1)ã€‚ ç›´æ¥æ’å…¥æ’åº æ’åºæ€æƒ³ ä¸€ä¸ªæ— åºæ•°åˆ—ï¼Œå‡è®¾å‰nä¸ªæ•°æ˜¯æœ‰åºçš„ï¼Œä¾æ¬¡å–å‡ºnä¹‹åçš„æ•°å­—ä¸ n=&gt;0 è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå°äºnåˆ™æ’å…¥åˆ°nä¹‹å‰(å‡åº)ã€‚ ç¤ºæ„å›¾ å®ç° void InsertSort(int* arr, int arrSize) { for (int i = 0; i &lt; arrSize-1; ++i) { int end = i; // å‡è®¾ 0-endæ˜¯æœ‰åºæ•°åˆ—ï¼Œç¬¬ä¸€æ¬¡endå°±æ˜¯0,æ‹¿arr[1]å’Œarr[0]æ¯”è¾ƒ int temp = arr[end+1]; // é€‰å‡ºendä¹‹åçš„ç¬¬ä¸€ä¸ªæ•° while (end &gt;= 0) { if(temp &lt; arr[end]) // å‡åº { arr[end+1] = arr[end]; // å¦‚æœtempå°äºarr[end]ï¼Œåˆ™è¯´æ˜è¦å°†endå¾€åæŒªä¸€æ¬¡ end--; // ç„¶åendç»§ç»­å¾€å‰èµ°,ç»§ç»­åˆ¤æ–­tempæ˜¯å¦å°äºarr[end] } else { break; // ä¸å°äºarr[end]æ—¶ç›´æ¥è·³å‡ºå¾ªç¯ } } arr[end+1] = temp; } } å¸Œå°”æ’åº æ’åºæ€æƒ³ å¸Œå°”æ’åºæ˜¯åœ¨æ’å…¥æ’åºçš„åŸºç¡€ä¸Šåšçš„ä¼˜åŒ–ã€‚æ’å…¥æ’åºä¸­ï¼Œå¦‚æœå€¼å¤§å°åˆ†å¸ƒè¶Šä¸å‡åŒ€ï¼Œåœ¨é€‰æ‹©ä¸€ä¸ªæ•°ä¸æœ‰åºåºåˆ—æ¯”è¾ƒæ—¶éœ€è¦ç§»åŠ¨endçš„æ¬¡æ•°ä¼šè¶Šå¤šï¼Œåºåˆ—è¶Šæ¥è¿‘æœ‰åºï¼Œéœ€è¦ç§»åŠ¨endçš„æ¬¡æ•°å°±ä¼šè¶Šå°‘ã€‚å¸Œå°”æ’åºåœ¨æ­¤åŸºç¡€ä¸Šï¼Œå°†åºåˆ—åˆ†æˆä¸è¿ç»­å¤šä¸ªç»„ï¼Œç„¶åè¿›è¡Œæ’å…¥æ’åºï¼Œè¿™ä¼šä½¿å¾—åºåˆ—èƒ½æ›´å¿«çš„æ¥è¿‘æœ‰åºã€‚ç›´è‡³é—´éš”ä¸º1æ—¶å°±æ˜¯æ’å…¥æ’åºï¼Œæ­¤æ—¶æ•°ç»„æ¥è¿‘æœ‰åºï¼Œæ•ˆç‡ä¼šæ›´é«˜ã€‚ ç¤ºæ„å›¾ å›¾ä¸­ï¼Œ2ã€5ã€13ä¸ºä¸€ç»„ï¼Œ5ã€3ã€3ä¸ºä¸€ç»„ï¼Œå‡åºæƒ…å†µä¸‹ï¼šé—´éš”è¶Šå¤§ï¼Œé‚£ä¹ˆæ’åœ¨é åä½ç½®çš„æ•°å°±æ›´åŠ å®¹æ˜“çš„è¢«æ’å…¥åœ¨æ•°ç»„é å‰çš„ä½ç½®ï¼Œæ¯”å¦‚arr[1]=5ã€arr[5]=3ã€arr[9]=3ï¼Œå¦‚æœæ˜¯æ’å…¥æ’åºï¼Œarr[9]=3 endéœ€è¦ç§»åŠ¨6æ¬¡æ‰èƒ½ä½¿arr[9]åˆ°è¾¾é å‰çš„ä½ç½®ï¼Œä½¿ç”¨å¸Œå°”æ’åºï¼Œendç§»åŠ¨ä¸¤æ¬¡å°±é å‰äº†ã€‚ä¼šä½¿æ•°ç»„æ›´å®¹æ˜“çš„æ¥è¿‘æœ‰åºã€‚ å®ç° void ShellSort(int* arr, int arrSize) { int gap = arrSize; while(gap &gt; 1) { gap = gap/3+1; // 2/3=0,ä¼šå¯¼è‡´æ’åºæå‰ç»“æŸ(gapè¿˜æ²¡ç­‰äº1å°±ç»“æŸäº†),æ‰€ä»¥æ¯æ¬¡ç»™gapåŠ ä¸Šä¸ª1ã€‚ for(int i = 0;i &lt; arrSize-gap;i++) // arrSizeä¸ºä»€ä¹ˆè¦å‡å»gap: å‡å¦‚æ•°ç»„é•¿åº¦æ˜¯10,gapç¬¬ä¸€æ¬¡å¾ªç¯ä¸º4ã€‚ // å¾ªç¯å¼€å§‹ä¹‹åï¼Œtempçš„ä¸‹æ ‡(ä¹Ÿå°±æ˜¯end+gap)ä¸èƒ½è¶…å‡ºæ•°ç»„èŒƒå›´å³:i+gap &lt; arrsize,ä¹Ÿå°±æ˜¯i&lt;arrSize-gap { int end = i; int temp = arr[end+gap]; while(end &gt;= 0) { if(temp &lt; arr[end]) { arr[end+gap] = arr[end]; end-=gap; } else { break; } } arr[end+gap] = temp; } } } å †æ’åº æ’åºæ€æƒ³ æœ‰åºæ•°åˆ—(æ•°ç»„)çš„åœ¨å†…å­˜ä¸Šå­˜å‚¨å½¢å¼æ˜¯çº¿æ€§çš„(ä¸€æ®µè¿ç»­çš„å†…å­˜)ï¼Œå…¶é€»è¾‘ç»“æ„æ˜¯äºŒå‰æ ‘(å®Œå…¨äºŒå‰æ ‘)ã€‚åˆ©ç”¨è¿™ä¸ªç‰¹æ€§å¯ä»¥å°†æ•°ç»„çœ‹æˆä¸€ä¸ªäºŒå‰æ ‘ï¼Œç„¶åè¿›è¡Œå»ºå †æ“ä½œã€‚ï¼ˆå¤§å †çš„çˆ¶ç»“ç‚¹å¤§äºå·¦å³å­©å­ç»“ç‚¹ï¼Œå°å †çš„çˆ¶ç»“ç‚¹å°äºå·¦å³å­©å­ç»“ç‚¹ï¼‰ï¼Œç„¶åæ¯æ¬¡å–å‡ºå †é¡¶çš„æ•°å†é‡æ–°å»ºå †ã€‚(å‡åºå»ºå¤§å †ï¼Œé™åºå»ºå°å †)ã€‚leftChild = parent*2+1ï¼ŒrightChile = parent*2+2ã€‚ ç¤ºæ„å›¾ å®ç° void Swap(int* a, int* b) { int temp = *a; *a = *b; *b= temp; } void AdJustDown(int* arr, int root, int arrSize) // å»ºå † { int parent = root; int child = parent*2 + 1; while (child &lt; arrSize) { if (child+1 &lt; arrSize &amp;&amp; arr[child+1] &gt; arr[child]) { child++; } if(arr[parent] &lt; arr[child]) { Swap(&amp;arr[parent],&amp;arr[child]); parent = child; child = parent*2+1; } else { break; } } } void HeapSort(int* arr, int arrSize) { for (int i = (arrSize-1-1)/2; i &gt;=0 ; --i) { AdJustDown(arr,i,arrSize); } int end = arrSize-1; while (end &gt; 0) { Swap(&amp;arr[end],&amp;arr[0]); AdJustDown(arr,0,end); end--; } } å¿«é€Ÿæ’åº æ’åºæ€æƒ³(å‡åº) å·¦å³ä¸¤ä¸ªæŒ‡é’ˆleftã€rightï¼Œå–ä¸€ä¸ªkeyå€¼ã€‚å·¦å³å¼€å§‹å‘å³å‘å·¦éå†ï¼Œå·¦æŒ‡é’ˆé‡è§æ¯”keyå¤§çš„æ•°åœæ­¢ç§»åŠ¨ï¼Œå³æŒ‡é’ˆé‡è§æ¯”keyå°çš„æ•°åœæ­¢ç§»åŠ¨ï¼Œæ­¤æ—¶äº¤æ¢å·¦å³æŒ‡é’ˆå¯¹åº”çš„å€¼ï¼Œç›´åˆ°å·¦å³æŒ‡é’ˆé‡åˆã€‚æ­¤æ—¶keyå·¦è¾¹çš„å€¼å…¨æ¯”keyå°ï¼Œå³è¾¹çš„å€¼å…¨æ¯”keyå¤§ã€‚å†é€šè¿‡åˆ†æ²»æ€æƒ³å¯¹keyå·¦å³ä¸¤è¾¹çš„åŒºé—´è¿›è¡Œé€’å½’æ“ä½œã€‚ ç¤ºæ„å›¾ ä»£ç å®ç° /* * ä¸‰æ•°å–ä¸­ * åœ¨æ•°ç»„æœ‰åºæ—¶(å‡è®¾æ˜¯é™åº),keyIndexæ¯æ¬¡éƒ½æ˜¯æœ€å°çš„æ•°çš„ä¸‹æ ‡ * ä¼šå¯¼è‡´å¿«æ’å˜æˆä¸€ä¸ªN^2çš„ç®—æ³•,ä¸‰æ•°å–ä¸­èƒ½æœ‰æ•ˆé¿å…è¿™ä¸ªç¼ºé™·ã€‚ */ int GetMidIdx(int* arr ,int left, int right) { int mid = (left+right)/2; if (arr[left] &lt; arr[mid]) { if (arr[mid] &lt; arr[right]) return mid; else if (arr[left] &gt; arr[right]) return left; else return right; } else { if (arr[mid] &gt; arr[right]) return mid; else if (arr[left] &lt; arr[right]) return left; else return right; } } int Part(int* arr, int left, int right) { int midIndex = GetMidIdx(arr,left,right); // æ‰¾å‡ºä¸­ä½æ•° Swap(&amp;arr[midIndex],&amp;arr[right]); int keyIndex = right; while(left &lt; right) { while(left &lt; right &amp;&amp; arr[left] &lt;= arr[keyIndex]) // å› ä¸ºæ˜¯leftå…ˆç§»åŠ¨,æ‰€ä»¥leftçš„æœ€ç»ˆåœç•™ä½ç½®çš„æ•°ä¸€å®šæ¯”keyIndexå¤§ left++; while(left &lt; right &amp;&amp; arr[right] &gt;= arr[keyIndex]) right--; Swap(&amp;arr[left], &amp;arr[right]); // å¾ªç¯èµ°åˆ°è¿™é‡Œæ—¶,leftä½ç½®çš„æ•°æ¯”keyIndexå¤§,rightä½ç½®çš„æ•°æ¯”keyIndexå°,å¯¹å®ƒä»¬è¿›è¡Œäº¤æ¢ } Swap(&amp;arr[keyIndex], &amp;arr[left]); // leftæœ€ç»ˆåœæ­¢çš„ä½ç½®å’ŒkeyIndexè¿›è¡Œäº¤æ¢,æ­¤æ—¶leftçš„å·¦è¾¹å…¨æ˜¯æ¯”é€‰å‡ºçš„keyIndexå°çš„æ•°,å³è¾¹å…¨æ˜¯æ¯”keyIndexå¤§çš„æ•°ã€‚ return left; // å¿…é¡»è¿”å›left,ä¸‹ä¸€æ¬¡æ’åºæ—¶å°±å¯ä»¥æ’é™¤æ‰leftï¼Œå¯¹leftå·¦å³çš„ä¸¤è¾¹çš„æ•°è¿›è¡Œæ’åº } void QuickSort(int* arr, int left, int right) { if(left &lt; right) { int div = Part(arr,left,right); QuickSort(arr,left,div-1); QuickSort(arr,div+1,right); } } void QuickSortNoR(int* arr, int left, int right) { Stack st; StackInit(&amp;st); StackPush(&amp;st,left); // æ³¨æ„è¿›æ ˆé¡ºåº,å…ˆè¿›çš„åè¢«å–å‡ºæ¥ StackPush(&amp;st,right); while(!StackEmpty(&amp;st)) // æ ˆä¸ä¸ºç©ºè¯´æ˜è¿˜å­˜åœ¨æ²¡è¢«æ’åºçš„åŒºé—´åˆ™è¦ç»§ç»­å¾ªç¯ { int _right = StackTop(&amp;st); StackPop(&amp;st); int _left = StackTop(&amp;st); StackPop(&amp;st); int div = Part(arr,_left,_right); if(div+1 &lt; _right) { StackPush(&amp;st,div+1); // ä¿è¯å…¥æ ˆé¡ºåºå’Œç¬¬ä¸€æ¬¡ä¸€è‡´ StackPush(&amp;st,_right); } if(_left &lt; div-1) { StackPush(&amp;st,_left); StackPush(&amp;st,div-1); } } StackDestory(&amp;st); } å½’å¹¶æ’åº æ’åºæ€æƒ³ åˆå¹¶æœ‰åºæ•°ç»„ ç¤ºæ„å›¾ å®ç° // å°†æ•°ç»„åˆ†å‰²æˆNä¸ªæœ‰åºå°åŒºé—´(1ä¸ªæ•°çš„åŒºé—´ï¼Œä¸€ä¸ªæ•°ä¹Ÿç®—æœ‰åº)ï¼Œå†åˆå¹¶æœ‰åºçš„æ•°ç»„ void _MergeSort(int* arr,int left, int right, int* tmp) { if(left&gt;=right) // åˆ†å‰²é€€å‡ºçš„æ¡ä»¶ return; int mid = (left+right)/2; // æ‹¿åˆ°ä¸­é—´ä½ç½®çš„ç´¢å¼•ï¼Œä¸‹ä¸€æ­¥é€’å½’åˆ†å‰²ï¼Œç›´åˆ°ä¸å¯åˆ†ä¸ºæ­¢(åˆ†å‰²åˆ°åªæœ‰ä¸€ä¸ªæ•°) _MergeSort(arr,left,mid,tmp); // é€’å½’åˆ†å‰²å·¦åŠè¾¹ _MergeSort(arr,mid+1,right,tmp); // é€’å½’åˆ†å‰²å³åŠè¾¹ int begin1 = left, end1 = mid; // èµ°åˆ°è¿™é‡Œè¯´æ˜å·²ç»åˆ†å‰²å®Œäº†ï¼Œåˆ†æˆäº†right+1ä¸ªä¸€ä¸ªå…ƒç´ çš„æ•°ç»„ int begin2 = mid+1, end2 = right; int index = begin1; // tmpåŒºé—´èµ·å§‹ä½ç½® while (begin1 &lt;= end1 &amp;&amp; begin2 &lt;= end2) // å½’å¹¶æœ‰åºæ•°ç»„ { if (arr[begin1] &lt; arr[begin2]) { tmp[index++] = arr[begin1++]; } else { tmp[index++] = arr[begin2++]; } } while (begin1&lt;=end1) tmp[index++] = arr[begin1++]; while (begin2&lt;=end2) tmp[index++] = arr[begin2++]; for (int i = left; i &lt;= right; ++i) // æ‹·è´å›åŸæ•°ç»„ï¼Œæ‹·è´ä¸€å®šæ˜¯ &lt;= é—­åŒºé—´ï¼Œå› ä¸ºrightä¼ å…¥çš„æ˜¯é—­åŒºé—´ { arr[i] = tmp[i]; } } // å½’å¹¶ï¼Œé€’å½’å®ç° void MergeSort(int* arr, int arrSize) { int* tmp = malloc(sizeof(int)*arrSize); _MergeSort(arr,0,arrSize-1,tmp); free(tmp); } // å½’å¹¶ï¼Œéé€’å½’å®ç° void _MergeSortNoR(int* arr, int begin1, int end1, int begin2, int end2, int* tmp) { PrintArr(arr,10); int left = begin1,right = end2; // è¿™é‡Œå¿…é¡»ä½¿ç”¨æ–°å˜é‡è®°å½•æ•°ç»„çš„èµ·å§‹ç»“æŸä½ç½®ï¼Œå› ä¸ºç»è¿‡è¿­ä»£åbegin1ä¼šè‡ªå¢ int index = begin1; // tmpåŒºé—´èµ·å§‹ä½ç½® while (begin1 &lt;= end1 &amp;&amp; begin2 &lt;= end2) // å½’å¹¶æœ‰åºæ•°ç»„ { if (arr[begin1] &lt; arr[begin2]) { tmp[index++] = arr[begin1++]; } else { tmp[index++] = arr[begin2++]; } } while (begin1&lt;=end1) tmp[index++] = arr[begin1++]; while (begin2&lt;=end2) tmp[index++] = arr[begin2++]; for (int i = left; i &lt;= right; ++i) { arr[i] = tmp[i]; } } void MergeSortNoR(int* arr, int arrSize) { int* tmp = (int*)malloc(sizeof(int)*arrSize); int gap = 1; while (gap&lt;arrSize) { for (int i = 0; i &lt; arrSize; i+=2*gap) { // [i,i+gap-1] [i+gap, i+2*gap-1] int begin1 = i, end1 = i+gap-1, begin2 = i+gap, end2 =i+gap*2-1; if (begin2 &gt;= arrSize) // begin2å¤§äºç­‰äºæ•°ç»„é•¿åº¦æ—¶è¯´æ˜åªå­˜åœ¨ä¸€ç»„æ•°æ®(æ— æ³•åˆ†å‰²æˆä¸¤ç»„) break; if (end2&gt;=arrSize) // end2å¤§äºç­‰äºæ•°ç»„é•¿åº¦åˆ™è¯´æ˜æ— æ³•åˆ†å‰²æˆå‡ç­‰çš„ä¸¤ç»„ï¼Œend2è¶…å‡ºäº†æ•°ç»„çš„èŒƒå›´ end2 = arrSize-1; // æ‰€ä»¥éœ€è¦è°ƒæ•´end2çš„ä½ç½®ï¼Œä½¿å…¶ä¸èƒ½è¶…å‡ºæ•°ç»„èŒƒå›´ _MergeSortNoR(arr,begin1,end1,begin2,end2,tmp); } gap*=2; } free(tmp); } è®¡æ•°æ’åº æ€æƒ³ è®°å½•ä¸€ä¸ªåºåˆ—ä¸­æ•°å­—å‡ºç°çš„æ¬¡æ•°ã€‚ æ‰¾å‡ºåºåˆ—ä¸­çš„æœ€å¤§å€¼ max ç„¶ååˆ›å»ºä¸€ä¸ªsizeä¸ºmax+1çš„tmpæ•°ç»„ï¼Œéå†æ•°æ®åºåˆ—ï¼Œæ‹¿åºåˆ—ä¸­çš„å€¼åštmpæ•°ç»„çš„ä¸‹æ ‡ï¼Œtmpå¯¹åº”ä¸‹æ ‡çš„å€¼è¿›è¡Œ++ è®¡æ•°ã€‚éå†ç»“æŸåï¼Œä¾æ¬¡ä»tmpä¸­å–å€¼æ‹·è´åˆ°åŸåºåˆ—ä¸­ï¼Œtmpçš„ä¸‹æ ‡ä½œä¸ºåºåˆ—çš„å€¼ï¼Œtmpä¸‹æ ‡å¯¹åº”çš„å€¼ä½œä¸ºæ‹·è´çš„æ¬¡æ•°ã€‚ ç¤ºæ„å›¾ å®ç° void CountSort(int* arr, int arrSize) { int min = arr[0]; int max = arr[0]; // æ‰¾å‡ºæœ€å¤§æœ€å°çš„å€¼ for (int i = 0; i &lt; arrSize; ++i) { if (arr[i] &gt; max) { max = arr[i]; } if (arr[i] &lt; min) { min = arr[i]; } } int range = max-min+1; // åˆ›å»ºä¸€ä¸ªrange+1å¤§å°çš„æ•°ç»„ï¼Œåˆ©ç”¨ç›¸å¯¹ä½ç½®å­˜å‚¨è®¡æ•°ï¼Œè¿˜åŸæ—¶tmpæ•°ç»„ä¸‹æ ‡åŠ ä¸Šminå°±æ˜¯åŸæ•°ç»„çš„å€¼ int* countArray = (int*)malloc(sizeof(int)*range); if (!countArray) { printf(&quot;malloc failed.\\n&quot;); exit(-1); } memset(countArray,0,sizeof(int)*range); for (int i = 0; i &lt; arrSize; ++i) { countArray[arr[i]-min]++; } int index = 0; for (int i = 0; i &lt; range; ++i) { while (countArray[i]--) { arr[index++] = i+min; } } free(countArray); }","categories":[{"name":"Cè¯­è¨€","slug":"Cè¯­è¨€","permalink":"http://blog.3amupupup.online/categories/C%E8%AF%AD%E8%A8%80/"}],"tags":[{"name":"æ’åº","slug":"æ’åº","permalink":"http://blog.3amupupup.online/tags/%E6%8E%92%E5%BA%8F/"}]},{"title":"Jenkinsç»“åˆsonarä»£ç æ£€æµ‹æµæ°´çº¿","slug":"Jenkinsç»“åˆsonarä»£ç æ£€æµ‹æµæ°´çº¿","date":"2021-03-18T03:09:52.078Z","updated":"2021-03-18T03:09:52.078Z","comments":true,"path":"2021/03/18/Jenkinsç»“åˆsonarä»£ç æ£€æµ‹æµæ°´çº¿/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/Jenkins%E7%BB%93%E5%90%88sonar%E4%BB%A3%E7%A0%81%E6%A3%80%E6%B5%8B%E6%B5%81%E6%B0%B4%E7%BA%BF/","excerpt":"","text":"1ã€jenkinsæ‰€éœ€æ’ä»¶Pipelineã€Sonar Quality Gates Pluginã€SonarQube Scannerã€Generic Webhook Trigger Plugin 2ã€jenkinsé…ç½® Dashboard =&gt; ç³»ç»Ÿç®¡ç† =&gt; å…¨å±€å·¥å…·é…ç½® Dashboard =&gt; ç³»ç»Ÿç®¡ç† =&gt; ç³»ç»Ÿé…ç½® è¿™ä¸ªtokenæ˜¯åœ¨sonar webä¸Šç”Ÿæˆçš„ï¼Œç„¶ååœ¨jenkinsä¸Šåˆ›å»ºä¸€ä¸ªsecret textç±»å‹å‡­æ®ã€‚ é…ç½®è¿æ¥gitlabï¼Œè¦ç”Ÿæˆgitlab api token ç”Ÿæˆprivate tokenã€‚åœ¨sonaræ£€æµ‹ä»£ç æ‰€æœ‰æ¡ä»¶éƒ½é€šè¿‡æ—¶ï¼Œè¦é€šè¿‡è¿™ä¸ªprivate tokenå»æ“ä½œgitlabçš„apiæ¥è‡ªåŠ¨æ¥å—åˆå¹¶è¯·æ±‚ã€‚ ç”Ÿæˆå‡­æ®ï¼Œè®°ä½è¿™é‡Œçš„id ä¸º12ï¼Œä¸€ä¼špipelineè„šæœ¬è¦ç”¨ åœ¨gitlabé¡¹ç›®ä¸‹é…ç½®è§¦å‘å™¨ï¼Œåªå‹¾é€‰Merge Request Events (è¿™ä¸ªtokenéšæœºç”Ÿæˆä¸€ä¸ªå°±å¥½äº†) 3ã€pipilineè„šæœ¬pipeline { agent any environment { PrivateToken= credentials(&#39;12&#39;) // è·å–private tokenï¼Œä¹‹å‰åœ¨å‡­æ®é‡Œé…ç½®è¿‡ï¼Œè¿™æ ·æ¯”è¾ƒå®‰å…¨ï¼Œä¸éœ€è¦åœ¨è„šæœ¬é‡Œæ˜æ–‡ä½¿ç”¨token } options { gitLabConnection(&#39;gitlab&#39;) } triggers { GenericTrigger( genericVariables: [ [key: &#39;source_branch&#39;, value: &#39;$.object_attributes.source_branch&#39;], // è·å–mergeçš„æºåˆ†æ”¯,åªæ£€æµ‹æºåˆ†æ”¯ï¼Œæºåˆ†æ”¯çš„ä»£ç æ£€æµ‹æˆåŠŸæ‰èƒ½åˆå¹¶åˆ°ç›®æ ‡åˆ†æ”¯ [key: &#39;url&#39;, value: &#39;$.object_attributes.url&#39;], // è·å–gitlab mergeè¯·æ±‚çš„url [key: &#39;action&#39;, value: &#39;$.object_attributes.action&#39;], // è·å–mergeåŠ¨ä½œ [reopen,close,open],åªåœ¨reopenå’Œopenæ—¶æ‰å‡ºå‘æµæ°´çº¿æ£€æµ‹ [key: &#39;source_project_id&#39;, value: &#39;$.object_attributes.source_project_id&#39;], [key: &#39;iid&#39;, value: &#39;$.object_attributes.iid&#39;], [key: &#39;name&#39;, value: &#39;$.user.name&#39;], // è·å–åˆå¹¶è¯·æ±‚çš„å‘èµ·äºº [key: &#39;project_name&#39;, value: &#39;$.project.name&#39;], // æˆ–è€…é¡¹ç›®å [key: &#39;target_branch&#39;, value: &#39;$.object_attributes.target_branch&#39;], // è·å–ç›®æ ‡åˆ†æ”¯ï¼Œæˆ‘è¿™é‡Œçš„éœ€æ±‚æ˜¯ï¼šåˆå¹¶åˆ°release.teståˆ†æ”¯çš„è¯·æ±‚æ‰è¿›è¡Œè´¨æ£€ã€è‡ªåŠ¨åˆå¹¶ï¼Œæ‰€ä»¥æˆ‘éœ€è¦æ‹¿åˆ°è¿™ä¸ªå˜é‡ [key: &#39;object_kind&#39;, value: &#39;$.object_kind&#39;] ], token: &#39;fc161920aa6f1886e7417416edc85500&#39; , // è¿™æ˜¯webhookä¸Šå¡«å†™çš„token causeString: &#39; Triggered on $ref&#39; , printContributedVariables: true, printPostContent: true ) } stages { stage(&quot;select branch&quot;){ steps{ script{ if((env.source_branch =~ &#39;release.*&#39;).matches() || (env.action!=&quot;open&quot; &amp;&amp; env.action!=&quot;update&quot;) || env.target_branch != &quot;release.test&quot;){ // è§¦å‘æµæ°´çº¿æ£€æµ‹ä»£ç çš„æ¡ä»¶ stage(&quot;exit with 0&quot;){ ansiColor(&#39;gnome-terminal&#39;) { echo &quot;\\033[32m Jump Sonar\\n user:$name\\nproject_name:$project_name\\nobject_kind:$object_kind\\naction:$action\\nsource_branch:$source_branch\\n target_branch:$target_branch \\033[0m&quot; } } }else{ stage(&#39;pull branch&#39;) { checkout([$class: &#39;GitSCM&#39;, branches: [[name: &quot;*/$source_branch&quot;]], doGenerateSubmoduleConfigurations: false, extensions: [], submoduleCfg: [], userRemoteConfigs: [[credentialsId: &#39;11&#39;, url: &#39;http://gitlab.xxxxxx.com:8888/xubin/xxxxxxxx.git&#39;]]]) } stage(&#39;SonarQubeanalysis&#39;) { script { scannerHome = tool &#39;sonar-scanner&#39; } withSonarQubeEnv(&#39;sonar&#39;) { sh &quot;echo ${scannerHome}&quot; sh &quot;${scannerHome}/bin/sonar-scanner -Dsonar.projectKey=$JOB_BASE_NAME -Dsonar.sources=./app&quot; } } stage(&quot;SonarQube Quality Gate&quot;) { timeout(time: 1, unit: &#39;HOURS&#39;) { def qg = waitForQualityGate(&#39;sonar&#39;) if (qg.status != &#39;OK&#39;) { echo &quot;Status: ${qg.status}&quot; error &quot;Pipeline aborted due to quality gate failure: ${qg.status}&quot; // è´¨æ£€æ²¡é€šè¿‡ç›´æ¥è®©æµæ°´çº¿å¤±è´¥é€€å‡º } } ansiColor(&#39;gnome-terminal&#39;) { echo &quot;\\033[32m Jump Sonar\\n user:$name\\nproject_name:$project_name\\nobject_kind:$object_kind\\naction:$action\\nsource_branch:$source_branch\\n target_branch:$target_branch \\033[0m&quot; } } stage(&quot;Merge&quot;){ // å¦‚æœæ£€æµ‹é€šè¿‡è‡ªåŠ¨åˆå¹¶è¯·æ±‚ script{ httpRequest authentication: &#39;11&#39;, customHeaders: [[maskValue: false, name: &#39;PRIVATE-TOKEN&#39;, value: &quot;$PrivateToken&quot;]], httpMode: &#39;PUT&#39;, responseHandle: &#39;NONE&#39;, url: &quot;http://gitlab.xxxxxx.com:8888/api/v4/projects/$source_project_id/merge_requests/$iid/merge&quot; } } } } } } } }","categories":[{"name":"è¿ç»´","slug":"è¿ç»´","permalink":"http://blog.3amupupup.online/categories/%E8%BF%90%E7%BB%B4/"}],"tags":[{"name":"sonar","slug":"sonar","permalink":"http://blog.3amupupup.online/tags/sonar/"}]},{"title":"å¸¦ç¯é“¾è¡¨","slug":"å¸¦ç¯é“¾è¡¨","date":"2021-03-18T03:09:52.077Z","updated":"2021-03-18T03:09:52.077Z","comments":true,"path":"2021/03/18/å¸¦ç¯é“¾è¡¨/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/%E5%B8%A6%E7%8E%AF%E9%93%BE%E8%A1%A8/","excerpt":"","text":"1ã€åˆ¤æ–­é“¾è¡¨æ˜¯å¦å¸¦ç¯è§£é¢˜è¿‡ç¨‹ï¼š ç»™é“¾è¡¨è®¾ç½®ä¸¤ä¸ªæŒ‡é’ˆï¼Œslowç§»åŠ¨ä¸€æ­¥ï¼Œfastç§»åŠ¨ä¸¤æ­¥ã€‚ fastå’ŒslowæŒ‡é’ˆéƒ½è¿›å…¥ç¯ä¹‹å fastå’ŒslowæŒ‡é’ˆé‡åˆ åœ¨slowå’Œfastéƒ½è¿›ç¯ä¹‹åï¼Œfastå¼€å§‹è¿½slowã€‚slowç§»åŠ¨ä¸€æ­¥ï¼Œfastç§»åŠ¨ä¸¤æ­¥ã€‚ æ¯ä¸€æ¬¡ç§»åŠ¨fastå’Œslowä¹‹é—´çš„è·ç¦»ç¼©çŸ­ä¸€æ­¥ï¼Œæœ€ç»ˆé‡åˆï¼Œåˆ™è¯æ˜æœ‰ç¯ã€‚å¦‚æœfastæŒ‡é’ˆåœ¨ç»è¿‡è‹¥å¹²æ¬¡ç§»åŠ¨ä¹‹åä¸ºNULL(å¾ªç¯ç»“æŸ)ï¼Œåˆ™è¯´æ˜ä¸å¸¦ç¯ã€‚ ä»£ç ï¼š /** * Definition for singly-linked list. * struct ListNode { * int val; * struct ListNode *next; * }; */ bool hasCycle(struct ListNode *head) { struct ListNode *slow = head; struct ListNode *fast = head; while(fast &amp;&amp; fast-&gt;next) { slow = slow-&gt;next; fast = fast-&gt;next-&gt;next; if (slow == fast) { return true; } } return false; } 2ã€å¸¦ç¯é“¾è¡¨çš„å…¥ç¯ç»“ç‚¹è§£é¢˜è¿‡ç¨‹ ç»™é“¾è¡¨è®¾ç½®ä¸¤ä¸ªæŒ‡é’ˆï¼Œslowç§»åŠ¨ä¸€æ­¥ï¼Œfastç§»åŠ¨ä¸¤æ­¥ã€‚ slowåœ¨è¿›å…¥ç¯ä¹‹åï¼Œåœ¨ä¸€ä¸ªCä¹‹å†…å°±ä¼šè¢«fastè¿½ä¸Š(fastçš„é€Ÿåº¦æ˜¯slowçš„ä¸¤å€)ã€‚ slowèµ°çš„è·ç¦»æ˜¯ï¼šL+X fastèµ°çš„è·ç¦»æ˜¯ ï¼šL+N*C+X (å¦‚æœLè¶³å¤Ÿé•¿ç¯è¶³å¤Ÿå°ï¼Œfastè¿›ç¯ä¸”ç»•ç¯Næ¬¡ä¹‹åslowæ‰ä¼šè¿›å…¥) 2*(L+X) = L+N*C+X =&gt; L = N*C -X ç„¶ååŒæ—¶ä»headå’Œfastä½ç½®å¼€å§‹éå†ï¼Œæ‰¾åˆ°ç›¸åŒçš„èŠ‚ç‚¹ã€‚ ä»£ç ï¼š /** * Definition for singly-linked list. * struct ListNode { * int val; * struct ListNode *next; * }; */ struct ListNode *detectCycle(struct ListNode *head) { struct ListNode *slow = head; struct ListNode *fast = head; while(fast &amp;&amp; fast-&gt;next) // éå†é“¾è¡¨ï¼Œæ‰¾åˆ°slowä¸fasté‡åˆçš„ç‚¹ { slow = slow-&gt;next; fast = fast-&gt;next-&gt;next; if(fast == slow) { break; } } if(!fast || !fast-&gt;next) // åˆ¤æ–­ä¸Šä¸€æ­¥å¾ªç¯æ—¶å› ä¸ºéå†åˆ°NULLç»“æŸçš„è¿˜æ˜¯å› ä¸º fast==slow ç»“æŸçš„ { return NULL; // å¦‚æœfastæˆ–è€…fast-&gt;nextä¸ºNULLè¯´æ˜é“¾è¡¨ä¸å¸¦ç¯ï¼Œç›´æ¥è¿”å›NULL } while(fast &amp;&amp; head) // éå†å¯»æ‰¾ç›¸äº¤ç»“ç‚¹ { if(fast == head) { return fast; } fast = fast-&gt;next; head = head-&gt;next; } return NULL; }","categories":[{"name":"Cè¯­è¨€","slug":"Cè¯­è¨€","permalink":"http://blog.3amupupup.online/categories/C%E8%AF%AD%E8%A8%80/"}],"tags":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://blog.3amupupup.online/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"ECSç£ç›˜æ‰©å®¹","slug":"ECSç£ç›˜æ‰©å®¹","date":"2021-03-18T03:09:52.075Z","updated":"2021-03-18T03:09:52.076Z","comments":true,"path":"2021/03/18/ECSç£ç›˜æ‰©å®¹/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/ECS%E7%A3%81%E7%9B%98%E6%89%A9%E5%AE%B9/","excerpt":"","text":"1ã€é€šè¿‡ df -h çŸ¥æ ¹åˆ†åŒºå¤§å°ä¸º40Gã€‚ 2ã€åœ¨é˜¿é‡Œäº‘åå°å¯¹å½“å‰ECSå®ä¾‹çš„ç£ç›˜è¿›è¡Œåœ¨çº¿æ‰©å®¹ã€‚ 3ã€æ‰©å®¹åç™»é™†ECSä½¿ç”¨fdisk -læŸ¥çœ‹ç£ç›˜å¤§å°ï¼Œç£ç›˜å·²ç»æ‰©å®¹åˆ°100Gã€‚ 4ã€å®‰è£…growpart[root@iZbp1e8z3uz7pmqbsis8bkZ ~]# yum -y install cloud-utils-growpart Loaded plugins: fastestmirror base | 3.6 kB 00:00 epel | 4.7 kB 00:00 extras | 2.9 kB 00:00 updates | 2.9 kB 00:00 (1/7): base/7/x86_64/group_gz | 153 kB 00:00 (2/7): extras/7/x86_64/primary_db | 190 kB 00:00 (3/7): epel/x86_64/group_gz | 95 kB 00:00 (4/7): updates/7/x86_64/primary_db | 176 kB 00:00 (5/7): epel/x86_64/updateinfo | 1.0 MB 00:00 (6/7): base/7/x86_64/primary_db | 6.1 MB 00:00 (7/7): epel/x86_64/primary_db | 6.8 MB 00:00 Determining fastest mirrors * base: mirrors.cloud.aliyuncs.com * epel: mirrors.cloud.aliyuncs.com * extras: mirrors.cloud.aliyuncs.com * updates: mirrors.cloud.aliyuncs.com Resolving Dependencies --&gt; Running transaction check ---&gt; Package cloud-utils-growpart.noarch 0:0.29-5.el7 will be installed --&gt; Finished Dependency Resolution Dependencies Resolved ================================================================================ Package Arch Version Repository Size ================================================================================ Installing: cloud-utils-growpart noarch 0.29-5.el7 base 27 k Transaction Summary ================================================================================ Install 1 Package Total download size: 27 k Installed size: 61 k Downloading packages: cloud-utils-growpart-0.29-5.el7.noarch.rpm | 27 kB 00:00 Running transaction check Running transaction test Transaction test succeeded Running transaction Installing : cloud-utils-growpart-0.29-5.el7.noarch 1/1 Verifying : cloud-utils-growpart-0.29-5.el7.noarch 1/1 Installed: cloud-utils-growpart.noarch 0:0.29-5.el7 Complete! 5ã€æ‰©å±•/dev/vda1åˆ†åŒºï¼ˆå‘½åå«ä¹‰ä¸ºæ‰©å±•/dev/vdaç£ç›˜çš„ç¬¬ä¸€ä¸ªåˆ†åŒºï¼‰ã€‚[root@iZbp1e8z3uz7pmqbsis8bkZ ~]# growpart /dev/vda 1 CHANGED: partition=1 start=2048 old: size=83881984 end=83884032 new: size=209713119 end=209715167 â€‹ è‹¥æŠ¥é”™unexpected output in sfdisk â€“versionâ€¦â€¦..åˆ™è¿è¡ŒLANG=en_US.UTF-8åˆ‡æ¢ECSå®ä¾‹çš„å­—ç¬¦ç¼–ç ç±»å‹ã€‚ 6ã€è¿è¡Œresize2fs å‘½ä»¤è°ƒç”¨resize2fsæ‰©å®¹æ–‡ä»¶ç³»ç»Ÿã€‚ [root@iZbp1e8z3uz7pmqbsis8bkZ ~]# resize2fs /dev/vda1 resize2fs 1.42.9 (28-Dec-2013) Filesystem at /dev/vda1 is mounted on /; on-line resizing required old_desc_blocks = 3, new_desc_blocks = 7 The filesystem on /dev/vda1 is now 26214139 blocks long. [root@iZbp1e8z3uz7pmqbsis8bkZ ~]# df -h Filesystem Size Used Avail Use% Mounted on /dev/vda1 99G 1.5G 93G 2% / devtmpfs 487M 0 487M 0% /dev tmpfs 497M 0 497M 0% /dev/shm tmpfs 497M 308K 496M 1% /run tmpfs 497M 0 497M 0% /sys/fs/cgroup tmpfs 100M 0 100M 0% /run/user/0","categories":[{"name":"è¿ç»´","slug":"è¿ç»´","permalink":"http://blog.3amupupup.online/categories/%E8%BF%90%E7%BB%B4/"}],"tags":[{"name":"ecs","slug":"ecs","permalink":"http://blog.3amupupup.online/tags/ecs/"}]},{"title":"linuxæ€§èƒ½ä¼˜åŒ–å®æˆ˜ç¬”è®°","slug":"linuxæ€§èƒ½ä¼˜åŒ–å®æˆ˜ç¬”è®°","date":"2021-03-18T03:09:52.075Z","updated":"2021-03-18T03:09:52.075Z","comments":true,"path":"2021/03/18/linuxæ€§èƒ½ä¼˜åŒ–å®æˆ˜ç¬”è®°/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/linux%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E7%AC%94%E8%AE%B0/","excerpt":"","text":"01ã€å¹³å‡è´Ÿè½½å¹³å‡è´Ÿè½½ï¼šç³»ç»Ÿå‡ºäºå¯è¿è¡ŒçŠ¶æ€ï¼ˆæ­£åœ¨ä½¿ç”¨cpuæˆ–è€…æ­£åœ¨ç­‰å¾…cpuçš„è¿›ç¨‹ï¼Œä¹Ÿå°±æ˜¯pså‘½ä»¤çœ‹åˆ°çš„Running æˆ– RunnableçŠ¶æ€çš„è¿›ç¨‹ï¼‰å’Œä¸å¯ä¸­æ–­çŠ¶æ€ï¼ˆè¿›ç¨‹æ­£åœ¨å¤„äºå†…æ ¸æ€å…³é”®æµç¨‹ä¸­çš„è¿›ç¨‹ï¼Œè¿™äº›æµç¨‹æ˜¯ä¸å¯æ‰“æ–­çš„ï¼Œä¾‹å¦‚ç­‰å¾…ç¡¬ä»¶è®¾å¤‡çš„I/Oå“åº”ï¼Œä¹Ÿå°±æ˜¯pså‘½ä»¤çœ‹åˆ°çš„DçŠ¶æ€ã€‚æ¯”å¦‚ï¼Œå½“ä¸€ä¸ªè¿›ç¨‹å‘ç£ç›˜è¯»å†™æ•°æ®æ—¶ï¼Œä¸ºäº†ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œåœ¨å¾—åˆ°ç£ç›˜å›å¤å‰ï¼Œå®ƒæ˜¯ä¸èƒ½è¢«å…¶ä»–è¿›ç¨‹æˆ–è€…ä¸­æ–­æ‰“æ–­çš„ï¼Œè¿™ä¸ªæ—¶å€™çš„è¿›ç¨‹å°±å¤„äºä¸å¯ä¸­æ–­çŠ¶æ€ã€‚å¦‚æœæ­¤æ—¶çš„è¿›ç¨‹è¢«æ‰“æ–­äº†ï¼Œå°±å®¹æ˜“å‡ºç°ç£ç›˜æ•°æ®ä¸è¿›ç¨‹æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚æ‰€ä»¥ï¼Œä¸å¯ä¸­æ–­çŠ¶æ€å®é™…ä¸Šæ˜¯ç³»ç»Ÿå¯¹è¿›ç¨‹å’Œç¡¬ä»¶è®¾å¤‡çš„ä¸€ç§ä¿æŠ¤æœºåˆ¶ã€‚ï¼‰çš„å¹³å‡è¿›ç¨‹æ•°ï¼Œä¹Ÿå°±æ˜¯å¹³å‡æ´»è·ƒè¿›ç¨‹æ•°ã€‚ #è§‚å¯Ÿè¿›ç¨‹çš„cpuä½¿ç”¨æƒ…å†µï¼Œé—´éš”ä¸€ç§’è¾“å‡ºä¸€æ¬¡ pidstat -u 1 #è§‚å¯Ÿcpuä½¿ç”¨æƒ…å†µï¼Œè§‚å¯Ÿå„çŠ¶æ€å æ¯” mpstat -P ALL 1 02ã€CPU ä¸Šä¸‹æ–‡åˆ‡æ¢CPU å¯„å­˜å™¨ï¼šæ˜¯ CPU å†…ç½®çš„å®¹é‡å°ã€ä½†é€Ÿåº¦æå¿«çš„å†…å­˜ã€‚ ç¨‹åºè®¡æ•°å™¨ï¼šåˆ™æ˜¯ç”¨æ¥å­˜å‚¨ CPU æ­£åœ¨æ‰§è¡Œçš„æŒ‡ä»¤ä½ç½®ã€æˆ–è€…å³å°†æ‰§è¡Œçš„ä¸‹ä¸€æ¡æŒ‡ä»¤ä½ç½®ã€‚ å®ƒä»¬éƒ½æ˜¯ CPU åœ¨è¿è¡Œä»»ä½•ä»»åŠ¡å‰ï¼Œå¿…é¡»çš„ä¾èµ–ç¯å¢ƒï¼Œå› æ­¤ä¹Ÿè¢«å«åš CPU ä¸Šä¸‹æ–‡ã€‚ CPU ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œå°±æ˜¯å…ˆæŠŠå‰ä¸€ä¸ªä»»åŠ¡çš„ CPU ä¸Šä¸‹æ–‡ï¼ˆä¹Ÿå°±æ˜¯ CPU å¯„å­˜å™¨å’Œç¨‹åºè®¡æ•°å™¨ï¼‰ä¿å­˜èµ·æ¥ï¼Œç„¶ååŠ è½½æ–°ä»»åŠ¡çš„ä¸Šä¸‹æ–‡åˆ°è¿™äº›å¯„å­˜å™¨å’Œç¨‹åºè®¡æ•°å™¨ï¼Œæœ€åå†è·³è½¬åˆ°ç¨‹åºè®¡æ•°å™¨æ‰€æŒ‡çš„æ–°ä½ç½®ï¼Œè¿è¡Œæ–°ä»»åŠ¡ã€‚ ä¸Šä¸‹æ–‡åˆ‡æ¢æƒ…æ™¯ï¼š â‘  ç³»ç»Ÿè°ƒç”¨ï¼Œcpuå¯„å­˜å™¨é‡ŒåŸæ¥ç”¨æˆ·æ€çš„æŒ‡ä»¤ä½ç½®ï¼Œéœ€è¦å…ˆä¿å­˜èµ·æ¥ï¼Œæ¥ç€ä¸ºäº†æ‰§è¡Œå†…æ ¸æ€çš„ä»£ç ï¼Œcpuå¯„å­˜å™¨éœ€è¦æ›´æ–°ä¸ºå†…æ ¸æ€æŒ‡ä»¤çš„æœ€æ–°ä½ç½®ï¼Œæœ€åæ‰æ˜¯è·³è½¬åˆ°å†…æ ¸æ€è¿è¡Œå†…æ ¸ä»»åŠ¡ï¼Œç³»ç»Ÿè°ƒç”¨ç»“æŸåcpuéœ€è¦æ¢å¤åˆ°åŸæ¥ä¿å­˜çš„ç”¨æˆ·æ€ï¼Œç»§ç»­è¿è¡Œè¿›ç¨‹ã€‚soï¼Œä¸€æ¬¡ç³»ç»Ÿè°ƒç”¨å‘ç”Ÿäº†ä¸¤æ¬¡cpuä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚ï¼ˆç³»ç»Ÿè°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œå¹¶ä¸ä¼šæ¶‰åŠåˆ°è™šæ‹Ÿå†…å­˜ç­‰è¿›ç¨‹ç”¨æˆ·æ€çš„èµ„æºï¼Œä¹Ÿä¸ä¼šåˆ‡æ¢è¿›ç¨‹ã€‚è¿™è·Ÿæˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢æ˜¯ä¸ä¸€æ ·çš„ï¼‰ è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ˜¯æŒ‡ä»ä¸€ä¸ªè¿›ç¨‹åˆ‡æ¢åˆ°å¦ä¸€ä¸ªè¿›ç¨‹è¿è¡Œã€‚è€Œç³»ç»Ÿè°ƒç”¨è¿‡ç¨‹ä¸­ä¸€ç›´æ˜¯åŒä¸€ä¸ªè¿›ç¨‹åœ¨è¿è¡Œã€‚","categories":[{"name":"è¿ç»´","slug":"è¿ç»´","permalink":"http://blog.3amupupup.online/categories/%E8%BF%90%E7%BB%B4/"}],"tags":[{"name":"linuxæ€§èƒ½ä¼˜åŒ–å®æˆ˜ç¬”è®°","slug":"linuxæ€§èƒ½ä¼˜åŒ–å®æˆ˜ç¬”è®°","permalink":"http://blog.3amupupup.online/tags/linux%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E7%AC%94%E8%AE%B0/"}]},{"title":"ä¸€æ¬¡æµ·å¤–k8sé›†ç¾¤ä»£ç å‘å¸ƒå®è·µ","slug":"ä¸€æ¬¡æµ·å¤–k8sé›†ç¾¤ä»£ç å‘å¸ƒå®è·µ","date":"2021-03-18T03:09:52.074Z","updated":"2021-03-18T03:09:52.074Z","comments":true,"path":"2021/03/18/ä¸€æ¬¡æµ·å¤–k8sé›†ç¾¤ä»£ç å‘å¸ƒå®è·µ/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/%E4%B8%80%E6%AC%A1%E6%B5%B7%E5%A4%96k8s%E9%9B%86%E7%BE%A4%E4%BB%A3%E7%A0%81%E5%8F%91%E5%B8%83%E5%AE%9E%E8%B7%B5/","excerpt":"","text":"é¡¹ç›®èƒŒæ™¯ï¼šè¦ä¸Šä¸€ä¸ªæµ·å¤–ç‰ˆçš„å°è¯´å¹³å°ï¼Œgitlabåœ¨å›½å†…ï¼Œå½“å‰æ˜¯è¦æ±‚åœ¨æµ·å¤–æ­å»ºä¸€ä¸ªæµ‹è¯•ç¯å¢ƒ(phpä»£ç ) ç¬¬ä¸€é˜¶æ®µï¼šè¯ä¸å¤šè¯´ï¼Œåœ¨é¦™æ¸¯ä¹°äº†å°æœºå™¨ï¼Œdownäº†ä¸ªoneinstackè„šæœ¬è£…ç¯å¢ƒï¼Œç¯å¢ƒå…·ä½“ä¸ºmysql+redis+php-fpm7.1.3+nginxã€‚ jenkins+gitlabéƒ½æ˜¯åœ¨å›½å†…ï¼Œä¹Ÿæ²¡å¤šæƒ³ç›´æ¥åœ¨jenkinsåˆ›å»ºäº†ä¸€ä¸ªå·¥ç¨‹ï¼Œä½¿ç”¨ssh-serveræ’ä»¶å°†æ„å»ºå¥½çš„ä»£ç pushåˆ°é¦™æ¸¯æœºå™¨ã€‚é—®é¢˜æ¥äº†ï¼Œå› ä¸ºæœºå™¨æ˜¯åœ¨é¦™æ¸¯ï¼Œåœ¨jenkins pushä»£ç çš„æ—¶å€™å·¨æ…¢æ— æ¯”ï¼Œæ¯ä¸€æ¬¡å‘å¸ƒèµ·ç èŠ±è´¹ååˆ†é’Ÿä»¥ä¸Šçš„æ—¶é—´ï¼Œä¸¥é‡å½±å“å¼€å‘æ•ˆç‡ã€‚ ç¬¬äºŒé˜¶æ®µï¼šæƒ³åˆ°äº†ç”¨å®¹å™¨çš„æ–¹å¼å‘å¸ƒï¼Œæ€è·¯æ˜¯è¿™æ ·ï¼šåœ¨æ­å·æœºå™¨ä¸Šå°†é•œåƒæ„å»ºå¥½ï¼Œç„¶åpushåˆ°é¦™æ¸¯ä»“åº“å»ï¼Œå› ä¸ºé•œåƒpushçš„æ—¶å€™ä¼šè¿›è¡Œå‹ç¼©ï¼Œå¦å¤–pushåˆ°é¦™æ¸¯ä»“åº“ä¹‹åé‚£è¾¹æœºå™¨æ‹‰å–ä»£ç çš„é€Ÿåº¦ä¼šå¤§å¤§æå‡ï¼Œç¼©çŸ­äº†å‘å¸ƒæ—¶é—´ï¼ˆè¿™æ˜¯ä¸ºä»¥åç”Ÿäº§å‘å¸ƒåšè€ƒè™‘ï¼Œä»£ç åŒæ­¥æ…¢ï¼Œæœ‰äº›æ–‡ä»¶æ›´æ–°æœ‰äº›æ–‡ä»¶æ²¡æ›´æ–°å¯èƒ½ä¼šé€ æˆçº¿ä¸ŠæŠ¥é”™çš„ï¼‰ã€‚äºæ˜¯å¼€å§‹æ„å»ºåŸºç¡€é•œåƒï¼Œç¼–å†™Dockerfileã€‚ ç¼–å†™dockerfileï¼šâ‘ ä¿è¯é•œåƒç²¾ç®€ â‘¡å°½é‡å‡å°‘é•œåƒçš„å±‚æ•°ï¼Œå°†åº•å±‚ç¯å¢ƒå›ºå®šã€‚ nginxå’Œphp-fpmåŸºç¡€é•œåƒæ„å»ºå®Œæˆåä½¿ç”¨jenkinsè¿›è¡Œæ‰“åŒ…ä»£ç åˆ°é•œåƒé‡Œï¼Œä½¿ç”¨çš„pipelineè„šæœ¬ã€‚ ç¬¬äºŒé˜¶æ®µä½¿ç”¨çš„æ˜¯docker composeï¼Œå› æ­¤æ¯ä¸€æ¬¡æ›´æ–°éƒ½éœ€è¦ç™»å½•é¦™æ¸¯æœºå™¨æ‰‹åŠ¨æ‹‰å–å¹¶æ›´æ–°é•œåƒï¼Œæ¯”è¾ƒéº»çƒ¦ï¼Œæ‰€ä»¥å¾ˆå¿«å°±æ”¾å¼ƒäº†è¿™ç§æ–¹å¼ ç¬¬ä¸‰é˜¶æ®µï¼šè€ƒè™‘ä½¿ç”¨k8sï¼Œäºæ˜¯åœ¨é¦™æ¸¯ä¹°äº†ä¸ªk8sé›†ç¾¤ï¼Œä¸¤ä¸ª2c4gçš„èŠ‚ç‚¹ï¼Œå¤–åŠ ä¸€å°2c4gçš„æœºå™¨ä½œä¸ºæ•°æ®åº“æœºå™¨ï¼ˆredis+mysqlï¼‰ï¼Œåç»­æ­£å¼ä¸Šçº¿ä¹‹åå†è€ƒè™‘æ‰©å®¹ã€‚ é—®é¢˜ï¼š â€‹ 1ã€nginxå®¹å™¨å’Œphp-fpmå®¹å™¨éœ€è¦å…±äº«ä»£ç æ‰èƒ½æ­£å¸¸æä¾›æœåŠ¡ã€‚ â€‹ è§£å†³ï¼šé¦–å…ˆæƒ³åˆ°çš„æ˜¯æ¯æ¬¡å‘å¸ƒæ„å»ºä¸¤ä¸ªé•œåƒï¼Œå³å°†ä»£ç åˆ†åˆ«æ‹·è´è¿›nginxå’Œphpå®¹å™¨ï¼Œç„¶åé€šè¿‡deploymentå»è¿è¡Œï¼Œä½†æ˜¯è¿™ç§æ–¹æ³•å¤ªéº»çƒ¦ï¼Œå› ä¸ºæ²¡æ¬¡éƒ½éœ€è¦é‡æ–°æ›´æ–°phpå’Œnginxå®¹å™¨ï¼Œè¿™ä¸¤ä¸ªé•œåƒçš„ä½“ç§¯åŠ èµ·æ¥å·®ä¸å¤šæœ‰800Mäº†ï¼Œæ‰€ä»¥ä¸è€ƒè™‘è¿™ç§æ–¹å¼ã€‚ â€‹ äºæ˜¯ä½¿ç”¨äº†deploymentæ§åˆ¶å™¨ä¸­çš„volume â€”- emptydirå…±äº«å·ï¼Œä»£ç ä½¿ç”¨ä¸€ä¸ªinitcontaineræ‹·è´è¿›å»ã€‚è¿™æ ·çš„è¯æˆ‘æ¯æ¬¡åªéœ€è¦æ›´æ–°initcontainer(initcontainerä¸éœ€è¦ä»€ä¹ˆç¯å¢ƒï¼Œä½¿ç”¨çš„busyboxï¼ŒåŸºç¡€é•œåƒæ‰å‡ Mï¼ŒåŠ ä¸Šä»£ç ä¹Ÿå°±30Må·¦å³ï¼Œè¿™æ ·çš„è¯å¤§å¤§æé«˜äº†é•œåƒæ„å»ºã€æ¨é€ã€æ‹‰å–çš„é€Ÿåº¦)ã€‚ ä½¿ç”¨pipelineæ„å»ºä»£ç å®¹å™¨ï¼š pipeline { agent any stages { stage(&#39;pull code&#39;) { steps { checkout([$class: &#39;GitSCM&#39;, branches: [[name: &#39;*/test&#39;]], doGenerateSubmoduleConfigurations: false, extensions: [], submoduleCfg: [], userRemoteConfigs: [[credentialsId: &#39;11&#39;, url: &#39;http://xxxxx.xxxxxxx.com/xxxxx/xxxxxxx_api.git&#39;]]]) } } stage(&#39;build image&#39;){ steps { sh &#39;wget http://172.16.72.173/leshuapi/.dockerignore -O .dockerignore&#39; sh &#39;wget http://172.16.72.173/leshuapi/Dockerfile -O Dockerfile&#39; sh &#39;sudo docker build -t registry.cn-hongkong.aliyuncs.com/ysg_codebox/$JOB_BASE_NAME:latest .&#39; } } stage(&#39;push image&#39;){ steps { timeout(time: 3, unit: &#39;MINUTES&#39;){ retry(5) { sh &#39;docker push registry.cn-hongkong.aliyuncs.com/ysg_codebox/$JOB_BASE_NAME:latest&#39; } } } } } } deployment.yamlå†…å®¹å¦‚ä¸‹ï¼š --- apiVersion: extensions/v1beta1 kind: Deployment metadata: name: leshuapi spec: replicas: 2 template: metadata: labels: app: leshuapp spec: dnsPolicy: Default shareProcessNamespace: true imagePullSecrets: - name: regsecret initContainers: - name: copycode #ä»£ç å®¹å™¨ image: registry.cn-hongkong.aliyuncs.com/ysg_codebox/xxxxxxxxx:latest imagePullPolicy: Always command: [&quot;mv&quot;,&quot;/data/wwwroot/&quot;,&quot;/data/www/&quot;] volumeMounts: - name: www mountPath: /data/www - name: chown image: registry.cn-hongkong.aliyuncs.com/ysg_baseimage/xxxxbox:v2 imagePullPolicy: IfNotPresent command: [&quot;chown&quot;,&quot;-R&quot;,&quot;www.www&quot;,&quot;/data/www/&quot;] volumeMounts: - name: www mountPath: /data/www containers: - name: nginx image: registry.cn-hongkong.aliyuncs.com/ysg_baseimage/nginx:v3 imagePullPolicy: IfNotPresent securityContext: capabilities: add: - SYS_PTRACE stdin: true tty: true resources: requests: memory: 200Mi cpu: 100m limits: memory: 300Mi cpu: 200m ports: - containerPort: 80 livenessProbe: tcpSocket: port: 80 command: [&quot;nginx&quot;, &quot;-g&quot;, &quot;daemon off;&quot;] volumeMounts: - name: www mountPath: /data/www - name: logs mountPath: /data/logs/ - name: nginx-conf mountPath: /etc/nginx/conf.d/ - name: env mountPath: /data/www/wwwroot/env/ - name: php-fpm image: registry.cn-hongkong.aliyuncs.com/ysg_baseimage/php-fpm:v2 imagePullPolicy: IfNotPresent securityContext: capabilities: add: - SYS_PTRACE stdin: true tty: true resources: requests: memory: 200Mi cpu: 100m limits: memory: 300Mi cpu: 200m ports: - containerPort: 9000 livenessProbe: tcpSocket: port: 9000 command: [&quot;/usr/local/php/sbin/php-fpm&quot;,&quot;-F&quot;] volumeMounts: - name: www mountPath: /data/www - name: logs mountPath: /data/logs/ - name: phpfpm-conf mountPath: /usr/local/php/etc/php-fpm.d/ - name: env mountPath: /data/www/wwwroot/env/ volumes: - name: www emptyDir: {} - name: logs emptyDir: {} - name: nginx-conf configMap: name: leshuapi-nginx-conf items: - key: server.conf path: server.conf - name: phpfpm-conf configMap: name: leshuapi-phpfpm-conf items: - key: www.conf path: www.conf - name: env configMap: name: leshuapi-env items: - key: .env path: .env --- apiVersion: v1 kind: Service metadata: name: leshuapiservice spec: ports: - protocol: TCP port: 80 targetPort: 80 selector: app: leshuapp é•œåƒé‡Œçš„é¡¹ç›®é…ç½®æ–‡ä»¶ã€nginxé…ç½®æ–‡ä»¶ã€php-fpmçš„é…ç½®æ–‡ä»¶å…¨éƒ¨é€šè¿‡configmapæŒ‚è½½å‡ºæ¥æ–¹ä¾¿ä¿®æ”¹ï¼Œå…·ä½“yamlçœç•¥ã€‚ é…ç½®æ–‡ä»¶ç»“æ„ï¼š","categories":[{"name":"k8s","slug":"k8s","permalink":"http://blog.3amupupup.online/categories/k8s/"}],"tags":[{"name":"cicd","slug":"cicd","permalink":"http://blog.3amupupup.online/tags/cicd/"}]},{"title":"äºŒå‰æ ‘","slug":"äºŒå‰æ ‘","date":"2021-03-18T03:09:52.073Z","updated":"2021-03-18T03:09:52.073Z","comments":true,"path":"2021/03/18/äºŒå‰æ ‘/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/%E4%BA%8C%E5%8F%89%E6%A0%91/","excerpt":"","text":"äºŒå‰æ ‘ ç¤ºæ„å›¾ æ€§è´¨ ä¸€ä¸ªäºŒå‰æ ‘ï¼Œå¦‚æœæ¯ä¸€å±‚çš„ç»“ç‚¹ä¸ªæ•°éƒ½è¾¾åˆ°æœ€å¤§å€¼åˆ™å°±æ˜¯æ»¡äºŒå‰æ ‘ã€‚ä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªæ·±åº¦ä¸ºkçš„äºŒå‰æ ‘ï¼Œå¦‚æœç»“ç‚¹æ€»æ•°æ˜¯(2^k)-1åˆ™æ˜¯æ»¡äºŒå‰æ ‘ã€‚ å‰k-1å±‚ç»“ç‚¹ä¸ªæ•°éƒ½æ˜¯æ»¡çš„(è¾¾åˆ°æœ€å¤§ä¸ªæ•°)ï¼Œæœ€åä¸€å±‚å¯ä»¥ä¸æ»¡ï¼Œä½†æ˜¯å¿…é¡»ä»å·¦åˆ°å³è¿ç»­ï¼Œç§°ä¸ºå®Œå…¨äºŒå‰æ ‘ã€‚(æ»¡äºŒå‰æ ‘æ˜¯ç‰¹æ®Šçš„å®Œå…¨äºŒå‰æ ‘) è‹¥è§„å®šæ ¹ç»“ç‚¹çš„å±‚æ•°ä¸º1ï¼Œåˆ™ä¸€æ£µéç©ºäºŒå‰æ ‘çš„ç¬¬iå±‚è‡³å¤šæœ‰2^(i-1)ä¸ªç»“ç‚¹ã€‚ ä»»ä½•ä¸€é¢—äºŒå‰æ ‘ï¼Œåº¦ä¸º0çš„ç»“ç‚¹ä¸ªæ•°æ¯”åº¦ä¸º2çš„ç»“ç‚¹ä¸ªæ•°å¤š1ã€‚ å¯¹äºæœ‰Nä¸ªç»“ç‚¹çš„æ»¡äºŒå‰æ ‘ï¼ŒäºŒå‰æ ‘çš„é«˜åº¦ h=log2N+1ã€‚ å¯¹äºæœ‰Nä¸ªç»“ç‚¹çš„å®Œå…¨äºŒå‰æ ‘ï¼ŒäºŒå‰æ ‘çš„é«˜åº¦ h=log2N+1ã€‚ äºŒå‰æ ‘çš„é¡ºåºå­˜å‚¨ã€‚ ç¤ºæ„å›¾ çˆ¶äº²ç»“ç‚¹ä¸‹æ ‡æ˜¯iï¼Œåˆ™å·¦å­©å­ç»“ç‚¹ä¸‹æ ‡ä¸º2*i+1ã€å³å­©å­ç»“ç‚¹ä¸‹æ ‡","categories":[],"tags":[]},{"title":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","date":"2021-03-18T03:09:52.072Z","updated":"2021-03-18T03:09:52.072Z","comments":true,"path":"2021/03/18/è®¡ç®—æœºç½‘ç»œ/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/","excerpt":"","text":"è®¡ç®—æœºç½‘ç»œ ä¸‰ç§äº¤æ¢æ–¹å¼ï¼š äº¤æ¢æ–¹å¼ ä¼˜ç‚¹ ç¼ºç‚¹ ç”µè·¯äº¤æ¢ é€šä¿¡æ—¶å»¶å°(æ¯”ç‰¹æµç›´è¾¾ç»ˆç‚¹)æœ‰åºä¼ è¾“æ²¡æœ‰å†²çªä½¿ç”¨èŒƒå›´å¹¿(æ¨¡æ‹Ÿä¿¡å·ã€æ•°å­—ä¿¡å·)å®æ—¶æ€§å¼ºæ§åˆ¶ç®€å• å»ºç«‹è¿æ¥æ—¶é—´é•¿çº¿è·¯ç‹¬å ï¼Œä½¿ç”¨æ•ˆç‡ä½çµæ´»æ€§å·®éš¾ä»¥è§„æ ¼åŒ– æŠ¥æ–‡äº¤æ¢ æ— éœ€å»ºç«‹è¿æ¥(ä¸éœ€è¦ä¸ºé€šä¿¡åŒæ–¹äº‹å…ˆå»ºç«‹ä¸€æ¡ä¸“ç”¨çš„é€šä¿¡çº¿è·¯ï¼Œä¸å­˜åœ¨å»ºç«‹è¿æ¥çš„æ—¶å»¶ã€‚)åŠ¨æ€åˆ†é…çº¿è·¯æé«˜çº¿è·¯å¯é æ€§æé«˜çº¿è·¯åˆ©ç”¨ç‡æä¾›å¤šç›®æ ‡æœåŠ¡ å¼•èµ·äº†è½¬å‘æ—¶å»¶éœ€è¦è¾ƒå¤§çš„å­˜å‚¨ç¼“å­˜ç©ºé—´éœ€è¦ä¼ è¾“é¢å¤–çš„ä¿¡æ¯é‡(æŠ¥å¤´è¦æºå¸¦ç›®æ ‡åœ°å€ã€æºåœ°å€ç­‰ä¿¡æ¯) åˆ†ç»„äº¤æ¢ æ— éœ€å»ºç«‹è¿æ¥çº¿è·¯åˆ©ç”¨ç‡é«˜ç®€åŒ–äº†å­˜å‚¨ç®¡ç†åŠ é€Ÿä¼ è¾“å‡å°‘å‡ºé”™æ¦‚ç‡å’Œé‡ä¼ æ•°æ®é‡ å¼•èµ·äº†è½¬å‘æ—¶å»¶éœ€è¦ä¼ è¾“é¢å¤–çš„ä¿¡æ¯é‡å¯¹äºæ•°æ®æŠ¥æœåŠ¡ï¼Œå­˜åœ¨å¤±åºã€ä¸¢å¤±æˆ–é‡å¤åˆ†ç»„çš„é—®é¢˜ï¼›å¯¹äºè™šç”µè·¯æœåŠ¡ï¼Œå­˜åœ¨å‘¼å«å»ºç«‹ã€æ•°æ®ä¼ è¾“å’Œè™šç”µè·¯é‡Šæ”¾ä¸‰ä¸ªè¿‡ç¨‹ è®¡ç®—æœºç½‘ç»œçš„å®šä¹‰å’Œåˆ†ç±»","categories":[],"tags":[]},{"title":"sonar","slug":"sonar","date":"2021-03-18T03:09:52.072Z","updated":"2021-03-18T03:09:52.073Z","comments":true,"path":"2021/03/18/sonar/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/sonar/","excerpt":"","text":"gitlabBranch gitlabSourceBranch gitlabActionType gitlabUserName gitlabUserUsername gitlabUserEmail gitlabSourceRepoHomepage gitlabSourceRepoName gitlabSourceNamespace gitlabSourceRepoURL gitlabSourceRepoSshUrl gitlabSourceRepoHttpUrl gitlabMergeRequestTitle gitlabMergeRequestDescription gitlabMergeRequestId gitlabMergeRequestIid gitlabMergeRequestState gitlabMergedByUser gitlabMergeRequestAssignee gitlabMergeRequestLastCommit gitlabMergeRequestTargetProjectId gitlabTargetBranch gitlabTargetRepoName gitlabTargetNamespace gitlabTargetRepoSshUrl gitlabTargetRepoHttpUrl gitlabBefore gitlabAfter gitlabTriggerPhrasepipeline { agent any stages { stage(&#39;pull code&#39;) { steps { checkout([$class: &#39;GitSCM&#39;, branches: [[name: &#39;*/release.test&#39;]], doGenerateSubmoduleConfigurations: false, extensions: [], submoduleCfg: [], userRemoteConfigs: [[credentialsId: &#39;11&#39;, url: &#39;http://xxxx.xxxxxx.com:8888/xxxx/xxxxxx.git&#39;]]]) } } stage(&#39;SonarQube&#39;) { steps{ sh &quot;sonar-scanner -X -Dsonar.host.url=http://172.16.72.182:8888/ -Dsonar.language=php -Dsonar.projectVersion=$BUILD_NUMBER -Dsonar.sources=./app -Dsonar.sourceEncoding=UTF-8 -Dsonar.projectName=$JOB_BASE_NAME -Dsonar.projectKey=$JOB_BASE_NAME -Dsonar.login=a65d0c254cfxx2ax013bcxe93xb8xg13f25b2407&quot; } } } }","categories":[],"tags":[]},{"title":"æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ","slug":"æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ","date":"2021-03-18T03:09:52.071Z","updated":"2021-03-18T03:09:52.072Z","comments":true,"path":"2021/03/18/æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/","excerpt":"","text":"ç¬¬ä¹ç« ï¼šè™šæ‹Ÿå†…å­˜1ã€ä»€ä¹ˆæ˜¯è™šæ‹Ÿå†…å­˜ï¼Ÿè™šæ‹Ÿå†…å­˜æ˜¯ç£ç›˜ä¸Š(è¾ƒä½å±‚)è¿ç»­Nä¸ªå­—èŠ‚ç»„æˆçš„æ•°ç»„ï¼Œæ¯ä¸ªå­—èŠ‚éƒ½æœ‰å”¯ä¸€çš„è™šæ‹Ÿåœ°å€ä½œä¸ºæ•°ç»„çš„ç´¢å¼•ï¼Œç£ç›˜ä¸Šæ•°ç»„çš„å†…å®¹è¢«ç¼“å­˜åœ¨ä¸»å­˜ä¸­ã€‚(è™šæ‹Ÿé¡µå­˜åœ¨äºç£ç›˜ä¸Š) ç‰©ç†å†…å­˜è¢«åˆ†éš”æˆç‰©ç†é¡µ(Physical Page,PP)ã€‚ VMç³»ç»Ÿå°†è™šæ‹Ÿå†…å­˜åˆ†éš”æˆè™šæ‹Ÿé¡µ(Virtual Page,VP)ï¼Œè™šæ‹Ÿé¡µé¢çš„é›†åˆåˆ†ä¸ºä¸‰ä¸ªä¸ç›¸äº¤çš„å­é›†ï¼š æœªåˆ†é…çš„(VMç³»ç»Ÿè¿˜æœªåˆ†é…æˆ–è€…æœªåˆ›å»ºçš„é¡µï¼Œæœªåˆ†é…çš„å—æ²¡æœ‰ä»»ä½•æ•°æ®å’Œä»–ä»¬ç›¸å…³è”ï¼Œå› ä¸ºä¸å ç”¨ä»»ä½•ç£ç›˜ç©ºé—´)ã€‚ ç¼“å­˜çš„(å·²ç¼“å­˜åœ¨ç‰©ç†å†…å­˜ä¸­çš„å·²åˆ†é…é¡µ)ã€‚ æœªç¼“å­˜çš„(æœªç¼“å­˜åœ¨ç‰©ç†å†…å­˜ä¸­çš„å·²åˆ†é…é¡µ)ã€‚ 2ã€DRAMç¼“å­˜ç»„ç»‡ç»“æ„ SRAMï¼šè¡¨ç¤ºä½äºcpuå’Œä¸»å­˜ä¹‹é—´çš„L1ã€L2ã€L3é«˜é€Ÿç¼“å­˜ã€‚ DRAMï¼šè¡¨ç¤ºè™šæ‹Ÿå†…å­˜ç³»ç»Ÿçš„ç¼“å­˜ï¼Œå®ƒåœ¨ä¸»å­˜ä¸­ç¼“å­˜è™šæ‹Ÿé¡µã€‚ ç›´ å†™ï¼šå½“ CPU è¦å°†æ•°æ®å†™å…¥å†…å­˜æ—¶ é™¤äº†æ›´æ–°ç¼“å†²å†…å­˜(é«˜é€Ÿç¼“å­˜L1ã€L2ã€L3)ä¸Šçš„æ•°æ®å¤–ä¹Ÿå°†æ•°æ®å†™åœ¨ DRAM ä¸­ ä»¥ç»´æŒä¸»å­˜ä¸ç¼“å†²å†…å­˜çš„ä¸€è‡´æ€§ å½“è¦å†™å…¥å†…å­˜çš„æ•°æ®ä¸€å¤š é€Ÿåº¦è‡ªç„¶å°±æ…¢äº†ä¸‹æ¥ å› å†™ï¼šæ¯å½“ CPU è¦å°†æ•°æ®å†™å…¥å†…å­˜æ—¶ åªä¼šå…ˆæ›´æ–°ç¼“å†²å†…å­˜(é«˜é€Ÿç¼“å­˜L1ã€L2ã€L3)ä¸Šçš„æ•°æ® éšåå†è®©ç¼“å†²å†…å­˜åœ¨æ€»çº¿ä¸å¡è½¦çš„æ—¶å€™ æ‰æŠŠæ•°æ®å†™å› DRAM æ‰€ä»¥é€Ÿåº¦è‡ªç„¶å¿«å¾—å¤š 3ã€é¡µè¡¨è™šæ‹Ÿå†…å­˜å¿…é¡»æœ‰æŸç§æ–¹æ³•æ¥åˆ¤å®šä¸€ä¸ªè™šæ‹Ÿé¡µæ˜¯å¦ç¼“å­˜åœ¨DRAMä¸­çš„æŸä¸ªåœ°æ–¹ã€‚å¦‚æœæ˜¯ï¼Œç³»ç»Ÿè¿˜å¿…é¡»ç¡®å®šè¿™ä¸ªè™šæ‹Ÿé¡µå­˜æ”¾åœ¨å“ªä¸ªç‰©ç†é¡µ(ä¸»å­˜)ã€‚å¦‚æœä¸å‘½ä¸­è¿˜å¿…é¡»åˆ¤æ–­è¿™ä¸ªè™šæ‹Ÿé¡µå­˜æ”¾åœ¨ç£ç›˜çš„å“ªä¸ªä½ç½®ä¸Šï¼Œåœ¨ç‰©ç†é¡µä¸­é€‰æ‹©ä¸€ä¸ªç‰ºç‰²é¡µï¼Œå¹¶å°†è™šæ‹Ÿé¡µä»ç£ç›˜å¤åˆ¶åˆ°DRAMä¸­ï¼Œæ›¿æ¢è¿™ä¸ªç‰ºç‰²é¡µã€‚(æ“ä½œç³»ç»Ÿä¸ºæ¯ä¸ªè¿›ç¨‹éƒ½ç»´æŠ¤ä¸€ä¸ªç‹¬ç«‹çš„é¡µè¡¨) é¡µè¡¨ï¼šå°†è™šæ‹Ÿé¡µæ˜ å°„åˆ°ç‰©ç†é¡µã€‚æ¯æ¬¡åœ°å€ç¿»è¯‘ç¡¬ä»¶å°†ä¸€ä¸ªè™šæ‹Ÿåœ°å€è½¬æ¢ä¸ºç‰©ç†åœ°å€æ—¶ï¼Œéƒ½ä¼šè¯»å–é¡µè¡¨ï¼Œæ“ä½œç³»ç»Ÿè´Ÿè´£ç»´æŠ¤é¡µè¡¨çš„å†…å®¹ï¼Œä»¥åŠåœ¨ç£ç›˜ä¸DRAMä¹‹é—´æ¥å›ä¼ é€é¡µã€‚ æˆ‘ä»¬å°†å‡è®¾æ¯ä¸ªPTEæ˜¯ç”±ä¸€ä¸ªæœ‰æ•ˆä½(valid bit)å’Œä¸€ä¸ªnä½åœ°å€å­—æ®µç»„æˆï¼Œæœ‰æ•ˆä½è¡¨æ˜äº†è¯¥è™šæ‹Ÿé¡µå½“å‰æ˜¯å¦è¢«ç¼“å­˜åœ¨DRAMä¸­ã€‚å¦‚æœè®¾ç½®äº†æœ‰æ•ˆä½ï¼Œé‚£ä¹ˆåœ°å€å­—æ®µå°±è¡¨ç¤ºDRAMä¸­ç›¸åº”çš„ç‰©ç†é¡µçš„èµ·å§‹ä½ç½®ï¼Œè¿™ä¸ªç‰©ç†é¡µä¸­ç¼“å­˜äº†è¯¥è™šæ‹Ÿé¡µã€‚ å¦‚æœæ²¡æœ‰è®¾ç½®æœ‰æ•ˆä½ï¼Œé‚£ä¹ˆä¸€ä¸ªç©ºåœ°å€è¡¨ç¤ºè¿™ä¸ªè™šæ‹Ÿé¡µè¿˜æœªè¢«åˆ†é…ã€‚å¦åˆ™ï¼Œè¿™ä¸ªåœ°å€å°±æŒ‡å‘è¯¥è™šæ‹Ÿé¡µåœ¨ç£ç›˜ä¸Šçš„èµ·å§‹ä½ç½®ã€‚ 4ã€ç¼ºé¡µDRAMç¼“å­˜ä¸å‘½ä¸­ç§°ä¸ºç¼ºé¡µã€‚ è‡ªå·±çš„ç†è§£ï¼šåœ¨cpuè·å–è™šæ‹Ÿé¡µä¸­çš„æ•°æ®æ—¶ï¼Œåœ°å€ç¿»è¯‘ç¡¬ä»¶å»è¯»é¡µè¡¨çš„é¡µè¡¨è®°å½•çš„æœ‰æ•ˆä½ï¼Œå¦‚æœæœ‰æ•ˆä½ä¸º0åˆ™æ¨æ–­å‡ºè¯¥è™šæ‹Ÿé¡µæœªè¢«ç¼“å­˜ï¼Œå¹¶ä¸”è§¦å‘ä¸€ä¸ªç¼ºé¡µå¼‚å¸¸ã€‚ç¼ºé¡µå¼‚å¸¸è°ƒç”¨å†…æ ¸ä¸­çš„ç¼ºé¡µå¼‚å¸¸å¤„ç†ç¨‹åºï¼Œè¯¥ç¨‹åºä¼šåœ¨ä¸»å­˜çš„PP(ç‰©ç†é¡µ)ä¸­é€‰æ‹©ä¸€ä¸ªè¢«ç¼“å­˜çš„VPä½œä¸ºç‰ºç‰²é¡µï¼Œæ¥ä¸‹æ¥å°†è¦ç¼“å­˜çš„vpä»ç£ç›˜ä¸­åŠ è½½å‡ºæ¥ç¼“å­˜åˆ°ä¸»å­˜ä¸Šå»(æ›¿æ¢ç‰ºç‰²é¡µ)ã€‚ 5ã€åœ°å€ç¿»è¯‘å½“é¡µé¢å‘½ä¸­æ—¶ï¼ŒCPUç¡¬ä»¶æ‰§è¡Œçš„æ­¥éª¤ï¼š å¤„ç†å™¨ç”Ÿæˆä¸€ä¸ªè™šæ‹Ÿåœ°å€ï¼Œå¹¶æŠŠå®ƒä¼ é€ç»™MMUã€‚ MMUç”ŸæˆPTEåœ°å€ï¼Œå¹¶ä»é«˜é€Ÿç¼“å­˜/ä¸»å­˜è¯·æ±‚å¾—åˆ°å®ƒã€‚ é«˜é€Ÿç¼“å­˜/ä¸»å­˜å‘MMUè¿”å›PTEã€‚ MMUæ„é€ ç‰©ç†åœ°å€ï¼Œå¹¶æŠŠå®ƒä¼ ç»™å‘Šè¯‰ç¼“å­˜/ä¸»å­˜ã€‚ é«˜é€Ÿç¼“å­˜/ä¸»å­˜è¿”å›æ‰€è¯·æ±‚çš„æ•°æ®å­—ç»™å¤„ç†å™¨ã€‚ ç¼ºé¡µï¼ŒCPUç¡¬ä»¶æ‰§è¡Œæ­¥éª¤ï¼š å¤„ç†å™¨ç”Ÿæˆä¸€ä¸ªè™šæ‹Ÿåœ°å€ï¼Œå¹¶æŠŠå®ƒä¼ é€ç»™MMUã€‚ MMUç”ŸæˆPTEåœ°å€ï¼Œå¹¶ä»é«˜é€Ÿç¼“å­˜/ä¸»å­˜è¯·æ±‚å¾—åˆ°å®ƒã€‚ é«˜é€Ÿç¼“å­˜/ä¸»å­˜å‘MMUè¿”å›PTEã€‚ PTEä¸­çš„æœ‰æ•ˆä¸ºæ˜¯0ï¼Œæ‰€ä»¥MMUè§¦å‘äº†ä¸€æ¬¡å¼‚å¸¸ï¼Œä¼ é€’CPUä¸­çš„æ§åˆ¶åˆ°æ“ä½œç³»ç»Ÿå†…æ ¸ä¸­çš„ç¼ºé¡µå¼‚å¸¸å¤„ç†ç¨‹åºã€‚ ç¼ºé¡µå¤„ç†ç¨‹åºç¡®å®šå‡ºç‰©ç†å†…å­˜ä¸­çš„ç‰ºç‰²é¡µï¼Œå¦‚æœè¿™ä¸ªé¡µé¢ä¿®æ”¹äº†åˆ™æŠŠå®ƒæ¢å‡ºåˆ°ç£ç›˜ã€‚ ç¼ºé¡µå¤„ç†ç¨‹åºé¡µé¢è°ƒå…¥æ–°çš„é¡µé¢ï¼Œå¹¶æ›´æ–°å†…å­˜ä¸­çš„PTEã€‚ ç¼ºé¡µå¤„ç†ç¨‹åºè¿”å›åˆ°åŸæ¥çš„è¿›ç¨‹ï¼Œå†æ¬¡æ‰§è¡Œå¯¼è‡´ç¼ºé¡µçš„æŒ‡ä»¤ï¼ŒCPUå°†å¼•èµ·ç¼ºé¡µçš„è™šæ‹Ÿåœ°å€é‡æ–°å‘é€ç»™MMUã€‚","categories":[{"name":"Cè¯­è¨€","slug":"Cè¯­è¨€","permalink":"http://blog.3amupupup.online/categories/C%E8%AF%AD%E8%A8%80/"}],"tags":[{"name":"è™šæ‹Ÿå†…å­˜","slug":"è™šæ‹Ÿå†…å­˜","permalink":"http://blog.3amupupup.online/tags/%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98/"}]},{"title":"æ±‡ç¼–ç¬”è®°","slug":"æ±‡ç¼–ç¬”è®°","date":"2021-03-18T03:09:52.070Z","updated":"2021-03-18T03:09:52.071Z","comments":true,"path":"2021/03/18/æ±‡ç¼–ç¬”è®°/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/%E6%B1%87%E7%BC%96%E7%AC%94%E8%AE%B0/","excerpt":"","text":"AX = AH + AL BX = BH + BL CX = CH + CL DX = DH + DL æ•°æ®å¯„å­˜å™¨ æ®µåœ°å€å¯„å­˜å™¨ï¼šåç§»åœ°å€å¯„å­˜å™¨ DS SP ES BP SS SI CS DI â€‹ IP(å’ŒæŒ‡ä»¤æœ‰å…³) â€‹ BX uæŒ‡ä»¤ï¼šå°†å†…å­˜æŸä¸ªåœ°å€å¼€å§‹çš„å­—èŠ‚å…¨éƒ¨å½“åšæŒ‡ä»¤ dæŒ‡ä»¤ï¼šå°†æŸä¸ªå†…å­˜åœ°å€å¼€å§‹çš„å­—èŠ‚å…¨éƒ¨å½“åšæ•°æ® æŒ‡ä»¤å’Œæ•°æ®åœ¨å†…å­˜ä¸­æ˜¯æ²¡æœ‰åŒºåˆ«çš„ cpuä¸­çš„csæ®µåœ°å€å¯„å­˜å™¨å’Œipè¿™ä¸ªåç§»åœ°å€å¯„å­˜å™¨ç»„åˆçš„æ—¶å€™ï¼Œä»ä¸­è¯»å–çš„å†…å®¹å½“ä½œæŒ‡ä»¤æ¥æ‰§è¡Œ æŒ‡ä»¤æ˜¯æœ‰é•¿åº¦çš„ï¼Œä¸€æ¡æŒ‡ä»¤å¯ä»¥ç”±å¤šä¸ªå­—èŠ‚æ„æˆ æ‰§è¡Œè¿‡ç¨‹ï¼š 1ã€cpuä»cs:ipæ‰€æŒ‡å‘çš„å†…å­˜å•å…ƒè¯»å–æŒ‡ä»¤ï¼Œå­˜æ”¾åˆ°æŒ‡ä»¤ç¼“å­˜å™¨ä¸­ 2ã€ip = ip+æ‰€è¯»æŒ‡ä»¤çš„é•¿åº¦ï¼Œä»è€ŒæŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤ 3ã€æ‰§è¡ŒæŒ‡ä»¤ç¼“å­˜å™¨ä¸­çš„å†…å®¹ï¼Œæ¯åˆ°æ­¥éª¤1 æ±‡ç¼–æŒ‡ä»¤ jmp è½¬ç§»æŒ‡ä»¤ï¼Œå¯ä»¥ä¿®æ”¹cså’Œipè¿™ä¸¤ä¸ªå¯„å­˜å™¨ å†³å®šäº†cpuä»å“ªé‡Œè¯»å–æŒ‡ä»¤ debugè°ƒè¯•å·¥å…·ï¼š rï¼šå¯ä»¥æŸ¥çœ‹å’Œæ”¹å˜å¯„å­˜å™¨ä¸­çš„å†…å®¹ dï¼šå¯ä»¥æŸ¥çœ‹å†…å­˜ä¸­çš„å†…å®¹ uï¼šå¯ä»¥å°†å†…å­˜ä¸­çš„æœºå™¨æŒ‡ä»¤ç¿»è¯‘æˆæ±‡ç¼–æŒ‡ä»¤ u:åœ°å€ aï¼šå‘å†…å­˜å†™å…¥ä¸€æ¡æ±‡ç¼–æŒ‡ä»¤ tï¼šæ‰§è¡Œå½“å‰cs:ipæ‰€æŒ‡å‘çš„æœºå™¨æŒ‡ä»¤ eï¼šå¯ä»¥æ”¹å†™å†…å­˜ä¸­çš„å†…å®¹","categories":[],"tags":[]},{"title":"è¿›ç¨‹","slug":"è¿›ç¨‹","date":"2021-03-18T03:09:52.070Z","updated":"2021-03-18T03:09:52.070Z","comments":true,"path":"2021/03/18/è¿›ç¨‹/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/%E8%BF%9B%E7%A8%8B/","excerpt":"","text":"fork:fork()å‡½æ•°manæ‰‹å†Œï¼š forkå‡½æ•°é€šè¿‡è°ƒç”¨å®ƒçš„è¿›ç¨‹å¤åˆ¶å‡ºä¸€ä¸ªæ–°çš„è¿›ç¨‹(è°è°ƒç”¨å®ƒå¤åˆ¶è°ï¼Œå‡†ç¡®è¯´æ˜¯å…±äº«ï¼ˆæ¯”å¦‚ä»£ç æ®µï¼‰ï¼Œå¯¹äºç§æœ‰æ•°æ®é‡‡ç”¨å†™æ—¶å¤åˆ¶æœºåˆ¶)ã€‚ å­è¿›ç¨‹çš„çˆ¶è¿›ç¨‹idä¸çˆ¶è¿›ç¨‹ç›¸åŒ å­è¿›ç¨‹ä¸ç»§æ‰¿çˆ¶è¿›ç¨‹çš„å†…å­˜é” å­è¿›ç¨‹çš„èµ„æºåˆ©ç”¨ç‡å’Œcpuä½¿ç”¨æ—¶é—´è®¡æ•°ä¼šè¢«ç½®0ã€‚ å­è¿›ç¨‹ä¿¡å·é›†ä¸ºç©º(è¿›ç¨‹è¿è¡Œè¿‡ç¨‹ä¸­æ”¶åˆ°çš„ä¿¡å·éƒ½ä¼šä¿å­˜åœ¨ä¸€ä¸ªé›†åˆä¸­)ã€‚ å­è¿›ç¨‹ä¸ç»§æ‰¿çˆ¶è¿›ç¨‹çš„ä¿¡å·é‡(å¼•è‡ªç™¾åº¦ç™¾ç§‘ï¼šä¿¡å·é‡çš„å€¼ä¸ç›¸åº”èµ„æºçš„ä½¿ç”¨æƒ…å†µæœ‰å…³ï¼Œå½“å®ƒçš„å€¼å¤§äº 0 æ—¶ï¼Œè¡¨ç¤ºå½“å‰å¯ç”¨çš„èµ„æºæ•°çš„æ•°é‡ï¼›å½“å®ƒçš„å€¼å°äº 0 æ—¶ï¼Œå…¶ç»å¯¹å€¼è¡¨ç¤ºç­‰å¾…ä½¿ç”¨è¯¥èµ„æºçš„è¿›ç¨‹ä¸ªæ•°ã€‚ä¿¡å·é‡çš„å€¼ä»…èƒ½ç”± PV æ“ä½œæ¥æ”¹å˜ã€‚) å­è¿›ç¨‹ä¸ç»§æ‰¿çˆ¶è¿›ç¨‹çš„è®°å½•é”(The child does not inherit record locks from its parent (fcntl(2))) å­è¿›ç¨‹ä¸ç»§æ‰¿çˆ¶è¿›ç¨‹çš„è®¡æ—¶å™¨ã€‚ forkè°ƒç”¨çš„ä¸€ä¸ªå¥‡å¦™ä¹‹å¤„å°±æ˜¯å®ƒä»…ä»…è¢«è°ƒç”¨ä¸€æ¬¡ä½†æ˜¯è¿”å›ä¸¤æ¬¡ï¼š ä¸ºä»€ä¹ˆèƒ½è¿”å›ä¸¤æ¬¡ï¼šçˆ¶è¿›ç¨‹åˆ›å»ºå­è¿›ç¨‹æ—¶ï¼Œå­è¿›ç¨‹å…±äº«çˆ¶è¿›ç¨‹ä¸Šä¸‹æ–‡ï¼Œå…¶ä¸­ä¸Šä¸‹æ–‡åŒ…å«ç¨‹åºè®¡æ•°å™¨ï¼Œå®ƒé‡Œé¢å­˜å‚¨çš„æ˜¯ç¨‹åºè¦æ‰§è¡Œçš„ä¸‹ä¸€æ¡cpuæŒ‡ä»¤ã€‚ç¨‹åºæ‰§è¡Œåˆ°returnä¹‹å‰ï¼Œå­è¿›ç¨‹å·²å®Œæˆåˆ›å»ºï¼Œå¹¶ä¸”é€šè¿‡wake_up_new_taskå‡½æ•°å°†å­è¿›ç¨‹æ·»åŠ åˆ°å¯è°ƒåº¦é˜Ÿåˆ—ä¸­å»äº†ï¼Œæ­¤æ—¶å­è¿›ç¨‹å…±äº«çˆ¶è¿›ç¨‹çš„ç¨‹åºè®¡æ•°å™¨ï¼Œå®ƒä»¬çš„ç¨‹åºè®¡æ•°å™¨é‡Œçš„æŒ‡ä»¤éƒ½æŒ‡å‘tracehook_report_clone_completeå‡½æ•°ï¼Œå› æ­¤å½“å­è¿›ç¨‹æ‹¿åˆ°cpuæ—¶ï¼Œä¼šä»tracehook_report_clone_completeå¼€å§‹æ‰§è¡Œç›´è‡³returnã€‚å› æ­¤è°ƒç”¨forkå‡½æ•°ä¼šæœ‰ä¸¤æ¬¡è¿”å›ï¼Œä¸€æ¬¡æ˜¯çˆ¶è¿›ç¨‹ä¸­å¦ä¸€æ¬¡æ˜¯åœ¨å­è¿›ç¨‹ä¸­ã€‚ å‡½æ•°ï¼Œå½“å­è¿›ç¨‹æ‹¿åˆ°cpuæ—¶ï¼Œä¼šæ‰§è¡Œç¨‹åºè®¡æ•°å™¨ä¸­çš„æŒ‡ä»¤å³returnï¼Œæ‰€ä»¥forkå‡½æ•°ä¼šè¿”å›ä¸¤æ¬¡ï¼Œä¸€æ¬¡æ˜¯åœ¨çˆ¶è¿›ç¨‹ä¸­ï¼Œä¸€æ¬¡æ˜¯åœ¨å­è¿›ç¨‹ä¸­)ã€‚ å®ƒå¯èƒ½æœ‰ä¸‰ç§ä¸åŒçš„è¿”å›å€¼ï¼š åœ¨çˆ¶è¿›ç¨‹ä¸­ï¼Œfork()è¿”å›æ–°åˆ›å»ºçš„å­è¿›ç¨‹çš„pidã€‚ åœ¨å­è¿›ç¨‹ä¸­ï¼Œfork()è¿”å›0ã€‚ å¦‚æœfork()å‡ºç°é”™è¯¯ï¼Œè¿”å›ä¸€ä¸ªè´Ÿå€¼ã€‚ åœ¨forkå‡½æ•°æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œå¦‚æœåˆ›å»ºè¿›ç¨‹æˆåŠŸï¼Œåˆ™å‡ºç°ä¸¤ä¸ªè¿›ç¨‹ï¼Œä¸€ä¸ªæ˜¯å­è¿›ç¨‹ä¸€ä¸ªæ˜¯çˆ¶è¿›ç¨‹ã€‚åœ¨çˆ¶è¿›ç¨‹ä¸­è¿”å›æ–°åˆ›å»ºå­è¿›ç¨‹çš„pidï¼Œåœ¨å­è¿›ç¨‹ä¸­è¿”å›0ï¼Œå¯ä»¥é€šè¿‡forkè¿”å›å€¼åˆ¤æ–­å½“å‰è¿›ç¨‹æ˜¯çˆ¶è¿›ç¨‹è¿˜æ˜¯å­è¿›ç¨‹ã€‚ å¦å¤–æ ¹æ®ç¨‹åºçš„è¾“å‡ºä¿¡æ¯ï¼šçˆ¶è¿›ç¨‹ä¸­çš„ageç»“æœä¸º-1ï¼Œå­è¿›ç¨‹ä¸­çš„ageä¸º1ï¼Œä½†æ˜¯ageçš„åœ°å€åœ¨çˆ¶å­è¿›ç¨‹ä¸­ç›¸åŒã€‚çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹å…±äº«å†…å­˜ï¼Œä½†æ˜¯ä¸å…±äº«ç§æœ‰æ•°æ®ï¼Œä½¿ç”¨äº†å†™æ—¶å¤åˆ¶çš„æœºåˆ¶ã€‚ä½†æ˜¯pidä¸åŒ(ç°é˜¶æ®µè®¤çŸ¥)ã€‚å†…å­˜åœ°å€ç›¸åŒä½†æ˜¯å€¼å´ä¸ç›¸åŒï¼Œè¿™é‡Œéœ€è¦å­¦ä¹ ä¸€ä¸‹æ“ä½œç³»ç»Ÿ-è™šæ‹Ÿå†…å­˜ã€‚è¿™é‡Œè§£é‡Šä¸‹ï¼šè™½ç„¶çˆ¶å­è¿›ç¨‹ä¸­çš„ageçš„å†…å­˜åœ°å€ç›¸åŒï¼Œä½†æ˜¯ä»–ä»¬å½¼æ­¤ç‹¬ç«‹ä¸å¯è§ï¼Œè™šæ‹Ÿå†…å­˜åœ°å€ç›¸åŒä½†æ˜¯å®ƒä»¬å„è‡ªå¯¹åº”çš„ç‰©ç†åœ°å€ä¸ç›¸åŒã€‚ #include &lt;unistd.h&gt; #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; int main() { int age = 0; int pid; pid = fork(); if(pid &lt; 0) { printf(&quot;fork() error.\\n)&quot;); exit(-1); } else if (pid == 0) { age++; printf(&quot;I am child and my pid = %d, age = %d, addr = %p\\n&quot;,getpid(),age,&amp;age); } else if (pid &gt; 0) { age--; printf(&quot;I am parent and my Pid=%d, age = %d, addr = %p\\n&quot;,getpid(),age,&amp;age); } return 0; } // ç¼–è¯‘æ‰§è¡Œç»“æœï¼š // I am parent and my Pid=13086, age = -1, addr = 0x7fffc4e4dc98 // I am child and my pid = 13087, age = 1, addr = 0x7fffc4e4dc98 waitwaitpidpid_t waitpid(pid_t pid, int *statusp, int options); å½“options=0æ—¶ï¼ŒwaitpidæŒ‚èµ·è°ƒç”¨è¿›ç¨‹çš„æ‰§è¡Œï¼Œç›´åˆ°å®ƒçš„ç­‰å¾…é›†åˆä¸­çš„ä¸€ä¸ªè¿›ç¨‹ç»ˆæ­¢ï¼›å¦‚æœè¿™ä¸ªé›†åˆä¸­çš„ä¸€ä¸ªè¿›ç¨‹åœ¨åˆšè°ƒç”¨çš„æ—¶åˆ»å°±å·²ç»ç»ˆæ­¢ï¼Œé‚£ä¹ˆwaitpidç«‹å³è¿”å›ã€‚ åˆ¤å®šç­‰å¾…é›†åˆçš„æˆå‘˜ ç­‰å¾…é›†åˆçš„æˆå‘˜æ˜¯ç”± pid å‚æ•°å†³å®šçš„ï¼š pid &gt; 0 ï¼Œç­‰å¾…çš„é›†åˆå°±æ˜¯ä¸€ä¸ªå•ç‹¬çš„å­è¿›ç¨‹ï¼Œå®ƒçš„è¿›ç¨‹idç­‰äºpidã€‚ pid = -1ï¼Œé‚£ä¹ˆç­‰å¾…å°±æ˜¯çˆ¶è¿›ç¨‹çš„æ‰€æœ‰å­è¿›ç¨‹ç»„æˆçš„é›†åˆä¸­çš„ä»»æ„å­è¿›ç¨‹ã€‚ pid &lt; -1ï¼Œå›æ”¶è¿›ç¨‹ç»„idä¸ºabs(pid)çš„ä¸€ç»„è¿›ç¨‹ï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰å­è¿›ç¨‹ã€‚ pid = 0ï¼Œå›æ”¶ ä¸è°ƒç”¨è¿›ç¨‹ç»„idç›¸åŒç»„å†…çš„å­è¿›ç¨‹ã€‚ ä¿®æ”¹é»˜è®¤è¡Œä¸º 0 ä¸waitåŸºæœ¬æ²¡æœ‰åŒºåˆ«ã€‚ WNOHANG å¦‚æœç­‰å¾…é›†åˆä¸­çš„ä»»ä½•å­è¿›ç¨‹éƒ½æ²¡æœ‰ç»ˆæ­¢ï¼Œé‚£ä¹ˆç«‹å³è¿”å›(è¿”å›å€¼ä¸º0)ï¼Œå¦‚æœæœ‰å­è¿›ç¨‹é€€å‡ºè¿”å›é€€å‡ºå­è¿›ç¨‹çš„pidï¼Œå¤±è´¥è¿”å›-1(æ²¡æœ‰å­è¿›ç¨‹æˆ–è€…å­è¿›ç¨‹æ­»å…‰äº†)ã€‚åœ¨ç­‰å¾…å­è¿›ç¨‹ç»ˆæ­¢çš„åŒæ—¶å¦‚æœæƒ³åšå…¶å®ƒäº‹æƒ…ï¼Œè¿™ä¸ªé€‰é¡¹å¾ˆæœ‰ç”¨ã€‚ #include &lt;unistd.h&gt; #include &lt;sys/wait.h&gt; #include &lt;stdlib.h&gt; #include &lt;stdio.h&gt; int main() { int status; int pid; pid = fork(); if(pid == 0) { printf(&quot;I&#39;m child.\\n&quot;); sleep(3); exit(0); } while((pid = waitpid(-1,&amp;status,WNOHANG)) &gt; 0) { printf(&quot;child exit.\\n&quot;); } printf(&quot;I&#39;m parent.\\n&quot;); return 0; } // ä½¿ç”¨ WNOHANG çˆ¶è¿›ç¨‹ä¸ä¼šç­‰å¾…è‡ªå·±æˆé€€å‡ºï¼Œæ‰€ä»¥æ‰§è¡Œæ•ˆæœæ˜¯: çˆ¶è¿›ç¨‹ã€å­è¿›ç¨‹æ‰§è¡Œå„è‡ªçš„ä»£ç ï¼Œçˆ¶è¿›ç¨‹æ‰§è¡Œå®Œæ¯•ä¹‹åé€€å‡ºï¼Œå› ä¸ºå­è¿›ç¨‹sleep(3)ï¼Œæ‰€ä»¥å­è¿›ç¨‹åœ¨è¾“å‡ºæ‰“å°ä¹‹åä¸‰ç§’é’Ÿé€€å‡ºã€‚ WUNTRACED æŒ‚èµ·è°ƒåŠ¨è¿›ç¨‹çš„æ‰§è¡Œï¼Œç›´åˆ°ç­‰å¾…é›†åˆä¸­çš„ä¸€ä¸ªè¿›ç¨‹å˜æˆå·²ç»ˆæ­¢æˆ–è€…åœæ­¢ã€‚è¿”å›çš„pidä¸ºå¯¼è‡´è¿”å›çš„å·²ç»ˆæ­¢æˆ–è¢«åœæ­¢å­è¿›ç¨‹çš„pidã€‚é»˜è®¤çš„è¡Œä¸ºæ˜¯åªè¿”å›å·²ç»ˆæ­¢å­è¿›ç¨‹ã€‚åœ¨æƒ³è¦æ£€æŸ¥å·²ç»ˆæ­¢æˆ–å·²åœæ­¢çš„å­è¿›ç¨‹æ—¶ï¼Œè¿™ä¸ªé€‰é¡¹æ¯”è¾ƒæœ‰ç”¨ã€‚ #include &lt;unistd.h&gt; #include &lt;sys/wait.h&gt; #include &lt;stdlib.h&gt; #include &lt;stdio.h&gt; int main() { int status; int pid; pid = fork(); if(pid == 0) { printf(&quot;child run and pid = %d\\n&quot;,getpid()); printf(&quot;I&#39;m child.\\n&quot;); sleep(3); exit(0); } while((pid = waitpid(-1,&amp;status,WUNTRACED)) &gt; 0) { printf(&quot;child exit who pid = %d.\\n&quot;,pid); } printf(&quot;I&#39;m parent.\\n&quot;); return 0; } // root$ ./a.out // child run and pid = 26334 // I&#39;m child. // child exit who pid = 26334. // I&#39;m parent. WCONTINUED æŒ‚èµ·è°ƒç”¨è¿›ç¨‹çš„æ‰§è¡Œï¼Œç›´åˆ°ç­‰å¾…é›†åˆä¸­ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ç»ˆæ­¢æˆ–è€…ç­‰å¾…é›†åˆä¸­ä¸€ä¸ªè¢«åœæ­¢çš„è¿›ç¨‹æ”¶åˆ°SIGCONTä¿¡å·é‡æ–°å¼€å§‹æ‰§è¡Œã€‚ ç»„åˆä½¿ç”¨ï¼šWNOHANG | WUNTRACED ç«‹å³è¿”å›ï¼Œå¦‚æœç­‰å¾…é›†åˆä¸­çš„å­è¿›ç¨‹éƒ½æ²¡æœ‰åœæ­¢æˆ–è€…ç»ˆæ­¢åˆ™è¿”å›0ï¼Œå¦‚æœæœ‰ä¸€ä¸ªåœæ­¢æˆ–è€…ç»ˆæ­¢åˆ™è¿”å›è¯¥å­è¿›ç¨‹çš„pidã€‚ æ£€æŸ¥å·²å›æ”¶å­è¿›ç¨‹çš„é€€å‡ºçŠ¶æ€ å¦‚æœstatuspå‚æ•°æ˜¯éç©ºçš„ï¼Œé‚£ä¹ˆæ“ä½œç³»ç»Ÿå°±ä¼šè¯»å–è¿›ç¨‹çš„PCBï¼Œä¿å­˜åœ¨statusæŒ‡å‘çš„å˜é‡ä¸­ã€‚ statusä¸­ä¿å­˜çš„å°±æ˜¯è¿›ç¨‹é€€å‡ºçš„ä¿¡æ¯ï¼Œintæ˜¯32bitï¼Œæ˜¯å¦æ­£å¸¸è¿è¡Œï¼Œé€€å‡ºç æ˜¯å¤šå°‘ï¼Œé€€å‡ºä¿¡å·æ˜¯å¤šå°‘ã€‚ #include &lt;unistd.h&gt; #include &lt;sys/wait.h&gt; #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; int main() { int status = 0; pid_t id = fork(); if(id &lt; 0) { perror(&quot;fork error!\\n&quot;); } else if(id == 0) // child { printf(&quot;i am child process\\n&quot;); int count = 0; while (count &lt; 5) { sleep(1); count++; printf(&quot;sleep 1\\n&quot;); } // int ret = 1/0; // exit(99); exit(0); } // parent printf(&quot;father wait before.\\n&quot;); pid_t ret = waitpid(id,&amp;status,0); printf(&quot;status = %d\\n&quot;,status); // ä¿å­˜å­è¿›ç¨‹çš„è¿”å›çŠ¶æ€ if(ret &gt; 0) { printf(&quot;å­è¿›ç¨‹ç»ˆæ­¢ä¿¡å·: %d\\n&quot;, status &amp; 0x7f); // 0 è¡¨ç¤ºæ˜¯æ­£å¸¸é€€å‡º printf(&quot;å­è¿›ç¨‹é€€å‡ºç : %d\\n&quot;,(status &gt;&gt; 8) &amp; 0xff); printf(&quot;wait success!\\n&quot;); if(status &amp; 0x7f) // é0åˆ™è¯´æ˜å­è¿›ç¨‹ä¸æ˜¯æ­£å¸¸é€€å‡ºçš„ { printf(&quot;child run error!\\n&quot;); } else { if((status&gt;&gt;8) &amp; 0xff) // è¿è¡ŒæˆåŠŸä½†æ˜¯ç»“æœä¸æ­£ç¡® { printf(&quot;child run success, but result is not right, exit code: %d\\n&quot;,(status&gt;&gt;8)&amp;0xff); } else { printf(&quot;child run success and result is right,exit code: %d\\n&quot;,(status&gt;&gt;8)&amp;0xff); } } } else { printf(&quot;wait failed!\\n&quot;); } printf(&quot;father wait after.\\n&quot;); return 0; } å›¾ä¸­åœ¨å­è¿›ç¨‹sleepçš„æ—¶å€™ç»™å…¶å‘é€äº†ä¸€ä¸ªSIGSTOPä¿¡å·å¯¼è‡´å­è¿›ç¨‹é€€å‡ºï¼Œstatusä¸­ä¿å­˜çš„æ˜¯å­è¿›ç¨‹ç»ˆæ­¢çš„çŠ¶æ€ä¿¡æ¯ã€‚ æ ‡å‡†åº“ä¸­ä¹Ÿæä¾›ä¸€äº›å®å‡½æ•°æ¥æ£€æµ‹è¿›ç¨‹çš„é€€å‡ºçŠ¶æ€ï¼š WIFEXITED(status): å¦‚æœä¸ºæ­£å¸¸å­è¿›ç¨‹ç»ˆæ­¢å­è¿›ç¨‹çš„è¿”å›çŠ¶æ€ï¼Œåˆ™ä¸ºçœŸã€‚(æŸ¥çœ‹å­è¿›ç¨‹æ˜¯å¦æ­£å¸¸é€€å‡ºï¼š! (status &amp; 0x7f)) WEXITSTATUS(status): å¦‚æœWIFEXITED(status)ä¸ºéé›¶ï¼Œæå–å­è¿›ç¨‹é€€å‡ºç ã€‚(æŸ¥çœ‹å­è¿›ç¨‹é€€å‡ºç : (status&gt;&gt;8)&amp;0xff)) #include &lt;unistd.h&gt; #include &lt;sys/wait.h&gt; #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; int main() { int status = 0; pid_t id = fork(); if(id &lt; 0) { perror(&quot;fork error!\\n&quot;); } else if(id == 0) // child { printf(&quot;i am child process\\n&quot;); int count = 0; while (count &lt; 3) { sleep(1); count++; printf(&quot;sleep 1\\n&quot;); } int ret = 1/0; exit(10); } // parent printf(&quot;father wait before.\\n&quot;); pid_t ret = waitpid(id,&amp;status,0); printf(&quot;status = %d\\n&quot;,status); // ä¿å­˜å­è¿›ç¨‹çš„è¿”å›çŠ¶æ€ if(WIFEXITED(status)) // ä¸ºçœŸè¯´æ˜æ˜¯æ­£å¸¸é€€å‡ºçš„ { printf(&quot;child exit code: %d\\n&quot;,WEXITSTATUS(status)); } else { printf(&quot;child exit error!\\n&quot;); } printf(&quot;father wait after.\\n&quot;); return 0; } IPCpipe#include &lt;unistd.h&gt; #include &lt;stdio.h&gt; #include &lt;sys/wait.h&gt; int main() { int fd[2]; pipe(fd); // fd[1]æ˜¯å†™ç«¯ï¼Œfd[0]æ˜¯è¯»ç«¯ int pid = fork(); if(pid == 0) { sleep(3); write(fd[1],&quot;hello world\\n&quot;,13); } else if(pid &gt; 0) { waitpid(-1,NULL,0); char buf[20]={0}; int ret = read(fd[0],buf,sizeof(buf)); // readä¼šé˜»å¡ç­‰å¾… if(ret&gt;0) write(STDOUT_FILENO,buf,ret); } return 0; } ç®¡é“å¤§å° [root@iZbp11u8qxiwepq15dm1liZ ComputerSystem]# ulimit -a core file size (blocks, -c) 0 data seg size (kbytes, -d) unlimited scheduling priority (-e) 0 file size (blocks, -f) unlimited pending signals (-i) 6946 max locked memory (kbytes, -l) 64 max memory size (kbytes, -m) unlimited open files (-n) 65535 pipe size (512 bytes, -p) 8 POSIX message queues (bytes, -q) 819200 real-time priority (-r) 0 stack size (kbytes, -s) 8192 cpu time (seconds, -t) unlimited max user processes (-u) 6946 virtual memory (kbytes, -v) unlimited file locks (-x) unlimited å¯ä»¥çœ‹åˆ°åœ¨linuxç³»ç»Ÿä¸Špipe size ä¸º512bytes * 8 = 4096bytesã€‚ ä¼˜ç‚¹ï¼šç®€å• ç¼ºç‚¹ï¼š åªèƒ½æœ‰è¡€ç¼˜å…³ç³»çš„è¿›ç¨‹ä¹‹é—´æ‰èƒ½ä½¿ç”¨ åªèƒ½å•å‘é€šä¿¡(åŠåŒå·¥é€šä¿¡)ï¼Œå¦‚æœéœ€è¦åŒå‘é€šä¿¡éœ€è¦åˆ›å»ºä¸¤ä¸ªç®¡é“ FIFOæœ‰åç®¡é“ï¼Œå®ç°æ— è¡€ç¼˜å…³ç³»è¿›ç¨‹é€šä¿¡ã€‚ åˆ›å»ºä¸€ä¸ªç®¡é“çš„ä¼ªæ–‡ä»¶ int mkfifo(const char *pathname, mode_t mode); mkfifo fifoName å‘½ä»¤åˆ›å»º å†…æ ¸ä¼šç»™fifoæ–‡ä»¶å¼€è¾Ÿä¸€ä¸ªç¼“å†²åŒºï¼Œæ“ä½œfifoæ–‡ä»¶ï¼Œå¯ä»¥æ“ä½œç¼“å†²åŒºï¼Œå®ç°è¿›ç¨‹é€šä¿¡â€“å®é™…ä¸Šå°±æ˜¯æ–‡ä»¶è¯»å†™ #include &lt;stdio.h&gt; #include &lt;unistd.h&gt; #include &lt;sys/types.h&gt; #include &lt;sys/stat.h&gt; #include &lt;fcntl.h&gt; #include &lt;string.h&gt; #define FIFO &quot;/root/ComputerSystem/myfifo&quot; // shell: mkfifo myfifo int main() { int fd = open(FIFO,O_WRONLY); // å¦‚æœæ²¡æœ‰ç¨‹åº readï¼Œopenä¼šé˜»å¡ char buf[256]; int num = 1; while(1) { memset(buf,0x00,sizeof(buf)); sprintf(buf,&quot;hello%d&quot;,num++); write(fd,buf,strlen(buf)); sleep(1); } close(fd); return 0; } // è‹¥æ— è¯»ç«¯å†™ç«¯opené˜»å¡ #include &lt;stdio.h&gt; #include &lt;unistd.h&gt; #include &lt;sys/types.h&gt; #include &lt;sys/stat.h&gt; #include &lt;fcntl.h&gt; int main() { int fd = open(&quot;myfifo&quot;,O_RDONLY); char buf[256]; int num = 1; while(1) { int ret = read(fd,buf,sizeof(buf)); if(ret &gt; 0) { printf(&quot;read:%s\\n&quot;,buf); } } close(fd); return 0; } // è‹¥æ— å†™ç«¯è¯»ç«¯é˜»å¡ï¼Œæœ‰ç‚¹ç±»ä¼¼golangé‡Œçš„æ— ç¼“å†²channel linuxç³»ç»Ÿä¸Šé€šè¿‡å‘½ä»¤ï¼šman 7 signal æŸ¥çœ‹ä¿¡å·çš„æ‰‹å†Œ è‹¥è¯»ç«¯å…³é—­ï¼Œå†™ç«¯ä¹Ÿä¼šç»ˆæ­¢ã€‚è‡³äºä¸ºä»€ä¹ˆä¼šå…³é—­ï¼Œå¦‚ä¸‹è§£é‡Šï¼š æ‰§è¡Œå†™ç«¯ç¨‹åºæ—¶ï¼Œopenå‡½æ•°æ‰“å¼€ç®¡é“æ–‡ä»¶ myfifoï¼Œç”±äºæ²¡æœ‰è¯»ç«¯ï¼Œæ‰€ä»¥å†™ç«¯ä¼šé˜»å¡ä½ã€‚å½“æ‰§è¡Œè¯»ç«¯ç¨‹åºä¹‹å openåœæ­¢é˜»å¡ ç»§ç»­å‘ä¸‹æ‰§è¡Œå¼€å§‹å¾€ç®¡é“é‡Œå†™æ•°æ®ã€‚å½“å…³é—­è¯»ç«¯æ—¶ï¼Œæ“ä½œç³»ç»Ÿå‘é€ sigpipe ä¿¡å·ç»™å†™ç«¯ã€‚ç”±å›¾å¯çŸ¥ sigpipe æ˜¯ä¸€ä¸ªTerm(terminate)ä¿¡å·ï¼Œæ‰€ä»¥å†™ç«¯ç¨‹åºç»ˆæ­¢é€€å‡ºã€‚ nmap","categories":[{"name":"Cè¯­è¨€","slug":"Cè¯­è¨€","permalink":"http://blog.3amupupup.online/categories/C%E8%AF%AD%E8%A8%80/"}],"tags":[{"name":"è¿›ç¨‹","slug":"è¿›ç¨‹","permalink":"http://blog.3amupupup.online/tags/%E8%BF%9B%E7%A8%8B/"}]},{"title":"Cæ·±å…¥å‰–æ","slug":"Cæ·±å…¥å‰–æ","date":"2021-03-18T03:09:52.069Z","updated":"2021-03-18T03:09:52.070Z","comments":true,"path":"2021/03/18/Cæ·±å…¥å‰–æ/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/C%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90/","excerpt":"","text":"å®šä¹‰å’Œå£°æ˜ å®šä¹‰ï¼šç¼–è¯‘å™¨åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œä¸ºè¿™ä¸ªå¯¹è±¡åˆ†é…ä¸€å—å†…å­˜å¹¶ç»™å®ƒå–ä¸€ä¸ªåå­—ï¼Œåå­—å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„å˜é‡æˆ–å¯¹è±¡åã€‚ int a; å£°æ˜ï¼šå‘Šè¯‰ç¼–è¯‘å™¨ï¼Œè¿™ä¸ªåå­—å·²ç»åŒ¹é…åˆ°ä¸€å—å†…å­˜ä¸Šäº†ï¼›å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œè¿™ä¸ªåå­—é¢„å®šäº†ï¼Œå…¶å®ƒåœ°æ–¹ä¸èƒ½å†ä½¿ç”¨ï¼Œè¿™ç§å£°æ˜çš„æœ€å…¸å‹ä¾‹å­å°±æ˜¯å£°æ˜ä¸€ä¸ªå‡½æ•°ï¼›å£°æ˜ä¸ä¼šåˆ†é…å†…å­˜ã€‚ extern inn a; void func(int a); //å£°æ˜ä¸€ä¸ªå‡½æ•° struct #include &lt;stdio.h&gt; struct stu { } s1; int main(){ printf(&quot;%lu\\n&quot;,sizeof(s1)); // 0 return 0; } // ç¼–è¯‘å™¨gcc æŸ”æ€§æ•°ç»„ #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; typedef struct { int a; int b[]; } soft_arr; int main() { printf(&quot;%lu\\n&quot;,sizeof(soft_arr)); // 4 soft_arr *p = malloc(sizeof(soft_arr)+sizeof(int)); free(p); return 0; } ç»“æ„ä¸­æœ€åä¸€ä¸ªæˆå‘˜å…è®¸æ˜¯ä¸€ä¸ªæœªçŸ¥å¤§å°çš„æ•°ç»„ï¼Œè¿™ä¸ªæˆå‘˜å«åšæŸ”æ€§æ•°ç»„ã€‚sizefo è¿”å›è¿™ç§ç±»å‹çš„å¤§å°ä¸åŒ…æ‹¬æŸ”æ€§æ•°ç»„çš„å†…å­˜ã€‚åŒ…å«æŸ”æ€§æ•°ç»„æˆå‘˜çš„ç»“æ„ç”¨mallocè¿›è¡Œå†…å­˜åŠ¨æ€åˆ†é…ã€‚(åº”ç”¨ï¼šæ¯”å¦‚ç½‘ç»œé€šä¿¡ï¼Œæ”¶å‘æ•°æ®åŒ…) union union Person { char *name; int age; char *addr; double balance; }; int main() { printf(&quot;%lu\\n&quot;,sizeof(union Person)); return 0; } unionç»´æŠ¤è¶³å¤Ÿçš„ç©ºé—´æ¥ç½®æ”¾å¤šä¸ªæˆå‘˜çš„æŸä¸€ä¸ªæˆå‘˜ï¼Œè€Œä¸æ˜¯ä¸ºæ¯ä¸ªæ•°æ®æˆå‘˜é…ç½®ç©ºé—´ã€‚åœ¨unionä¸­æ‰€æœ‰æˆå‘˜å…¬ç”¨ä¸€ä¸ªç©ºé—´ï¼ŒåŒä¸€æ—¶é—´åªèƒ½å­˜å‚¨å…¶ä¸­ä¸€ä¸ªæ•°æ®æˆå‘˜ï¼Œæ‰€æœ‰æ•°æ®æˆå‘˜æ‹¥æœ‰ç›¸åŒçš„èµ·å§‹åœ°å€ã€‚ ä¸€ä¸ªunionéœ€è¦é…ç½®è¶³å¤Ÿçš„ç©ºé—´æ¥å®¹çº³æ‰€æœ‰æˆå‘˜ã€‚ä¸Šè¿°ä¾‹å­ä¸­ï¼šdoubleå ç”¨å†…å­˜ç©ºé—´æœ€å¤§ï¼Œæ‰€ä»¥Personçš„å†…å­˜å¤§å°æ˜¯8å­—èŠ‚ã€‚ å¤§å°ç«¯å¯¹unionçš„å½±å“ï¼š union T { char a; int b; }; int main() { union T t1; t1.b = 1; printf(&quot;%d\\n&quot;,t1.a); return 0; } enum enum Color { RED, BLACK, WHITE, YELLOW, }; int main(){ RED = 3; // expression is not assignable return 0; } auto ç¼–è¯‘å™¨åœ¨é»˜è®¤ç¼ºçœçš„æƒ…å†µä¸‹ï¼Œæ‰€æœ‰å˜é‡éƒ½æ˜¯autoã€‚ register è¯·æ±‚ç¼–è¯‘å™¨å°½å¯èƒ½çš„å°†è¿™ä¸ªå˜é‡å­˜åœ¨cpuå†…éƒ¨çš„å¯„å­˜å™¨ä¸­è€Œä¸æ˜¯é€šè¿‡å†…å­˜å¯»å€è®¿é—®ã€‚registerå˜é‡å¯èƒ½ä¸å­˜æ”¾åœ¨å†…å­˜ä¸­ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨&amp;ç¬¦å–åœ°å€ã€‚ static ä¿®é¥°å˜é‡ã€‚ å˜é‡åˆ†å±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡ï¼Œè¢«staticä¿®é¥°å®ƒä»¬éƒ½å­˜åœ¨äºå†…å­˜çš„é™æ€åŒºã€‚ é™æ€å…¨å±€å˜é‡ï¼šä½œç”¨åŸŸä»…é™äºå˜é‡è¢«å®šä¹‰çš„æ–‡ä»¶ä¸­ã€‚ å±€éƒ¨é™æ€å˜é‡ï¼šåªèƒ½åœ¨å®šä¹‰è¿™ä¸ªå±€éƒ¨é™æ€å˜é‡çš„å‡½æ•°ä½¿ç”¨ï¼Œå³ä½¿å‡½æ•°è°ƒç”¨ç»“æŸï¼Œè¿™ä¸ªå˜é‡ä¹Ÿä¸ä¼šæ¶ˆå¤±ã€‚ ä¿®é¥°å‡½æ•°ã€‚ å‡½æ•°å‰åŠ staticç§°ä¸ºé™æ€å‡½æ•°ï¼Œé™æ€ä¸æ˜¯æŒ‡å­˜å‚¨æ–¹å¼ï¼Œè€Œæ˜¯æ­¤å‡½æ•°çš„ä½œç”¨åŸŸä»…é™äºæœ¬æ–‡ä»¶å†…ã€‚ switch int main(){ int a = 4; int c=6; switch (a) { case 1: printf(&quot;1\\n&quot;); break; default: printf(&quot;default\\n&quot;); case 2: printf(&quot;2\\n&quot;); case 3: printf(&quot;3\\n&quot;); // case c: // error // printf(&quot;%d&quot;,c); // break; // case 3.14: // error // printf(&quot;3.14\\n&quot;); } } // output: // default // 2 // 3 caseååªèƒ½æ˜¯æ•´å½¢æˆ–å­—ç¬¦å‹å¸¸é‡æˆ–å¸¸é‡è¡¨è¾¾å¼ End0 0x01&lt;&lt;2+3 ç»“æœä¸º32ï¼Œ+çš„ä¼˜å…ˆçº§æ¯”&lt;&lt;é«˜ã€‚ å·¦ç§»å³ç§»çš„ä½æ•°ä¸èƒ½å¤§äºæ•°æ®çš„é•¿åº¦ï¼Œä¸èƒ½å°äº0ã€‚ ++iã€i++ int main(){ int i = 0; int j = (++i,++i,++i); // ++i å…ˆè‡ªå¢å†è¿›å®ƒå…¶ä»–è¿ç®—ã€‚iåœ¨é‡è§é€—å·ä¹‹åè®¤ä¸ºæœ¬è®¡ç®—å•ä½å·²ç»ç»“æŸï¼Œç„¶åè¿›è¡Œè‡ªå¢ã€‚ printf(&quot;j = %d\\n&quot;,j); // 3 int k = 0; int z = (k++,k++,k++); // i++ å…ˆè¿›è¡Œå…¶å®ƒè¿ç®—å†è‡ªå¢ printf(&quot;z = %d\\n&quot;,z); // 2 int x = 0; int y = (x++) + (x++) + (x++); printf(&quot;y = %d\\n&quot;,y); // 1+1+1=3 xé‡åˆ°åˆ†å·ä¹‹åæ‰è®¤ä¸ºæœ¬æ¬¡è®¡ç®—å•ä½å·²ç»“æŸï¼Œxè¿™æ—¶å€™æ‰ä¼šè¿›è¡Œè‡ªåŠ  } ++i+++i+++i int main(){ int a = 1; int b = 2; int ret = a+++b; // è´ªå¿ƒç®—æ³•ï¼ša++ + b printf(&quot;ret = %d\\n&quot;,ret); // ret = 3 } #defineå®å®šä¹‰æ³¨é‡Šç¬¦å· #define BSC // #define BMC /* #define EMC */ int main(){ int a = 10;BSC a is int DMC input a number:EMC } æ³¨é‡Šå…ˆäºé¢„å¤„ç†æŒ‡ä»¤è¢«å¤„ç†ã€‚å½“å‘ç”Ÿå®æ›¿æ¢æ—¶ï¼Œæ³¨é‡Šå·²ç»å¤„ç†å®Œæ¯•ï¼Œå†å‡ºç°//ã€/*åˆ™ä¼šå‡ºç°é”™è¯¯ã€‚ å®å®šä¹‰ä¸­çš„ç©ºæ ¼ #define SUM(x) (x)+(x) int main(){ int ret = SUM (3); return 0; } è¿™ä¸ªç©ºæ ¼ä»…åœ¨å®šä¹‰çš„æ—¶å€™æœ‰æ•ˆï¼Œåœ¨ä½¿ç”¨è¿™ä¸ªå®å‡½æ•°çš„æ—¶å€™ï¼Œç©ºæ ¼ä¼šè¢«å¿½ç•¥æ‰ã€‚å› æ­¤ï¼šSUM(x) å’ŒSUM (x)æ˜¯ä¸€æ ·çš„ã€‚ duweideMacBook-Pro:test duwei$ cat test.c #define SUM(x) (x)+(x) int main(){ int ret = SUM (3); return 0; } duweideMacBook-Pro:test duwei$ gcc -E test.c -o test.i duweideMacBook-Pro:test duwei$ cat test.i # 1 &quot;test.c&quot; # 1 &quot;&lt;built-in&gt;&quot; 1 # 1 &quot;&lt;built-in&gt;&quot; 3 # 361 &quot;&lt;built-in&gt;&quot; 3 # 1 &quot;&lt;command line&gt;&quot; 1 # 1 &quot;&lt;built-in&gt;&quot; 2 # 1 &quot;test.c&quot; 2 int main(){ int ret = (3)+(3); return 0; } duweideMacBook-Pro:test duwei$ - é¢„å¤„ç†ä½™ä¸‹éƒ¨åˆ†æš‚æ—¶çœç•¥ï¼Œä»¥åå›æ¥çœ‹ - ç•¥ - ç•¥ - ç•¥ - int *p = NULLå’Œ *p = NULLçš„åŒºåˆ« - ```c int *p = NULL; ``` å®šä¹‰ä¸€ä¸ªæŒ‡é’ˆå˜é‡pï¼Œå…¶æŒ‡å‘çš„å†…å­˜é‡Œé¢ä¿å­˜çš„æ˜¯intç±»å‹çš„æ•°æ®ï¼Œåœ¨å®šä¹‰å˜é‡pçš„åŒæ—¶æŠŠpçš„å€¼è®¾ä¸º0x00000000ï¼Œè¿™ä¸ªè¿‡ç¨‹å«åˆå§‹åŒ–ï¼Œæ˜¯åœ¨ç¼–è¯‘çš„æ—¶å€™è¿›è¡Œçš„ã€‚ - ```c int *p; *p = NULL; ``` ç¬¬ä¸€è¡Œä»£ç ï¼Œå®šä¹‰äº†ä¸€ä¸ªæŒ‡é’ˆå˜é‡pï¼Œå…¶æŒ‡å‘å†…å­˜é‡Œä¿å­˜çš„æ˜¯intç±»å‹çš„æ•°æ®ï¼Œæ­¤æ—¶på˜é‡æœ¬èº«æ˜¯å¤šå°‘ä¸å¯çŸ¥ï¼Œä¹Ÿå°±æ˜¯è¯´på˜é‡æ­¤æ—¶æŒ‡å‘çš„å†…å­˜åœ°å€å¯èƒ½æ˜¯ä¸ªéæ³•å€¼ã€‚ç¬¬äºŒè¡Œä»£ç ç»™*pèµ‹å€¼ä¸ºNULLï¼Œä¹Ÿå°±æ˜¯ç»™ *pæŒ‡å‘çš„å†…å­˜èµ‹å€¼NULLã€‚ç”±äºpå˜é‡çš„å†…å­˜åœ°å€å¯èƒ½æ˜¯éæ³•çš„ï¼Œæ‰€ä»¥åœ¨è°ƒè¯•æ—¶ç¼–è¯‘å™¨å¯èƒ½ä¼šæŠ¥é”™ã€‚ - ```c int main(){ char *p1 = &quot;abcdef&quot;; printf(&quot;p1 = %p\\n&quot;,p1); // p1 = 0x109002f82 printf(&quot;p1 = %p\\n&quot;,p1+1); // p1 = 0x109002f82 printf(&quot;p1 = %p\\n&quot;,p1+2); // p1 = 0x109002f82 printf(&quot;&amp;p1 = %p\\n&quot;,&amp;p1); // &amp;p1 = 0x7ffee6bfda48 char p2[] = &quot;123456&quot;; printf(&quot;p2 = %p\\n&quot;,p2); // p2 = 0x7ffee6bfda41 printf(&quot;&amp;p2 = %p\\n&quot;,p2+1); // &amp;p2 = 0x7ffee6bfda42 printf(&quot;&amp;p2 = %p\\n&quot;,p2+2); // &amp;p2 = 0x7ffee6bfda43 } ç»“è®ºï¼š æ•°ç»„åå³ä¸ºæ•°æ®æœ¬èº« æ•°ç»„ä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°æ—¶ï¼Œæ•°ç»„çš„åœ°å€èµ‹å€¼ç»™å½¢å‚ï¼Œå‘ç”Ÿé™ç»´ã€‚ aå’Œ&amp;açš„åŒºåˆ«(æ•°ç»„å) int main(){ int a[5] = {1,2,3,4,5}; int *ptr = (int *)(&amp;a+1); printf(&quot;*(a+1)=%d\\n*(ptr-1))=%d\\n&quot;,*(a+1),*(ptr-1)); // *(a+1)=2ï¼Œ*(ptr-1))=5 } ç»“è®ºï¼š &amp;aä»£è¡¨çš„æ˜¯æ•°ç»„åœ°å€ï¼Œ&amp;a+1ï¼ŒåŠ ä¸Šçš„æ˜¯sizeof(a)ï¼ŒæŒ‡å‘a[4]çš„ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚ aä»£è¡¨çš„æ˜¯é¦–å…ƒç´ åœ°å€ã€‚ å®šä¹‰ä¸ºæ•°ç»„ï¼Œå£°æ˜ä¸ºæŒ‡é’ˆ int arr[3] = {1,2,3}; int main(){ extern int *arr; } å°†arrå£°æ˜ä¸ºæŒ‡é’ˆä¼šé€ æˆè®¿é—®æ–¹å¼çš„é”™è¯¯ï¼Œå¾—å‡ºæ„å¤–çš„ç»“æœã€‚æœ¬åº”è¯¥æ˜¯ç›´æ¥è¯»å–åˆ°arrçš„å†…å­˜åœ°å€ç„¶åè¿›è¡Œåç§»æ“ä½œï¼Œä½†æ˜¯è¿™é‡Œå£°æ˜ä¸ºæŒ‡é’ˆï¼Œå¯¼è‡´äº†è®¿é—®æ–¹å¼çš„æ”¹å˜ï¼Œè®¿é—®æ—¶ä¼šå…ˆè¯»å–arræ‰€åœ¨å†…å­˜ç©ºé—´å­˜æ”¾çš„å†…å­˜åœ°å€ï¼Œç„¶åå†è¿›è¡Œåç§»æ“ä½œã€‚ å®šä¹‰ä¸ºæŒ‡é’ˆï¼Œå£°æ˜ä¸ºæ•°ç»„ char *p = &quot;abcd&quot;; int main(){ extern char p[]; } ä¹Ÿä¼šå› ä¸ºå®šä¹‰å’Œå£°æ˜çš„æ–¹å¼ä¸ä¸€æ ·é€ æˆè®¿é—®æ–¹å¼ä¸ä¸€æ ·ä»è€Œå¾—åˆ°æ„å¤–çš„ç»“æœã€‚ æŒ‡é’ˆå’Œæ•°ç»„å¯¹æ¯” æŒ‡é’ˆ æ•°ç»„ ä¿å­˜æ•°æ®çš„åœ°å€ï¼Œä»»ä½•è¢«å­˜å…¥æŒ‡é’ˆå˜é‡pçš„æ•°æ®éƒ½ä¼šè¢«å½“åšåœ°å€å¤„ç†ã€‚pæœ¬èº«çš„åœ°å€æœ‰ç¼–è¯‘å™¨å¦å¤–å­˜å‚¨ï¼Œå­˜å‚¨åœ¨å“ªé‡Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“ã€‚ ä¿å­˜æ•°æ®ï¼Œæ•°ç»„åaä»£è¡¨çš„æ˜¯æ•°ç»„é¦–å…ƒç´ çš„åœ°å€è€Œä¸æ˜¯æ•°ç»„çš„é¦–åœ°å€ï¼Œ&amp;aæ‰æ˜¯æ•´ä¸ªæ•°ç»„çš„é¦–åœ°å€ã€‚aæœ¬èº«çš„åœ°å€ç”±ç¼–è¯‘å™¨å¦å¤–å­˜å‚¨ï¼Œå­˜å‚¨åœ¨å“ªé‡Œï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“ã€‚ é—´æ¥è®¿é—®æ•°æ®ï¼Œé¦–å…ˆå–å¾—æŒ‡é’ˆå˜é‡pçš„å†…å®¹ï¼ŒæŠŠå®ƒå½“åšåœ°å€ï¼Œç„¶åä»è¿™ä¸ªåœ°å€æå–æˆ–è€…å†™å…¥æ•°æ®ã€‚æŒ‡é’ˆå¯ä»¥ä»¥æŒ‡é’ˆçš„å½¢å¼è®¿é—®*(p+i)ï¼›ä¹Ÿå¯ä»¥ä»¥ä¸‹æ ‡çš„æ–¹å¼è®¿é—®p[i]ã€‚ä½†æ˜¯å…¶æœ¬è´¨éƒ½æ˜¯å…ˆå–pçš„å†…å®¹ç„¶ååŠ ä¸Š i * sizeof(ç±»å‹)ä¸ªbyteä½œä¸ºæ•°æ®çš„çœŸæ­£åœ°å€ã€‚ ç›´æ¥è®¿é—®æ•°æ®ï¼Œæ•°ç»„åaæ˜¯æ•´ä¸ªæ•°ç»„çš„åå­—ï¼Œæ•°ç»„å†…æ¯ä¸ªå…ƒç´ å¹¶æ²¡æœ‰åå­—ã€‚åªèƒ½é€šè¿‡â€å…·å+åŒ¿åâ€çš„æ–¹å¼æ¥è®¿é—®å…¶å®ƒæŸä¸ªå…ƒç´ ï¼Œä¸èƒ½æŠŠæ•°ç»„å½“åšä¸€ä¸ªæ•´ä½“æ¥è¿›è¡Œè¯»å†™æ“ä½œã€‚æ•°ç»„å¯ä»¥ä»¥æŒ‡é’ˆçš„å½¢å¼è®¿é—®*(pa+i)ï¼›ä¹Ÿå¯ä»¥ä»¥ä¸‹æ ‡çš„æ–¹å¼è®¿é—®a[i]ã€‚ä½†å…¶æœ¬è´¨éƒ½æ˜¯aæ‰€ä»£è¡¨çš„æ•°ç»„çš„é¦–å…ƒç´ åœ°å€åŠ ä¸Š i * sizeof(ç±»å‹)ä¸ªbyteä½œä¸ºæ•°æ®çš„çœŸæ­£åœ°å€ã€‚ é€šå¸¸ç”¨äºåŠ¨æ€æ•°æ®ç»“æ„ é€šå¸¸ç”¨äºå­˜å‚¨å›ºå®šæ•°ç›®ä¸”æ•°æ®ç±»å‹ç›¸åŒçš„å…ƒç´  ç›¸å…³å‡½æ•°mallocå’Œfree éšå¼åˆ†é…å’Œåˆ é™¤ é€šå¸¸æŒ‡å‘åŒ¿åæ•°æ®ï¼ˆä¹Ÿå¯æŒ‡å‘å…·åæ•°æ®ï¼‰ è‡ªèº«å³ä¸ºæ•°ç»„å åœ°å€å¼ºåˆ¶è½¬æ¢ int main(){ int a[4] = {1,2,3,4}; int *ptr1 = (int *)(&amp;a+1); int *ptr2 = (int *)((int)a+1); printf(&quot;ptr1[-1] = %x\\n&quot;,ptr1[-1]); printf(&quot;*ptr2 = %x\\n&quot;,*ptr2); return 0; } 32ä½ç³»ç»Ÿä¸‹ï¼š 64ä½ç³»ç»Ÿä¸‹ä¼šæŠ¥é”™ï¼šSegmentation fault ä¸ªäººçœ‹æ³•ï¼šaä»£è¡¨çš„æ˜¯é¦–å…ƒç´ åœ°å€ï¼Œå°†å…¶å¼ºè½¬æˆintç„¶å+1å†å¼ºè½¬æˆintï¼Œå³å°†aåœ°å€è¿›è¡Œ+1æ“ä½œç„¶åèµ‹å€¼ç»™ptr2ã€‚åœ¨32ä½ä¸‹æŒ‡é’ˆçš„é•¿åº¦å’Œ int\\ ç±»å‹çš„é•¿åº¦ç›¸åŒï¼Œæ‰€ä»¥ä¸ä¼šå‘ç”Ÿæå‡ã€‚ä½†æ˜¯åœ¨64ä½ä¸‹ï¼Œå°†4ä½çš„int* æå‡ä¸º8ä½çš„åœ°å€ä¼šå‘ç”Ÿæå‡ï¼Œæå‡åçš„åœ°å€è¿œè¿œå¤§äºå½“å‰æ•°ç»„æ‰€æœ‰å…ƒç´ çš„åœ°å€ï¼Œæ‰€ä»¥åœ¨è¿›è¡Œprintfè®¿é—®æ‰“å°æ—¶ä¼šæŠ¥é”™ï¼šSegmentation faultã€‚ &amp;p[4][2] - &amp;a[4][2] ç­‰äºå¤šå°‘ï¼Ÿ int main(){ int a[5][5]; int(*p)[4]; p = a; printf(&quot;%p,%d\\n&quot;,&amp;p[4][2] - &amp;a[4][2],&amp;p[4][2] - &amp;a[4][2]); } æ— æ³•å‘ä¸€ä¸ªå‡½æ•°ä¼ é€’æ•°ç»„ Cè¯­è¨€ä¸­ï¼Œå½“ä¸€ç»´æ•°ç»„ä½œä¸ºå‡½æ•°å‚æ•°æ—¶ï¼Œç¼–è¯‘å™¨æ€»æŠŠå®ƒè§£ææˆä¸€ä¸ªæŒ‡å‘å…¶é¦–å…ƒç´ åœ°å€çš„æŒ‡é’ˆã€‚ å‡½æ•°æœ¬èº«æ²¡æœ‰ç±»å‹ï¼Œåªæœ‰å‡½æ•°çš„è¿”å›å€¼æ‰æœ‰ç±»å‹ã€‚ èƒ½å¦æŠŠæŒ‡é’ˆå˜é‡æœ¬èº«ä¼ é€’ç»™ä¸€ä¸ªå‡½æ•° mainå‡½æ•°ä¸­çš„å˜é‡ä¸æ˜¯å…¨å±€å˜é‡ï¼Œåªä¸è¿‡æ˜¯å®ƒçš„å£°æ˜å‘¨æœŸå’Œå…¨åŒºå˜é‡ä¸€æ ·é•¿è€Œå·²ã€‚å…¨å±€å˜é‡å®šä¹‰åœ¨å‡½æ•°å¤–éƒ¨ã€‚ å‡½æ•°æŒ‡é’ˆçš„å®šä¹‰ char* (*func1)(char* p1, char* p2); func1æ˜¯ä¸€ä¸ªæŒ‡é’ˆå˜é‡ï¼ŒæŒ‡å‘ä¸€ä¸ªæœ‰ä¸¤ä¸ªchar*ç±»å‹å‚æ•°ä¸”è¿”å›å€¼æ˜¯char*ç±»å‹çš„å‡½æ•° *(int*)&amp;p // 32ä½ void Function(){ printf(&quot;Call Function.\\n&quot;); } int main(){ void (*p)(); *(int*)&amp;p = (int)Function; (*p)(); return 0; } pæ˜¯ä¸€ä¸ªæŒ‡é’ˆå˜é‡ï¼ŒæŒ‡å‘ä¸€ä¸ªæ— å‚æ•°æ— è¿”å›å€¼çš„å‡½æ•°ï¼› (int*)&amp;på°†pçš„åœ°å€å¼ºè½¬æˆintæ•°æ®ç±»å‹çš„æŒ‡é’ˆï¼› *(int*)&amp;p å°±æ˜¯ä¸€ä¸ªæ•´å‹ï¼Œè¦å°†å‡½æ•°Functionçš„åœ°å€èµ‹å€¼ç»™på¾—å…ˆå°†å…¶è½¬ä¸ºæ•´å‹ã€‚ (*(void(*)())0)(); void(*)()ï¼šè¡¨ç¤ºä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€ä¸ªè¿”å›å€¼æ—¶voidä¸”æ²¡æœ‰å‚æ•°çš„å‡½æ•°ã€‚ (void(*)())0ï¼šè¡¨ç¤ºå°†0å¼ºåˆ¶è½¬æ¢æˆvoid(*)()è¿™ä¸ªå‡½æ•°æŒ‡é’ˆç±»å‹ã€‚ (*(void(*)())0)ï¼šè·å–åœ°å€0å¼€å§‹çš„å†…å­˜ä¸­çš„ä¸€æ®µå†…å®¹(è§£å¼•ç”¨)ã€‚ (*(void(*)())0)()ï¼šå‡½æ•°è°ƒç”¨ã€‚ å‡½æ•°æŒ‡é’ˆæ•°ç»„ char* (*pf1)(char *p); // pf1æ˜¯ä¸€ä¸ªæŒ‡å‘å‚æ•°æ˜¯char *ç±»å‹ï¼Œè¿”å›å€¼æ—¶char*çš„å‡½æ•°çš„æŒ‡é’ˆ char* (*pf2[3])(char *p); // pf2æ˜¯å‡½æ•°æŒ‡é’ˆæ•°ç»„ #include &lt;stdio.h&gt; #include &lt;string.h&gt; char * func1(char *p){ printf(&quot;%s\\n&quot;,p); return p; } char * func2(char *p){ printf(&quot;%s\\n&quot;,p); return p; } char * func3(char *p){ printf(&quot;%s\\n&quot;,p); return p; } int main(){ char *(*pf[3])(char *); pf[0]=func1; pf[1]=func2; pf[2]=func3; pf[0](&quot;func1&quot;); pf[1](&quot;func2&quot;); pf[2](&quot;func3&quot;); return 0; } å‡½æ•°æŒ‡é’ˆæ•°ç»„çš„æŒ‡é’ˆ char* (*pf2[3])(char *p); // pf2æ˜¯å‡½æ•°æŒ‡é’ˆæ•°ç»„ char* (*(*pf2)[3])(char *p); // pf2æ˜¯å‡½æ•°æŒ‡é’ˆæ•°ç»„æŒ‡é’ˆ å¸¸è§å†…å­˜é”™è¯¯ä»¥åŠå¯¹ç­– æŒ‡é’ˆæ²¡æœ‰æŒ‡å‘ä¸€å—åˆæ³•çš„å†…å­˜ ç»“æ„ä½“æˆå‘˜æŒ‡é’ˆæœªåˆå§‹åŒ– struct student{ char *name; int score; }stu,*pstu; int main(){ strcpy(stu.name,&quot;jim&quot;); stu.score=99; return 0; } åœ¨å®ä¾‹åŒ–stuæ—¶ï¼Œç»™nameåˆ†é…äº†å››å­—èŠ‚çš„å†…å­˜ï¼Œä½†å¹¶æ²¡æœ‰æŒ‡å‘åˆæ³•çš„åœ°å€ã€‚è°ƒç”¨strcpyå¾€æ‰€æŒ‡å‘çš„å†…å­˜æ‹·è´â€jimâ€ï¼Œè¿™å—å†…å­˜nameæŒ‡é’ˆæ ¹æœ¬å°±æ— æƒè®¿é—®ï¼Œå¯¼è‡´å‡ºé”™ã€‚ #include &lt;stdlib.h&gt; #include &lt;stdio.h&gt; struct student{ char *name; int score; }stu,*pstu; int main(){ stu.name = (char*)malloc(sizeof(char)); strcpy(stu.name,&quot;jim&quot;); stu.score=99; printf(&quot;%s\\n&quot;,stu.name); free(pstu); return 0; } æ²¡æœ‰ä¸ºç»“æ„ä½“æŒ‡é’ˆåˆ†é…è¶³å¤Ÿçš„å†…å­˜ å‡½æ•°å…¥å£æ ¡éªŒ assert(NULL!=p); // æ˜¯ä¸€ä¸ªå®è€Œéå‡½æ•° ä¸ºæŒ‡é’ˆåˆ†é…çš„å†…å­˜å¤ªå° å†…å­˜åˆ†é…æˆåŠŸï¼Œä½†æœªåˆå§‹åŒ– int i = 10; char *p = (char *)malloc(sizeof(char)); //åœ¨ä¸ç¡®å®šå˜é‡åˆå§‹å€¼çš„æ—¶å€™å¯ä»¥åˆå§‹åŒ–ä¸º0æˆ–è€…NULL int i = 0; char *p = NULL; //æˆ–è€…ä½¿ç”¨memset(èµ·å§‹åœ°å€,è¦è¢«è®¾ç½®çš„å€¼,è¦è¢«è®¾ç½®çš„å†…å­˜å¤§å°); int a[10]; memset(a,0,sizeof(a));","categories":[{"name":"Cè¯­è¨€","slug":"Cè¯­è¨€","permalink":"http://blog.3amupupup.online/categories/C%E8%AF%AD%E8%A8%80/"}],"tags":[{"name":"book","slug":"book","permalink":"http://blog.3amupupup.online/tags/book/"}]},{"title":"mongo","slug":"mongo","date":"2021-03-18T03:09:52.068Z","updated":"2021-03-18T03:09:52.069Z","comments":true,"path":"2021/03/18/mongo/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/mongo/","excerpt":"","text":"å¸¸ç”¨å‘½ä»¤mongoå¤‡ä»½: mongoexportå¯¼å‡ºjsonæ–‡ä»¶./mongoexport --host 0.0.0.0:65535 -u username -p password --authenticationDatabase admin -d database -c collection -o file.json mongoæ¢å¤: mongoimportå¯¼å…¥jsonæ–‡ä»¶./mongoimport --host 0.0.0.0:65535 -u username -p password --authenticationDatabase admin -d database -c collection --file file.json åˆ›å»ºé›†åˆ:db.createCollection() æŸ¥çœ‹åº“ä¿¡æ¯:db.stats(); æŸ¥çœ‹é›†åˆä¿¡æ¯:db.collection.stats() mongoé‡è§çš„ä¸€äº›é—®é¢˜åˆ é™¤æ•°æ®ï¼Œç£ç›˜ç©ºé—´ä¸é‡Šæ”¾:db.collection.remove({}, {multi: true})å‘½ä»¤åˆ é™¤æ–‡æ¡£ï¼Œåˆ é™¤ä¹‹åä¸ä¼šå°†è¢«åˆ é™¤æ•°æ®çš„ç£ç›˜ç©ºé—´å½’è¿˜ç»™æ“ä½œç³»ç»Ÿï¼Œä½†æ˜¯å½“æœ‰æ–°æ•°æ®æ’å…¥æ—¶mongoèƒ½é‡æ–°ä½¿ç”¨è¿™å—ç©ºé—´ã€‚(è§£å†³åŠæ³•)","categories":[{"name":"è¿ç»´","slug":"è¿ç»´","permalink":"http://blog.3amupupup.online/categories/%E8%BF%90%E7%BB%B4/"}],"tags":[{"name":"mongodb","slug":"mongodb","permalink":"http://blog.3amupupup.online/tags/mongodb/"}]},{"title":"CppPrimer","slug":"CppPrimer","date":"2021-03-18T03:09:52.068Z","updated":"2021-03-18T03:09:52.068Z","comments":true,"path":"2021/03/18/CppPrimer/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/CppPrimer/","excerpt":"","text":"ç¬¬ä¸ƒç«  ç±»ç±»ä½œç”¨åŸŸå’Œæˆå‘˜å‡½æ•°ï¼š ç¼–è¯‘å™¨åˆ†ä¸¤æ­¥å¤„ç†ç±»ï¼šé¦–å…ˆç¼–è¯‘æˆå‘˜çš„å£°æ˜ï¼Œç„¶åæ‰è½®åˆ°æˆå‘˜å‡½æ•°ä½“(å¦‚æœæœ‰çš„è¯)ã€‚å› æ­¤ï¼Œæˆå‘˜å‡½æ•°ä½“å¯ä»¥éšæ„ä½¿ç”¨ç±»ä¸­çš„å…¶å®ƒæˆå‘˜è€Œæ— éœ€åœ¨æ„è¿™äº›æˆå‘˜å‡ºç°çš„æ¬¡åºã€‚ IOç±»å±äºä¸èƒ½è¢«æ‹·è´çš„ç±»å‹ï¼Œå› æ­¤åªèƒ½é€šè¿‡å¼•ç”¨ä¼ é€’ã€‚ æ¯ä¸ªç±»éƒ½åˆ†åˆ«å®šä¹‰äº†å®ƒçš„å¯¹è±¡è¢«åˆå§‹åŒ–çš„æ–¹å¼ï¼Œç±»é€šè¿‡ä¸€ä¸ªæˆ–è€…å‡ ä¸ªç‰¹æ®Šçš„æˆå‘˜å‡½æ•°æ¥æ§åˆ¶å…¶å¯¹è±¡çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼Œè¢«ç§°ä¸ºæ„é€ å‡½æ•°ã€‚æ„é€ å‡½æ•°çš„ä»»åŠ¡æ˜¯åˆå§‹åŒ–ç±»å¯¹è±¡çš„æ•°æ®æˆå‘˜ï¼Œæ— è®ºä½•æ—¶åªè¦ç±»çš„å¯¹è±¡è¢«åˆ›å»ºï¼Œå°±ä¼šæ‰§è¡Œæ„é€ å‡½æ•°ã€‚ æ„é€ å‡½æ•°ä¸èƒ½è¢«å£°æ˜æˆconstï¼Œå½“åˆ›å»ºä¸€ä¸ªconstå¯¹è±¡æ—¶ï¼Œç›´åˆ°æ„é€ å‡½æ•°å®Œæˆåˆå§‹åŒ–è¿‡ç¨‹ï¼Œå¯¹è±¡æ‰èƒ½çœŸæ­£å–å¾—å…¶â€œå¸¸é‡â€å±æ€§ã€‚å› æ­¤ï¼Œæ„é€ å‡½æ•°åœ¨constå¯¹è±¡çš„æ„é€ è¿‡ç¨‹ä¸­å¯ä»¥å‘å…¶å†™å€¼ã€‚ å¦‚æœç±»æ²¡æœ‰æ˜¾ç¤ºçš„å®šä¹‰æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å°±ä¼šä¸ºæˆ‘ä»¬éšå¼çš„å®šä¹‰ä¸€ä¸ªé»˜è®¤æ„é€ å‡½æ•°ã€‚ æŸäº›ç±»ä¸èƒ½ä¾èµ–äºåˆæˆçš„é»˜è®¤æ„é€ å‡½æ•°ï¼š åªæœ‰å½“ç±»æ²¡æœ‰å£°æ˜ä»»ä½•æ„é€ å‡½æ•°æ—¶ï¼Œç¼–è¯‘å™¨æ‰ä¼šè‡ªåŠ¨çš„ç”Ÿæˆé»˜è®¤æ„é€ å‡½æ•°ã€‚ åˆæˆçš„é»˜è®¤æ„é€ å‡½æ•°æœ‰å¯èƒ½æ‰§è¡Œé”™è¯¯çš„æ“ä½œã€‚å¦‚æœå®šä¹‰åœ¨å—ä¸­çš„å†…ç½®ç±»å‹æˆ–ç¬¦åˆç±»å‹(æ¯”å¦‚æ•°ç»„å’ŒæŒ‡é’ˆ)çš„å¯¹è±¡è¢«é»˜è®¤åˆå§‹åŒ–ï¼Œåˆ™ä»–ä»¬çš„å€¼å°†æ˜¯æœªå®šä¹‰çš„ã€‚è¯¥å‡†åˆ™åŒæ ·é€‚ç”¨äºé»˜è®¤åˆå§‹åŒ–çš„å†…ç½®ç±»å‹æˆå‘˜ã€‚å› æ­¤ï¼Œå‡½æ•°å†…ç½®ç±»å‹æˆ–è€…å¤åˆç±»å‹æˆå‘˜çš„ç±»åº”è¯¥åœ¨ç±»çš„å†…éƒ¨åˆå§‹åŒ–è¿™äº›æˆå‘˜ï¼Œæˆ–è€…å®šä¹‰ä¸€ä¸ªè‡ªå·±çš„é»˜è®¤æ„é€ å‡½æ•°ã€‚å¦åˆ™ï¼Œç”¨æˆ·åœ¨åˆ›å»ºç±»å¯¹è±¡æ—¶å°±å¯èƒ½å¾—åˆ°æœªå®šä¹‰çš„å€¼ã€‚ ç¼–è¯‘å™¨ä¸èƒ½ä¸ºæŸäº›ç±»åˆæˆé»˜è®¤çš„æ„é€ å‡½æ•°ã€‚ä¾‹å¦‚ï¼šä¸€ä¸ªç±»ä¸­åŒ…å«å¦ä¸€ä¸ªç±»ç±»å‹çš„æˆå‘˜ä¸”è¿™ä¸ªæˆå‘˜æ²¡æœ‰é»˜è®¤æ„é€ å‡½æ•°ã€‚","categories":[],"tags":[]},{"title":"tcp:ip","slug":"tcp:ip","date":"2021-03-18T03:09:52.067Z","updated":"2021-03-18T03:09:52.067Z","comments":true,"path":"2021/03/18/tcp:ip/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/tcp:ip/","excerpt":"","text":"ç¬¬ä¸€ç« 1.2 åˆ†å±‚tcp/ipé€šå¸¸è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªå››å±‚åè®®ç³»ç»Ÿï¼š é“¾è·¯å±‚ ä¹Ÿç§°ä½œæ•°æ®é“¾è·¯å±‚æˆ–ç½‘ç»œæ¥å£å±‚ã€‚é€šå¸¸åŒ…æ‹¬æ“ä½œç³»ç»Ÿä¸­çš„è®¾å¤‡é©±åŠ¨ç¨‹åºå’Œè®¡ç®—æœºä¸­å¯¹åº”çš„ç½‘ç»œæ¥å£å¡ã€‚å®ƒä»¬ä¸€èµ·å¤„ç†ä¸ç”µç¼†ï¼ˆæˆ–è€…ä»»ä½•ä¼ è¾“ä»‹è´¨ï¼‰çš„ç‰©ç†æ¥å£ç»†èŠ‚ã€‚ ç½‘ç»œå±‚ ä¹Ÿç§°ä¸ºäº’è”ç½‘å±‚ï¼Œå¤„ç†åˆ†ç»„åœ¨ç½‘ç»œä¸­çš„æ´»åŠ¨ã€‚ç½‘ç»œå±‚IPæä¾›ä¸€ç§ä¸å¯é çš„æœåŠ¡ï¼Œå®ƒåªæ˜¯å°½å¯èƒ½çš„å¿«åœ°æŠŠæ•°æ®åŒ…ä»æºç»“ç‚¹é€åˆ°ç›®çš„ç»“ç‚¹ï¼Œä½†æ˜¯å¹¶ä¸æä¾›ä»»ä½•å¯é æ€§ä¿è¯ã€‚TCPåœ¨ä¸å¯é çš„IPå±‚ä¸Šæä¾›äº†ä¸€ä¸ªå¯é çš„è¿è¾“å±‚ï¼ˆTCPé‡‡ç”¨è¶…æ—¶é‡ä¼ ã€å‘é€å’Œæ¥æ”¶ç«¯çš„ç¡®è®¤åˆ†ç»„ç­‰æœºåˆ¶ï¼‰ã€‚ICMPæ˜¯IPåè®®çš„é™„å±åè®®ï¼ŒIPå±‚ç”¨å®ƒæ¥ä¸å…¶å®ƒä¸»æœºæˆ–è·¯ç”±å™¨äº¤æ¢é”™è¯¯æŠ¥æ–‡å’Œå…¶å®ƒé‡è¦ä¿¡æ¯ã€‚ è¿è¾“å±‚ ä¸ºä¸¤å°ä¸»æœºä¸Šçš„åº”ç”¨æä¾›ç«¯åˆ°ç«¯çš„é€šä¿¡ã€‚TCP/IPåè®®æ—ä¸­æœ‰ä¸¤ä¸ªäº’ä¸ç›¸åŒçš„ä¼ è¾“åè®®ï¼štcpï¼ˆä¼ è¾“æ§åˆ¶åè®®ï¼‰å’Œudpï¼ˆç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼‰ã€‚è™½ç„¶TCPä½¿ç”¨ä¸å¯é çš„IPæœåŠ¡ï¼Œä½†æ˜¯å®ƒç¼ºæä¾›ä¸€ç§å¯é çš„è¿è¾“å±‚æœåŠ¡ã€‚UDPæ˜¯ä¸å¯é çš„ï¼Œå®ƒä¸èƒ½ä¿è¯æ•°æ®å®‰å…¨æ— è¯¯çš„åˆ°è¾¾æœ€ç»ˆç›®çš„åœ°ã€‚ åº”ç”¨å±‚ è´Ÿè´£å¤„ç†ç‰¹å®šçš„åº”ç”¨ç¨‹åºç»†èŠ‚ã€‚ 1.4 äº’è”ç½‘çš„åœ°å€Aã€Bã€Cç±»ä¸ºå•†ç”¨ 1.6 å°è£… 1.7 åˆ†ç”¨ 1.9 ç«¯å£å·TCPå’ŒUDPé‡‡ç”¨16bitä½çš„ç«¯å£å·æ¥è¯†åˆ«åº”ç”¨ç¨‹åºã€‚ å®¢æˆ·ç«¯é€šå¸¸å¯¹å®ƒä½¿ç”¨çš„ç«¯å£å·å¹¶ä¸å…³å¿ƒï¼Œåªéœ€è¦ä¿è¯ä½¿ç”¨çš„ç«¯å£å·åœ¨æœ¬æœºæ˜¯å”¯ä¸€å°±è¡Œäº†ã€‚å®¢æˆ·ç«¯ç«¯å£å·åˆç§°ä¸´æ—¶ç«¯å£å·ã€‚ ç¬¬äºŒç«  é“¾è·¯å±‚é“¾è·¯å±‚ä¸»è¦æœ‰ä¸‰ä¸ªç›®çš„ï¼š ä¸ºIPæ¨¡å—æ¥å—å’Œå‘é€æ•°æ®æŠ¥ ä¸ºARPæ¨¡å—å‘é€ARPè¯·æ±‚å’Œæ¥å—ARPåº”ç­” ä¸ºRARPå‘é€RARPè¯·æ±‚å’Œæ¥å—RARPåº”ç­” 2.7 ç¯å›æ¥å£ä½¿è¿è¡Œåœ¨åŒä¸€å°ä¸»æœºä¸Šçš„å®¢æˆ·ç«¯ç¨‹åºå’ŒæœåŠ¡ç«¯ç¨‹åºèƒ½æŠ•é€šè¿‡TCP/IPè¿›è¡Œé€šä¿¡ã€‚ä¸€ä¸ªä¼ ç»™ç¯å›æ¥å£çš„IPæ•°æ®æŠ¥ä¸èƒ½åœ¨ä»»ä½•ç½‘ç»œä¸Šå‡ºç°ã€‚ ç¬¬ä¸‰ç«  IP3.2 IPé¦–éƒ¨ç‰ˆæœ¬å·å­—æ®µï¼šåè®®ç‰ˆæœ¬å·ï¼Œå½“å‰æ˜¯ipv4ã€‚ é¦–éƒ¨é•¿åº¦å­—æ®µï¼š4ä¸ªæ¯”ç‰¹ä½ï¼Œèƒ½è¡¨ç¤ºèŒƒå›´æ˜¯0~15ï¼Œæ¯ä¸ªé•¿åº¦å•ä½ä¸º4å­—èŠ‚ï¼Œæ‰€ä»¥é¦–éƒ¨çš„æœ€å¤§é•¿åº¦ä¸º60å­—èŠ‚ã€‚ TOS: æ€»é•¿åº¦å­—æ®µï¼šæ•´ä¸ªipæ•°æ®æŠ¥çš„é•¿åº¦ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œè¯¥å­—æ®µé•¿ä¸º16ä¸ªæ¯”ç‰¹ï¼Œç”±æ­¤å¯çŸ¥è¯¥å­—æ®µè¡¨ç¤ºçš„æ•°å€¼èŒƒå›´æ˜¯0~65535ï¼Œä¹Ÿè¯´æ˜ä¸€ä¸ªipæŠ¥æ–‡çš„æœ€å¤§é•¿åº¦æ˜¯65535å­—èŠ‚ï¼‰ã€‚åˆ©ç”¨é¦–éƒ¨é•¿åº¦å­—æ®µå’Œæ€»é•¿åº¦å­—æ®µå°±å¯ä»¥çŸ¥é“ipæ•°æ®æŠ¥ä¸­æ•°æ®å†…å®¹çš„èµ·å§‹ä½ç½®å’Œé•¿åº¦ï¼ˆé¦–éƒ¨é•¿åº¦+1 ï¼Œ æ€»é•¿åº¦-é¦–éƒ¨é•¿åº¦ï¼‰ã€‚ æ ‡è¯†å­—æ®µï¼š æ ‡å¿—å­—æ®µï¼šå”¯ä¸€æ ‡è¯†ä¸»æœºå‘é€çš„æ¯ä¸€ä»½æ•°æ®æŠ¥ï¼Œé€šå¸¸æ¯å‘é€ä¸€æ¬¡æŠ¥æ–‡å®ƒçš„å€¼å°±ä¼šå¢åŠ 1ã€‚ ç‰‡åç§»å­—æ®µï¼š TTLç”Ÿå­˜æ—¶é—´å­—æ®µï¼šè¡¨ç¤ºæ•°æ®æŠ¥å¯ä»¥ç»è¿‡çš„æœ€å¤šè·¯ç”±å™¨æ•°ã€‚TTLé€šå¸¸ç”±æºä¸»æœºè®¾ç½®ï¼ˆ32æˆ–64ï¼‰ï¼Œç»è¿‡ä¸€ä¸ªå¤„ç†å®ƒçš„è·¯ç”±å™¨ï¼Œttlçš„å€¼å°±å‡å»1ï¼Œå½“è¯¥å­—æ®µä¸º0æ—¶ï¼Œæ•°æ®æŠ¥è¢«ä¸¢å¼ƒï¼Œå¹¶å‘é€ICMPæŠ¥æ–‡é€šçŸ¥æºä¸»æœºã€‚ åè®®å­—æ®µï¼š é¦–éƒ¨æ ¡éªŒå’Œå­—æ®µï¼šæ ¹æ®ipé¦–éƒ¨è®¡ç®—çš„æ ¡éªŒå’Œç ï¼ˆä¸å¯¹é¦–éƒ¨åé¢çš„æ•°æ®è¿›è¡Œè®¡ç®—ï¼‰ é€‰é¡¹å­—æ®µï¼šä»¥32bitä½œä¸ºç•Œé™ï¼Œæœ‰å¿…è¦çš„æ—¶å€™æ’å…¥0ä½œä¸ºå¡«å……å­—èŠ‚ï¼Œä»¥ä¿è¯IPé¦–éƒ¨å§‹ç»ˆæ˜¯32bitçš„æ•´æ•°å€ 3.3 è·¯ç”±é€‰æ‹©IPè·¯ç”±é€‰æ‹©æ˜¯ç®€å•çš„ï¼Œç‰¹åˆ«å¯¹äºä¸»æœºæ¥è¯´ï¼Œå¦‚æœç›®çš„ä¸»æœºä¸æºä¸»æœºç›´æ¥ç›¸è¿æˆ–è€…éƒ½åœ¨ä¸€ä¸ªå…±äº«ç½‘ç»œä¸Šï¼ˆä»¥å¤ªç½‘æˆ–è€…ä»¤ç‰Œç¯ç½‘ï¼‰ï¼Œé‚£ä¹ˆIPæ•°æ®å°±ç›´æ¥å‘é€åˆ°ç›®çš„ä¸»æœºä¸Šã€‚å¦åˆ™ï¼Œä¸»æœºæŠŠæ•°æ®æŠ¥å‘å¾€é»˜è®¤çš„è·¯ç”±å™¨ä¸Šï¼Œç”±è·¯ç”±å™¨è½¬å‘è¯¥æ•°æ®æŠ¥ã€‚ IPå±‚åœ¨å†…å­˜ä¸­å­˜åœ¨è·¯ç”±è¡¨ã€‚å½“æ”¶åˆ°ä¸€ä»½æ•°æ®æŠ¥å¹¶è¿›è¡Œè½¬å‘æ—¶ï¼Œéƒ½è¦å¯¹è¯¥è¡¨è¿›è¡Œæœç´¢ã€‚å½“æ•°æ®æŠ¥æ¥è‡ªæŸä¸ªç½‘ç»œæ¥å£æ—¶ï¼ŒIPé¦–å…ˆæ£€æŸ¥ç›®çš„IPåœ°å€æ˜¯å¦ä¸ºæœ¬æœºçš„IPåœ°å€ä¹‹ä¸€æˆ–è€…IPå¹¿æ’­åœ°å€ã€‚å¦‚æœæ˜¯ï¼Œæ•°æ®æŠ¥å°±ä¼šè¢«é€åˆ°ç”±IPé¦–éƒ¨åè®®å­—æ®µæ‰€æŒ‡å®šçš„åè®®æ¨¡å—è¿›è¡Œå¤„ç†ã€‚å¦‚æœä¸æ˜¯ä¸”IPå±‚è¢«è®¾ç½®ä¸ºè·¯ç”±å™¨çš„åŠŸèƒ½é‚£ä¹ˆå°±å¯¹æ•°æ®æŠ¥è¿›è¡Œè½¬å‘ï¼Œå¦åˆ™æ•°æ®æŠ¥è¢«ä¸¢å¼ƒã€‚ è·¯ç”±è¡¨ ç›®çš„IPåœ°å€(Destination) å¯ä»¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä¸»æœºåœ°å€ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªç½‘ç»œåœ°å€ã€‚å›¾ä¸­ç¬¬ä¸€æ¡æ˜¯é»˜è®¤è§„åˆ™(0.0.0.0)ï¼Œä»…å½“åªæœ‰ä¸€æ¡å¯ç”¨è·¯å¾„æ—¶æ‰åŒ¹é…ã€‚ ä¸‹ä¸€ç«™ï¼ˆä¸‹ä¸€è·³ï¼‰è·¯ç”±å™¨çš„IPåœ°å€ï¼Œä¸‹ä¸€ç«™è·¯ç”±å™¨æ˜¯æŒ‡ä¸€ä¸ªç›´æ¥ç›¸è¿çš„ç½‘ç»œä¸Šçš„è·¯ç”±å™¨ï¼Œé€šè¿‡å®ƒå¯ä»¥è½¬å‘æ•°æ®æŠ¥ã€‚ æ ‡å¿— ä¸ºæ•°æ®æŠ¥çš„ä¼ è¾“æŒ‡å®šä¸€ä¸ªç½‘ç»œæ¥å£ã€‚ IPè·¯ç”±é€‰æ‹©åŠŸèƒ½ æœç´¢è·¯ç”±è¡¨ï¼Œå¯»æ‰¾ä¸ç›®çš„IPåœ°å€å®Œå…¨åŒ¹é…çš„è¡¨ç›®ï¼ˆç½‘ç»œå·å’Œä¸»æœºå·éƒ½è¦åŒ¹é…ï¼‰ã€‚ æœç´¢è·¯ç”±è¡¨ï¼Œå¯»æ‰¾èƒ½ä¸ç›®çš„ç½‘ç»œå·åŒ¹é…çš„è¡¨ç›®ã€‚å¦‚æœæ‰¾åˆ°åˆ™æŠŠæŠ¥æ–‡å‘é€ç»™è¯¥è¡¨ç›®æŒ‡å®šçš„ä¸‹ä¸€è·³è·¯ç”±å™¨æˆ–è€…ç›´æ¥è¿æ¥çš„ç½‘ç»œæ¥å£ã€‚ æœç´¢è·¯ç”±è¡¨ï¼Œå¯»æ‰¾æ ‡å¿—ä¸ºâ€œé»˜è®¤ï¼ˆdefaultï¼‰â€çš„è¡¨ç›®ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œåˆ™æŠŠæŠ¥æ–‡å‘é€ç»™æ”¹è¡¨ç›®æŒ‡å®šçš„ä¸‹ä¸€è·³è·¯ç”±å™¨ã€‚ å®Œæ•´çš„ä¸»æœºåœ°å€åŒ¹é…åœ¨ç½‘ç»œå·åŒ¹é…ä¹‹å‰æ‰§è¡Œã€‚åªæœ‰å½“ä»–ä»¬éƒ½å¤±è´¥åæ‰ä¼šé€‰æ‹©é»˜è®¤è·¯ç”±ã€‚ ä¸ºç½‘ç»œæŒ‡å®šä¸€ä¸ªè·¯ç”±å™¨ï¼Œè€Œä¸å¿…ä¸ºæ¯ä¸€ä¸ªä¸»æœºéƒ½æŒ‡å®šä¸€ä¸ªè·¯ç”±å™¨ï¼Œå¯ä»¥æå¤§ç¼©å°è·¯ç”±è¡¨çš„è§„æ¨¡ã€‚ 3.4 å­ç½‘å¯»å€ æ‰€æœ‰ä¸»æœºéƒ½è¦æ±‚æ”¯æŒå­ç½‘ç¼–å€ã€‚ä¸å†æ˜¯æŠŠIPåœ°å€çœ‹æˆå•çº¯çš„ä¸€ä¸ªç½‘ç»œå·å’Œä¸€ä¸ªä¸»æœºå·ç»„æˆï¼Œè€Œæ˜¯æŠŠä¸»æœºå·å†åˆ†æˆä¸€ä¸ªå­ç½‘å·å’Œä¸€ä¸ªä¸»æœºå·ã€‚åŸå› ï¼šAç±»å’ŒBç±»åœ°å€ä¸ºä¸»æœºå·åˆ†é…äº†å¤ªå¤šç©ºé—´ï¼ŒAç±»ï¼š224-2ï¼ˆ24ä½ä¸»æœºå·:224ï¼Œå…¨0å’Œå…¨1æ˜¯æ— æ•ˆçš„ï¼Œæ‰€ä»¥å‡å»2ï¼‰ï¼ŒBç±»ï¼š216-2ï¼Œäº‹å®ä¸Šä¸€ä¸ªç½‘ç»œå®‰æ’ä¸äº†è¿™ä¹ˆå¤šä¸»æœºã€‚ ä¾‹å¦‚ä¸Šå›¾ä¸­çš„Bç±»åœ°å€ï¼šå¯ä»¥å°†ä¸»æœºå·åˆ’åˆ†ä¸º8bitçš„å­ç½‘å·ï¼Œ8bitçš„ä¸»æœºå·ã€‚ä¹Ÿå°±æ˜¯è¯´å°†ç½‘ç»œå·æ˜¯140.252çš„IPåœ°å€åˆ’åˆ†ä¸º254ä¸ªå­ç½‘ï¼Œæ¯ä¸ªå­ç½‘å¯ä»¥æœ‰254å°ä¸»æœºã€‚ 3.5 å­ç½‘æ©ç å­ç½‘æ©ç ç”¨äºç¡®å®šIPåœ°å€ä¸­å¤šå°‘æ¯”ç‰¹ä½ç”¨äºå­ç½‘å·å¤šå°‘æ¯”ç‰¹ä½ç”¨äºä¸»æœºå·ã€‚ æ©ç æ˜¯ä¸€ä¸ª32bitçš„å€¼ï¼Œå…¶ä¸­å€¼ä¸º1çš„ç•™ç»™ç½‘ç»œå·å’Œå­ç½‘å·ï¼Œä¸º0çš„æ¯”ç‰¹ç•™ç»™ä¸»æœºå·ã€‚ 10101100 00010000 00000000 00000000 IPç½‘æ®µ: 172.16.0.0 11111111 11111111 00000000 00000000 æ©ç : 16 10101100 00010000 00000000 00000000 IPç½‘æ®µ: 172.16.16.0 11111111 11111111 11110000 00000000 æ©ç : 20 ç»™å®šIPåœ°å€å’Œå­ç½‘æ©ç ä¹‹åï¼Œä¸»æœºå°±å¯ä»¥ç¡®å®šIPæ•°æ®æŠ¥çš„ç›®çš„åœ°æ˜¯ï¼š æœ¬å­ç½‘ä¸Šçš„ä¸»æœº æœ¬ç½‘ç»œä¸­å…¶å®ƒå­ç½‘ä¸Šçš„ä¸»æœº å…¶å®ƒç½‘ç»œä¸Šçš„ä¸»æœº ç¬¬å…­ç«  ICMPICMPæŠ¥æ–‡æ˜¯åœ¨IPæ•°æ®æŠ¥å†…éƒ¨è¢«ä¼ è¾“çš„ã€‚ ç±»å‹å­—æ®µæœ‰15ä¸ªä¸åŒçš„å€¼ï¼Œä»¥æè¿°ç‰¹å®šç±»å‹çš„ICMPæŠ¥æ–‡ã€‚æŸäº›ICMPæŠ¥æ–‡è¿˜ä½¿ç”¨ä»£ç å­—æ®µçš„å€¼æ¥è¿›ä¸€æ­¥æè¿°ä¸åŒçš„æ¡ä»¶ã€‚ æ£€éªŒå’Œå­—æ®µè¦†ç›–æ•´ä¸ªICMPæŠ¥æ–‡ã€‚ICMPçš„æ ¡éªŒå’Œæ—¶å¿…é¡»çš„ã€‚ ç¬¬å…«ç«  TracerouteTTLå­—æ®µçš„ç›®çš„æ˜¯é˜²æ­¢æ•°æ®æŠ¥åœ¨é€‰è·¯æ—¶æ— ä¼‘æ­¢çš„åœ¨ç½‘ç»œä¸­æµåŠ¨ã€‚ å½“è·¯ç”±å™¨æ”¶åˆ°ä¸€ä»½IPæ•°æ®æŠ¥æ—¶ï¼Œå¦‚æœå…¶ttlå­—æ®µæ—¶0æˆ–è€…1ï¼Œåˆ™è·¯ç”±å™¨ä¸è½¬å‘è¯¥æ•°æ®æŠ¥ï¼Œè·¯ç”±å™¨ä¼šå°†è¯¥æ•°æ®æŠ¥ä¸¢å¼ƒå¹¶ç»™ä¿¡æºæœºå‘é€ä¸€ä»½ICMPè¶…æ—¶ä¿¡æ¯ï¼ŒTracerouteç¨‹åºçš„å…³é”®åœ¨äºåŒ…å«è¿™ä»½icmpä¿¡æ¯çš„ipæŠ¥æ–‡çš„ä¿¡æºåœ°å€æ˜¯è¯¥è·¯ç”±å™¨çš„åœ°å€ã€‚ Tracerouteå·¥ä½œåŸç†ï¼šå‘é€ä¸€ä¸ªttlä¸º1çš„ipæ•°æ®æŠ¥ç»™ç›®çš„ä¸»æœºï¼Œè¿™æ ·å°±å¾—åˆ°äº†ç¬¬ä¸€ä¸ªè·¯ç”±å™¨çš„ipåœ°å€ï¼›ç´§æ¥ç€å‘é€ä¸€ä¸ªttlä¸º2çš„æ•°æ®åŒ…ç»™ç›®çš„ä¸»æœºâ€¦â€¦.ã€‚ç»§ç»­è¯¥è¿‡ç¨‹ç›´åˆ°è¯¥æ•°æ®æŠ¥åˆ°è¾¾ç›®çš„ä¸»æœºã€‚Tracerouteå‘é€ä¸€ä»½udpæ•°æ®æŠ¥ç»™ç›®çš„ä¸»æœºï¼Œä½†å®ƒé€‰æ‹©ä¸€ä¸ªä¸å¯èƒ½çš„å€¼ä½œä¸ºudpç«¯å£å·(å¤§äº30000)ï¼Œä½¿ç›®çš„ä¸»æœºçš„ä»»ä½•ä¸€ä¸ªåº”ç”¨ç¨‹åºéƒ½ä¸èƒ½ä½¿ç”¨è¯¥ç«¯å£ã€‚å› ä¸ºï¼Œå½“è¯¥æ•°æ®æŠ¥åˆ°è¾¾æ—¶ï¼Œä½¿ç›®çš„ä¸»æœºçš„udpæ¨¡å—äº§ç”Ÿä¸€ä»½â€œç«¯å£ä¸å¯è¾¾â€é”™è¯¯çš„icmpæŠ¥æ–‡ï¼Œæ­¤æ—¶Tracetouteç¨‹åºéœ€è¦åšçš„å°±æ˜¯åŒºåˆ†æ¥å—åˆ°çš„icmpæŠ¥æ–‡æ˜¯è¶…æ—¶è¿˜æ˜¯ç«¯å£ä¸å¯è¾¾ã€‚ ç¬¬ä¹ç«  IPé€‰è·¯éœ€è¦è¿›è¡Œé€‰è·¯çš„æ•°æ®æŠ¥å¯ä»¥ç”±æœ¬æœºäº§ç”Ÿï¼Œä¹Ÿå¯ä»¥ç”±å…¶å®ƒä¸»æœºäº§ç”Ÿ(æ­¤ç§æƒ…å†µä¸‹ï¼šä¸»æœºå¿…é¡»è¢«é…ç½®æˆä¸€ä¸ªè·¯ç”±å™¨ï¼Œå¦åˆ™é€šè¿‡ç½‘ç»œæ¥å£æ¥å—åˆ°çš„æ•°æ®æŠ¥ï¼Œå¦‚æœç›®çš„åœ°å€ä¸æ˜¯æœ¬çº§å°±ä¼šè¢«ä¸¢å¼ƒ) IPæœç´¢è·¯ç”±è¡¨çš„æ­¥éª¤ï¼š æœç´¢åŒ¹é…çš„ä¸»æœºåœ°å€(ç½‘ç»œå·ã€ä¸»æœºå·å®Œå…¨ä¸€è‡´) æœç´¢åŒ¹é…çš„ç½‘ç»œåœ°å€(ç½‘ç»œå·ä¸€è‡´) æœç´¢é»˜è®¤è¡¨é¡¹ åŒ¹é…ä¸»æœºåœ°å€å§‹ç»ˆå‘ç”Ÿåœ¨åŒ¹é…ç½‘ç»œåœ°å€æ­¥éª¤ä¹‹å‰ã€‚ 9.2.1 è·¯ç”±è¡¨ æ ‡å¿—GåŒºåˆ†æ˜¯ç›´æ¥è·¯ç”±è¿˜æ˜¯é—´æ¥è·¯ç”±(ç›´æ¥è·¯ç”±ä¸è®¾ç½®Gæ ‡å¿—)ï¼šå‘å¾€ç›´æ¥è·¯ç”±çš„åˆ†ç»„ä¸­ä¸ä½†å…·æœ‰æŒ‡æ˜ç›®çš„ç«¯çš„ipåœ°å€ï¼Œè¿˜å…·æœ‰å…¶é“¾è·¯å±‚åœ°å€ã€‚å½“åˆ†ç»„è¢«å‘å¾€ä¸€ä¸ªé—´æ¥è·¯ç”±æ—¶ï¼ŒIPåœ°å€æŒ‡æ˜çš„æ˜¯æœ€ç»ˆçš„ç›®çš„åœ°ï¼Œä½†æ˜¯é“¾è·¯å±‚æŒ‡æ˜çš„æ˜¯ç½‘å…³(ä¸‹ä¸€ç«™è·¯ç”±å™¨)ã€‚ ç¬¬11ç«  ç”¨æˆ·æ•°æ®æŠ¥åè®®udpé¦–éƒ¨ 11.5 IPåˆ†ç‰‡ç‰©ç†ç½‘ç»œå±‚ä¸€èˆ¬è¦é™åˆ¶æ¯æ¬¡å‘é€æ•°æ®å¸§çš„æœ€å¤§é•¿åº¦ã€‚ä»»ä½•æ—¶å€™IPå±‚æ¥æ”¶åˆ°ä¸€ä»½è¦å‘é€çš„IPæ•°æ®æŠ¥æ—¶ï¼Œå®ƒè¦åˆ¤æ–­å‘æœ¬åœ°å“ªä¸ªæ¥å£å‘é€æ•°æ®(é€‰è·¯)ï¼Œå¹¶æŸ¥è¯¢è¯¥æ¥å£è·å¾—MTU(æœ€å¤§ä¼ è¾“å•å…ƒ,netstat -i)ã€‚IPæŠŠMTUä¸æ•°æ®æŠ¥é•¿åº¦è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœéœ€è¦åˆ™è¿›è¡Œåˆ†ç‰‡ã€‚åˆ†ç‰‡å¯ä»¥å‘ç”Ÿåœ¨åŸå§‹å‘é€ç«¯ä¸»æœºä¸Šï¼Œä¹Ÿå¯ä»¥å‘ç”Ÿåœ¨ä¸­é—´è·¯ç”±å™¨ä¸Šã€‚ å¼•è‡ª ã€Šè®¡ç®—æœºç½‘ç»œã€‹ æ ‡è¯†ï¼ˆidentificationï¼‰ï¼šå 16ä½ã€‚IPè½¯ä»¶åœ¨å­˜å‚¨å™¨ä¸­ç»´æŒä¸€ä¸ªè®¡æ•°å™¨ï¼Œæ¯äº§ç”Ÿä¸€ä¸ªæ•°æ®æŠ¥ï¼Œè®¡æ•°å™¨å°±åŠ 1ï¼Œå¹¶å°†æ­¤å€¼èµ‹ç»™æ ‡è¯†å­—æ®µã€‚ ä½†è¿™ä¸ªâ€œæ ‡è¯†â€ä¸æ˜¯åºå·ï¼Œå› ä¸ºIPæ˜¯æ— è¿æ¥æœåŠ¡ï¼Œæ•°æ®æŠ¥ä¸å­˜åœ¨æŒ‰åºæ¥æ”¶çš„é—®é¢˜ã€‚å½“æ•°æ®æŠ¥ç”±äºé•¿åº¦è¶…è¿‡ç½‘ç»œçš„MTUè€Œå¿…é¡»åˆ†ç‰‡æ—¶ï¼Œè¿™ä¸ªæ ‡è¯†å­—æ®µçš„å€¼å°±è¢«å¤åˆ¶åˆ°æ‰€æœ‰çš„æ•°æ®æŠ¥ç‰‡çš„æ ‡è¯†å­—æ®µä¸­ã€‚ç›¸åŒçš„æ ‡è¯†å­—æ®µçš„å€¼ä½¿åˆ†ç‰‡åçš„å„æ•°æ®æŠ¥ç‰‡æœ€åèƒ½æ­£ç¡®åœ°é‡è£…æˆä¸ºåŸ æ¥çš„æ•°æ®æŠ¥ã€‚ æ ‡å¿—ï¼ˆflagï¼‰ï¼šå 3ä½ï¼Œä½†ç›®å‰åªæœ‰ä¸¤ä½æœ‰æ„ä¹‰ã€‚ â€‹ â€“ æ ‡å¿—å­—æ®µä¸­çš„æœ€ä½ä½ä¸ºMFï¼ˆMore Fragmentï¼‰ã€‚MF=1å³è¡¨ç¤ºåé¢â€œè¿˜æœ‰åˆ†ç‰‡â€çš„æ•°æ®æŠ¥ã€‚MF=0è¡¨ç¤ºè¿™å·²æ˜¯è‹¥å¹²æ•°æ®æŠ¥ç‰‡ä¸­çš„æœ€åä¸€ä¸ªã€‚ â€‹ â€“ æ ‡å¿—å­—æ®µä¸­é—´çš„ä¸€ä½è®°ä¸ºDFï¼ˆDonâ€™t Fragmentï¼‰ï¼Œæ„æ€æ˜¯â€œä¸èƒ½åˆ†ç‰‡â€ã€‚åªæœ‰å½“DF=0æ—¶æ‰å…è®¸åˆ†ç‰‡ã€‚ ç‰‡åç§» ï¼šå 13ä½ã€‚ç‰‡åç§»æŒ‡å‡ºï¼šè¾ƒé•¿çš„åˆ†ç»„åœ¨åˆ†ç‰‡åï¼ŒæŸç‰‡åœ¨åŸåˆ†ç»„ä¸­çš„ç›¸å¯¹ä½ç½®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç›¸å¯¹äºç”¨æˆ·æ•°æ®å­—æ®µçš„èµ·ç‚¹ï¼Œè¯¥ç‰‡ä»ä½•å¤„å¼€å§‹ã€‚ç‰‡åç§»ä»¥8ä¸ªå­—èŠ‚ä¸ºåç§»å•ä½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªåˆ†ç‰‡çš„é•¿åº¦ä¸€å®šæ˜¯8å­—èŠ‚ï¼ˆ64ä½ï¼‰çš„æ•´æ•°å€ã€‚ ç¬¬åä¸ƒç«  TCP:ä¼ è¾“æ§åˆ¶åè®®17.2 TCPçš„æœåŠ¡å°½ç®¡tcpå’Œudpéƒ½ä½¿ç”¨ç›¸åŒçš„ç½‘ç»œå±‚(IP)ï¼Œtcpå‘åº”ç”¨å±‚æä¾›ä¸udpå®Œå…¨ä¸åŒçš„æœåŠ¡ã€‚tcpæä¾›ä¸€ç§é¢å‘è¿æ¥çš„ã€å¯é çš„å­—èŠ‚æµæœåŠ¡ã€‚ tcpé€šè¿‡ä¸‹åˆ—æ–¹å¼æä¾›å¯é æ€§ï¼š åº”ç”¨æ•°æ®è¢«åˆ†å‰²æˆtcpè®¤ä¸ºæœ€é€‚åˆå‘é€çš„æ•°æ®å—ã€‚ï¼ˆudpï¼šåº”ç”¨äº§ç”Ÿçš„æŠ¥æ–‡é•¿åº¦ä¿æŒä¸å˜ï¼‰ å½“tcpå‘å‡ºä¸€ä¸ªæ®µä¹‹åï¼Œå®ƒå¯åŠ¨ä¸€ä¸ªå®šæ—¶å™¨ï¼Œç­‰å¾…ç›®çš„ç«¯ç¡®è®¤æ”¶åˆ°è¿™ä¸ªæŠ¥æ–‡æ®µã€‚å¦‚æœä¸èƒ½åŠæ—¶æ”¶åˆ°ä¸€ä¸ªç¡®è®¤ï¼Œå°†é‡å‘è¿™ä¸ªæŠ¥æ–‡æ®µã€‚ å½“tcpæ”¶åˆ°å‘è‡ªtcpè¿æ¥å¦ä¸€ç«¯çš„æ•°æ®ï¼Œå®ƒå°†å‘é€ä¸€ä¸ªç¡®è®¤ã€‚ tcpå°†ä¿æŒå®ƒé¦–éƒ¨å’Œæ•°æ®çš„æ ¡éªŒå’Œã€‚ï¼ˆå¦‚æœæ”¶åˆ°æ®µçš„æ£€éªŒå’Œæœ‰å·®é”™ï¼Œtcpå°†ä¸¢å¼ƒè¿™ä¸ªæŠ¥æ–‡æ®µå¹¶ä¸ç¡®è®¤æ”¶åˆ°æ­¤æŠ¥æ–‡æ®µï¼‰ tcpæŠ¥æ–‡æ®µä½œä¸ºIPæ•°æ®æŠ¥ä¼ è¾“ï¼Œè€Œipæ•°æ®æŠ¥çš„åˆ°è¾¾å¯èƒ½ä¼šå¤±åºï¼Œå› æ­¤tcpæŠ¥æ–‡æ®µçš„åˆ°è¾¾ä¹Ÿæœ‰å¯èƒ½å¤±åºã€‚tcpå°†ä¼šå¯¹æ”¶åˆ°çš„æ•°æ®è¿›è¡Œæ’åºç„¶åäº¤ç»™åº”ç”¨å±‚ã€‚ ipæ•°æ®æŠ¥ä¼šå‘ç”Ÿé‡å¤ï¼Œå› æ­¤æ¥æ”¶ç«¯å¿…é¡»ä¸¢å¼ƒé‡å¤çš„æ•°æ®ã€‚ tcpèƒ½æä¾›æµé‡æ§åˆ¶ã€‚tcpè¿æ¥çš„æ¯ä¸€æ–¹éƒ½æœ‰å›ºå®šå¤§å°çš„ç¼“å†²ç©ºé—´ã€‚tcpçš„æ¥æ”¶ç«¯åªå…è®¸å¦ä¸€ç«¯å‘é€æ¥æ”¶ç«¯ç¼“å†²åŒºæ‰€èƒ½æ¥çº³çš„å¤§å°ã€‚ï¼ˆé˜²æ­¢å‘é€è¾ƒå¿«çš„ä¸»æœºä½¿æ¥æ”¶çš„è¾ƒæ…¢çš„ä¸»æœºç¼“å†²åŒºæº¢å‡ºï¼‰ 17.3 TCPçš„é¦–éƒ¨tcpæ•°æ®è¢«å°è£…åœ¨ä¸€ä¸ªipæ•°æ®æŠ¥ä¸­ã€‚ tcpé¦–éƒ¨ï¼š 16ä½çš„æºç«¯å£å·å’Œç›®çš„ç«¯å£å·ï¼ˆç”¨äºå¯»æ‰¾å‘ç«¯å’Œæ¥æ”¶ç«¯çš„åº”ç”¨ç¨‹åºï¼‰ï¼Œå®¢æˆ·ç«¯ipã€å®¢æˆ·ç«¯ç«¯å£ã€æœåŠ¡ç«¯ipã€æœåŠ¡ç«¯ç«¯å£å¯å”¯ä¸€ç¡®å®šä¸€ä¸ªtcpè¿æ¥ã€‚ åºå·ï¼šæ ‡è¯†ä»tcpå‘ç«¯å‘tcpæ”¶ç«¯å‘é€çš„æ•°æ®å­—èŠ‚æµï¼Œå®ƒè¡¨ç¤ºåœ¨è¿™ä¸ªæŠ¥æ–‡æ®µä¸­çš„ç¬¬ä¸€ä¸ªæ•°æ®å­—èŠ‚ã€‚å¦‚æœå°†å­—èŠ‚æµçœ‹ä½œåœ¨ä¸¤ä¸ªåº”ç”¨ç¨‹åºé—´çš„å•å‘æµåŠ¨ï¼Œåˆ™tcpç”¨åºå·å¯¹æ¯ä¸ªå­—èŠ‚è¿›è¡Œè®¡æ•°ã€‚ï¼ˆåºå·æ˜¯32bitï¼Œåºå·è¾¾åˆ°232-1ååˆä»0å¼€å§‹ã€‚ï¼‰å½“å»ºç«‹ä¸€ä¸ªæ–°çš„è¿æ¥æ—¶ï¼ŒSYNæ ‡å¿—ä½å˜æˆ1ã€‚åºå·å­—æ®µåŒ…å«ç”±è¿™ä¸ªä¸»æœºé€‰æ‹©çš„è¯¥è¿æ¥çš„åˆå§‹åºå·ISN(Initial Sequece Number)ã€‚è¯¥ä¸»æœºè¦å‘é€çš„ç¬¬ä¸€ä¸ªå­—èŠ‚åºåˆ—å·ä¸ºISN+1(SYNæ ‡å¿—æ¶ˆè€—äº†ä¸€ä¸ªåºå·)ã€‚ ç¡®è®¤åºå·ï¼šæ˜¯å‘é€ç«¯åºå·çš„ä¸‹ä¸€ä¸ªåºå·ã€‚åªæœ‰ACKæ ‡å¿—ä¸º1æ—¶ç¡®è®¤åºå·æ‰æœ‰æ•ˆã€‚å‘é€ACKä¸éœ€è¦ä»»ä½•ä»£ä»·ï¼Œå› ä¸ºæ˜¯åŒ…å«åœ¨é¦–éƒ¨ä¸­çš„å­—æ®µï¼Œä¸€ä¸ªtcpè¿æ¥ä¸€æ—¦å»ºç«‹èµ·æ¥ï¼ŒACKæ ‡è¯†æ€»æ˜¯è¢«ç½®ä¸º1ã€‚tcpæä¾›å…¨åŒå·¥æœåŠ¡ é¦–éƒ¨é•¿åº¦ï¼š4bitï¼Œèƒ½è¡¨ç¤ºçš„èŒƒå›´æ˜¯0-15ï¼Œå•ä½æ˜¯4å­—èŠ‚ï¼Œæ‰€ä»¥tcpé¦–éƒ¨æœ€å¤§ä¸º60å­—èŠ‚ã€‚ æ ‡å¿—ä½ï¼š6ä¸ªæ ‡å¿—ä½ URGï¼šç´§æ€¥æŒ‡é’ˆæœ‰æ•ˆ ACKï¼šç¡®è®¤åºå·æœ‰æ•ˆ PSHï¼šæ¥æ”¶æ–¹åº”å°½å¿«å°†è¿™ä¸ªæŠ¥æ–‡äº¤ç»™åº”ç”¨å±‚ RSTï¼šé‡å»ºè¿æ¥ SYNï¼šåŒæ­¥åºå·ï¼Œç”¨æ¥å‘èµ·ä¸€ä¸ªè¿æ¥ FINï¼šå‘ç«¯å®Œæˆå‘é€ä»»åŠ¡ çª—å£ï¼štcpçš„æµé‡æ§åˆ¶ç”±è¿æ¥çš„æ¯ä¸€ç«¯é€šè¿‡å£°æ˜çš„çª—å£å¤§å°æä¾›ã€‚çª—å£å¤§å°ä¸ºå­—èŠ‚æ•°ï¼Œ16bitå› è€Œçª—å£å¤§å°æœ€å¤§ä¸º65535å­—èŠ‚ã€‚ æ£€éªŒå’Œï¼šè¦†ç›–æ•´ä¸ªtcpæŠ¥æ–‡æ®µâ€”-é¦–éƒ¨å’Œæ•°æ® ç´§æ€¥æŒ‡é’ˆï¼šåªæœ‰URGæ ‡å¿—ç½®ä¸º1æ—¶æ‰æœ‰æ•ˆã€‚ å¸¸è§å¯é€‰å­—æ®µï¼šæœ€é•¿æŠ¥æ–‡å¤§å°ï¼Œåˆç§°ä¸ºMSS(Maximum Segment Size)ï¼Œæ¯ä¸ªè¿æ¥æ–¹é€šå¸¸éƒ½åœ¨é€šä¿¡çš„ç¬¬ä¸€ä¸ªæŠ¥æ–‡æ®µä¸­å£°æ˜è¿™ä¸ªé€‰é¡¹ï¼Œå®ƒæŒ‡æ˜æœ¬ç«¯èƒ½æ¥æ”¶æœ€å¤§é•¿åº¦çš„æŠ¥æ–‡æ®µã€‚ ç¬¬åå…«ç«  TCPè¿æ¥çš„å»ºç«‹ä¸ç»ˆæ­¢18.2 è¿æ¥çš„å»ºç«‹ä¸ç»ˆæ­¢æ³¨ï¼šFlags [S.]ï¼ŒSè¡¨ç¤ºSYNï¼Œâ€œ.â€è¡¨ç¤ºACK è¿™æ˜¯ç”¨telnetå®ç°çš„ä¸€æ¬¡é€šä¿¡ï¼Œåˆ©ç”¨tcpdumpè¿›è¡ŒæŠ“åŒ…ï¼Œå¦‚ä¸‹æ˜¯åˆ†æï¼ˆiZbp11u8qxiwepq15dm1liZè¡¨ç¤ºæœ¬æœºï¼‰ï¼š ç¬¬ä¸€è¡Œï¼šæ–¹å‘ï¼šiZbp11u8qxiwepq15dm1liZ &gt; 47.96.67.121ã€‚iZbp11u8qxiwepq15dm1liZ é€šè¿‡54008ç«¯å£å‘é€ä¸€ä¸ªSYNæ ‡å¿—ä½ä¸º1(é€šè¿‡Flagså­—æ®µå¾—çŸ¥)çš„æŠ¥æ–‡ç»™è¿œç«¯ä¸»æœº47.96.67.121çš„sshç«¯å£â€“ä¹Ÿå°±æ˜¯22ç«¯å£ï¼Œæ­¤æŠ¥æ–‡çš„åºå·å³seqæ˜¯ï¼š826162287ï¼ˆISNï¼‰ï¼Œåé¢çš„å­—æ®µæš‚æ—¶å¯ä»¥å¿½ç•¥ã€‚ ç¬¬äºŒè¡Œï¼šæ–¹å‘ï¼š47.96.67.121 &gt; iZbp11u8qxiwepq15dm1liZã€‚è¿œç¨‹ä¸»æœº47.96.67.121 å›å¤ä¸€ä¸ªSYNæ ‡å¿—ä½ä¸º1çš„æŠ¥æ–‡ç»™ iZbp11u8qxiwepq15dm1liZï¼Œæ­¤æŠ¥æ–‡åºå·å³seqæ˜¯ï¼š1641364849ï¼Œæ­¤æŠ¥æ–‡ä¸­å‡ºç°äº†ackå­—æ®µï¼ˆè¡¨ç¤ºç¡®è®¤ï¼‰ï¼Œåªæœ‰åœ¨é¦–éƒ¨ä¸­ACKæ ‡å¿—è¢«ç½®ä¸º1æ—¶æ‰æ˜¾ç¤ºï¼Œè¯´æ˜æ­¤æŠ¥æ–‡ä¸­SYNã€ACKä¸¤ä¸ªæ ‡å¿—ä½ä¸º1ï¼Œå½“ACKä¸º1æ—¶ç¡®è®¤åºå·ç”Ÿæ•ˆâ€”826162288 ç¬¬ä¸‰è¡Œï¼šæ–¹å‘ï¼šiZbp11u8qxiwepq15dm1liZ &gt; 47.96.67.121ã€‚ç”±äº47.96.67.121å‘æ¥çš„æŠ¥æ–‡é¦–éƒ¨ä¸­åºå·æ˜¯1641364849(ç¬¬äºŒè¡Œ)ï¼Œæ‰€ä»¥åœ¨ç»™47.96.67.121 å›åŒ…æ—¶ä¼šå°†ç¡®è®¤åºå·ç½®ä¸º åºå·ï¼ˆ1641364849ï¼‰çš„ä¸‹ä¸€ä¸ªåºå·ã€‚ ç¬¬å››è¡Œï¼šæ–¹å‘ï¼š47.96.67.121 &gt; iZbp11u8qxiwepq15dm1liZã€‚åˆ°è¿™é‡Œè¿æ¥å»ºç«‹æˆåŠŸï¼Œå¼€å§‹æ•°æ®ä¼ è¾“ï¼Œæ®å›¾ç¬¬å››è¡Œå¯çŸ¥ä¼ è¾“äº†21å­—èŠ‚ã€‚ ç¬¬äº”è¡Œï¼šæ–¹å‘ï¼šiZbp11u8qxiwepq15dm1liZ &gt; 47.96.67.121ã€‚æ”¶åˆ°ç¡®è®¤æ•°æ®æŠ¥æ–‡åé€šçŸ¥å‘é€ç«¯ã€‚ ç¬¬å…­è¡Œï¼šæ–¹å‘ï¼šiZbp11u8qxiwepq15dm1liZ &gt; 47.96.67.121ã€‚å‘é€ä¸€ä¸ªæŠ¥æ–‡ï¼Œæ ‡å¿—ä½FINä¸º1ï¼Œæ„æ€æ˜¯ç»™47.96.67.121è¯´æ•°æ®å‘é€å®Œæ¯•ï¼Œæˆ‘è¦å…³é—­äº†ã€‚ ç¬¬ä¸ƒè¡Œï¼šæ–¹å‘ï¼š47.96.67.121 &gt; iZbp11u8qxiwepq15dm1liZã€‚æœåŠ¡ç«¯å›å¤ä¸€ä¸ªackç»™iZbp11u8qxiwepq15dm1liZè¯´ æˆ‘å·²ç»æ”¶åˆ°ä½ è¦å…³é—­çš„æ¶ˆæ¯äº†ã€‚ ç¬¬å…«è¡Œï¼šæ–¹å‘ï¼š47.96.67.121 &gt; iZbp11u8qxiwepq15dm1liZã€‚47.96.67.121å‘é€FINç»™iZbp11u8qxiwepq15dm1liZè¯´æˆ‘å…³é—­äº†ã€‚ ç¬¬ä¹è¡Œï¼šæ–¹å‘ï¼šiZbp11u8qxiwepq15dm1liZ &gt; 47.96.67.121ã€‚å‘Šè¯‰47.96.67.121æˆ‘æ”¶åˆ°ä½ çš„å…³é—­æ¶ˆæ¯äº†ï¼Œç„¶åå‘é€ä¸€ä¸ªackå‘47.96.67.121ç¡®è®¤ã€‚ 18.4 æœ€å¤§æŠ¥æ–‡æ®µé•¿åº¦ æœ€å¤§æŠ¥æ–‡é•¿åº¦(MSS)è¡¨ç¤ºtcpç©¿å¾€å¦ä¸€ç«¯çš„æœ€å¤§å—æ•°æ®é•¿åº¦ã€‚å½“ä¸€ä¸ªè¿æ¥å»ºç«‹æ—¶ï¼Œè¿æ¥åŒæ–¹éƒ½è¦é€šå‘Šå„è‡ªçš„MMS(MSSåªèƒ½å‡ºç°åœ¨SYNæŠ¥æ–‡æ®µä¸­)ã€‚ä¸Šå›¾ä¸­ç¬¬ä¸€è¡Œï¼šmssä¸º1406ã€‚ 18.5 TCPçš„åŠå…³é—­TCPæä¾›äº†è¿æ¥çš„ä¸€æ®µåœ¨ç»“æŸäº†å®ƒçš„å‘é€ä¹‹åè¿˜èƒ½æ¥æ”¶å¦ä¸€ç«¯çš„æ•°æ®çš„èƒ½åŠ›ã€‚ 18.6.1 2MSLç­‰å¾…çŠ¶æ€å½“tcpæ‰§è¡Œä¸€ç«¯ä¸»åŠ¨å…³é—­ï¼Œå¹¶å‘å›æœ€åä¸€ä¸ªackï¼Œè¯¥è¿æ¥å¿…é¡»åœ¨TIME_WAITçŠ¶æ€åœç•™çš„æ—¶é—´ä¸º2MSL(Max Segment LifeTime)ï¼Œè¿™æ ·å¯ä»¥è®©tcpèƒ½å¤Ÿå†æ¬¡å‘é€æœ€åçš„ACKä»¥é˜²æ­¢è¿™ä¸ªACKä¸¢å¤±ã€‚åœ¨2MSLç­‰å¾…æœŸé—´ï¼Œæ’å£ä¸­ä½¿ç”¨çš„æœ¬åœ°ç«¯å£åœ¨é»˜è®¤æƒ…å†µä¸‹ä¸èƒ½å†è¢«ä½¿ç”¨ã€‚ 18.6.3 FIN_WAIT_2çŠ¶æ€ 18.7 å¤ä½æŠ¥æ–‡æ®µ å‘ä¸€ä¸ªæ²¡æœ‰ç›‘å¬çš„ç«¯å£å‘èµ·è¿æ¥ï¼ŒæœåŠ¡ç«¯è¿”å›äº†ä¸€ä¸ªRSTæ ‡å¿—ä¸º1çš„æŠ¥æ–‡ã€‚ ç¬¬äºŒåç« 20.6 æ…¢å¯åŠ¨åœ¨å±€åŸŸç½‘ç»œä¸­ï¼Œå‘é€æ–¹ä¸€å¼€å§‹ä¾¿å‘ç½‘ç»œä¸­å‘é€å¤šä¸ªæŠ¥æ–‡æ®µï¼Œç›´åˆ°è¾¾åˆ°æ¥æ”¶æ–¹é€šå‘Šçš„çª—å£å¤§å°ä¸ºæ­¢ï¼Œè¿™ç§æ–¹å¼æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚ä½†æ˜¯å½“å‘é€ç«¯å’Œæ¥æ”¶ç«¯ä¹‹é—´å­˜åœ¨å¤šä¸ªè·¯ç”±å™¨å’Œé€Ÿç‡è¾ƒæ…¢çš„é“¾è·¯æ—¶ï¼Œå°±æœ‰å¯èƒ½å‡ºç°ä¸€äº›é—®é¢˜ï¼šä¸€äº›ä¸­é—´è·¯ç”±å™¨å¿…é¡»ç¼“å­˜åˆ†ç»„(æŠ¥æ–‡)ï¼Œå¹¶æœ‰å¯èƒ½è€—å°½å­˜å‚¨å™¨çš„ç©ºé—´(å­˜å‚¨å™¨è€—å°½ä¹‹åè·¯ç”±å™¨ä¼šä¸¢å¼ƒæ–°æ”¶åˆ°çš„åˆ†ç»„)ã€‚ tcpæ”¯æŒæ…¢å¯åŠ¨ç®—æ³•ï¼Œè¯¥ç®—æ³•é€šè¿‡è§‚å¯Ÿåˆ°æ–°åˆ†ç»„è¿›å…¥ç½‘ç»œçš„é€Ÿç‡åº”è¯¥å’Œå¦ä¸€ç«¯è¿”å›ç¡®è®¤çš„é€Ÿç‡ç›¸åŒè€Œè¿›è¡Œå·¥ä½œã€‚ æ…¢å¯åŠ¨ä¸ºå‘é€æ–¹tcpå¢åŠ äº†å¦ä¸€ä¸ªæ–°çª—å£ï¼šæ‹¥å¡çª—å£(cwnd)ã€‚å½“ä¸å¦ä¸€ä¸ªç½‘ç»œçš„ä¸»æœºå»ºç«‹tcpè¿æ¥æ—¶ï¼Œæ‹¥å¡çª—å£è¢«åˆå§‹åŒ–ä¸ºä¸€ä¸ªæŠ¥æ–‡æ®µå¤§å°(å¦ä¸€ç«¯é€šå‘Šçš„çª—å£å¤§å°)ã€‚æ¯æ”¶åˆ°ä¸€ä¸ªackï¼Œæ‹¥å¡çª—å£å°±å¢åŠ ä¸€ä¸ªæŠ¥æ–‡æ®µ(cwndä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œä½†æ˜¯æ…¢å¯åŠ¨ä»¥æŠ¥æ–‡æ®µå¤§å°ä¸ºå•ä½è¿›è¡Œå¢åŠ )ã€‚å‘é€æ–¹å–æ‹¥å¡çª—å£ä¸é€šå‘Šçª—å£ä¸­çš„æœ€å°å€¼ä½œä¸ºå‘é€ä¸Šé™(æŠ¥æ–‡é•¿åº¦)ã€‚æ‹¥å¡çª—å£æ˜¯å‘é€å‘ä½¿ç”¨çš„æµé‡æ§åˆ¶ï¼Œé€šå‘Šçª—å£æ˜¯æ¥æ”¶æ–¹ä½¿ç”¨çš„æµé‡æ§åˆ¶ã€‚ æ‹¥å¡çª—å£ä¹Ÿä¸å¯èƒ½æ— é™å¢å¤§ï¼Œåœ¨ç½‘ç»œä¼ è¾“ä¸­ï¼Œå½“æŸäº›ç‚¹ä¸Šçš„è·¯ç”±å™¨ç½‘ç»œå®¹é‡è¾¾åˆ°äº†ä¸Šé™ï¼Œäºæ˜¯ä¸­é—´è·¯ç”±å™¨å¼€å§‹ä¸¢å¼ƒåˆ†ç»„å¹¶é€šçŸ¥å‘é€æ–¹ã€‚ ç¬¬äºŒåä¸€ç«  TCPçš„è¶…æ—¶ä¸é‡ä¼ tcpæä¾›å¯é çš„è¿è¾“å±‚ï¼šç¡®è®¤ä»å¦ä¸€ç«¯æ”¶åˆ°çš„æ•°æ®(ack)ï¼Œä½†æ•°æ®å’Œç¡®è®¤éƒ½å¯èƒ½ä¼šå‘ç”Ÿä¸¢å¤±ã€‚tcpé€šè¿‡åœ¨å‘é€æ—¶è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨è§£å†³æ•°æ®å’Œç¡®è®¤ä¸¢å¤±çš„é—®é¢˜ï¼Œå½“å®šæ—¶å™¨å‘ç”Ÿæº¢å‡ºæ—¶è¿˜æ²¡æœ‰æ”¶åˆ°è¯¥æ•°æ®çš„ç¡®è®¤å°±é‡ä¼ è¯¥æ•°æ®ã€‚ å¯¹äºæ¯ä¸ªè¿æ¥ï¼Œtcpç®¡ç†å››ä¸ªå®šæ—¶å™¨ï¼š é‡ä¼ å®šæ—¶å™¨ï¼šæœŸæœ›æ”¶åˆ°å¯¹ç«¯ç¡®è®¤çš„æœ€å¤§ç­‰å¾…æ—¶é—´ã€‚ åšæŒå®šæ—¶å™¨ï¼šä½¿çª—å£å¤§å°ä¿¡æ¯ä¿æŒä¸æ–­æµåŠ¨ï¼Œå½“å‘é€ç«¯çš„å‘é€é€Ÿåº¦è¿‡å¿«ï¼Œæ¥æ”¶æ–¹çš„ç¼“å†²åŒºè¢«æ‰“æ»¡æ—¶ï¼Œæ¥æ”¶æ–¹ä¼šé€šå‘Šçª—å£å¤§å°ä¸º0ï¼Œæ­¤æ—¶å‘é€æ–¹ä¼šæš‚åœæ•°æ®å‘é€ï¼ŒåšæŒå®šæ—¶å™¨çš„ä½œç”¨å°±æ˜¯ä¸æ–­å‘é€æŠ¥æ–‡è¯¢é—®çª—å£å¤§å°é˜²æ­¢å‡ºç°æ­»é”(æ¥æ”¶ç«¯ä¸é€šå‘Šæ–°çš„çª—å£å¤§å°ï¼Œå‘é€æ–¹ä¸€ç›´ç­‰å¾…ã€‚) ä¿æ´»å®šæ—¶å™¨ï¼šå¯ä»¥æ£€æµ‹åˆ°ä¸€ä¸ªç©ºé—²è¿æ¥çš„å¦ä¸€ç«¯ä½•æ—¶å´©æºƒæˆ–è€…é‡å¯ã€‚ 2MSLå®šæ—¶å™¨ï¼šæµ‹é‡ä¸€ä¸ªè¿æ¥å¤„äºTIME_WAITçŠ¶æ€çš„æ—¶é—´ã€‚ 21.2 è¶…æ—¶é‡ä¼ ä¾‹å­ 21.3 å¾€è¿”æ—¶é—´æµ‹é‡tcpè¶…æ—¶ä¸é‡ä¼ ä¸­æœ€é‡è¦çš„éƒ¨åˆ†å°±æ˜¯å¯¹ä¸€ä¸ªç»™å®šçš„è¿æ¥çš„å¾€è¿”æ—¶é—´(RTT)æµ‹é‡","categories":[],"tags":[]},{"title":"Cå’ŒæŒ‡é’ˆ","slug":"Cå’ŒæŒ‡é’ˆ","date":"2021-03-18T03:09:52.067Z","updated":"2021-03-18T03:09:52.067Z","comments":true,"path":"2021/03/18/Cå’ŒæŒ‡é’ˆ/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/C%E5%92%8C%E6%8C%87%E9%92%88/","excerpt":"","text":"ç¬¬3ç« 3.1 åŸºæœ¬æ•°æ®ç±»å‹3.1.1 æ•´å½¢å®¶æ—é•¿æ•´å‹è‡³å°‘åº”è¯¥å’Œæ•´å‹ä¸€æ ·ï¼Œè€Œæ•´å‹è‡³å°‘åº”è¯¥å’ŒçŸ­æ•´å‹ä¸€æ ·é•¿ã€‚ ä¸€ã€æ•´å‹å­—é¢å€¼ åˆå§‹åŒ–ä¹‹åä¸å¯ä»¥è¢«ä¿®æ”¹ã€‚ åœ¨æ•´æ•°å­—é¢å€¼åé¢æ·»åŠ Læˆ–lï¼Œå¯ä»¥ä½¿è¿™ä¸ªæ•´æ•°è¢«è§£é‡Šä¸ºlongç±»å‹å€¼ï¼Œå­—ç¬¦Uæˆ–uåˆ™ç”¨äºæŠŠæ•°å€¼æŒ‡å®šä¸ºunsignedæ•´å‹å€¼ã€‚å¦‚æœæ·»åŠ luåˆ™è¢«è§£é‡Šä¸º unsigned long æ•´å‹å€¼ã€‚å­—ç¬¦å¸¸é‡çš„ç±»å‹æ€»æ˜¯intã€‚ int main() { 123L; 123u; 123LU; 0123; // 8è¿›åˆ¶ 0x1561; // 16è¿›åˆ¶ printf(&quot;%lu\\n&quot;,sizeof(&#39;a&#39;)); // 4 return 0; } äºŒã€æšä¸¾ç±»å‹ ä»¥æ•´å‹æ–¹å¼å­˜å‚¨ã€‚ enum age { a, b, c, d }; 3.1.1 æµ®ç‚¹ç±»å‹int main() { printf(&quot;%lu\\n&quot;,sizeof(3.14)); // 8,ç¼ºçœæ—¶é»˜è®¤ä¸ºdoubleç±»å‹ printf(&quot;%lu\\n&quot;,sizeof(3.14l)); // 16,long double printf(&quot;%lu\\n&quot;,sizeof(3.14f)); // 4 printf(&quot;%lu\\n&quot;,sizeof(double )); // 8 printf(&quot;%lu\\n&quot;,sizeof(float )); // 4 return 0; } 3.1.3 æŒ‡é’ˆæŠŠå†…å­˜æƒ³è±¡æˆä¸€æ¡é•¿è¡—ï¼Œæ¯é—´æˆ¿å­éƒ½ç”¨ä¸€ä¸ªå”¯ä¸€çš„å·ç è¿›è¡Œæ ‡è¯†ã€‚æ¯ä¸€ä¸ªä½ç½®åŒ…å«ä¸€ä¸ªå€¼ï¼Œè¿™å’Œå®ƒçš„åœ°å€å¼ç‹¬ç«‹ä¸”æ˜¾è‘—ä¸åŒçš„ï¼Œå³ä½¿ä»–ä»¬éƒ½æ˜¯æ•°å­—ã€‚ ä¸€ã€æŒ‡é’ˆå¸¸é‡ äºŒã€å­—ç¬¦ä¸²å¸¸é‡ å­—ç¬¦ä¸²ï¼šä¸€ä¸²ä»¥NULå­—èŠ‚ç»“å°¾çš„é›¶ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚å­—ç¬¦ä¸²é€šå¸¸å­˜å‚¨åœ¨å­—ç¬¦æ•°ç»„æ€»ï¼Œæ‰€ä»¥cè¯­è¨€ä¸­æ²¡æœ‰æ˜¾ç¤ºçš„å­—ç¬¦ä¸²ç±»å‹ã€‚ int main() { printf(&quot;%lu\\n&quot;,sizeof(&quot;&quot;)); // 1ï¼Œè™½ç„¶å­—ç¬¦ä¸²ä¸ºç©ºï¼Œä½†æ˜¯è¿˜æ˜¯ä¼šåˆ†é…å†…å­˜ return 0; } åœ¨ç¨‹åºä¸­ä½¿ç”¨å­—ç¬¦ä¸²å¸¸é‡æ—¶ä¼šç”Ÿæˆä¸€ä¸ªâ€œæŒ‡å‘å­—ç¬¦çš„å¸¸é‡æŒ‡é’ˆâ€ï¼Œå½“ä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡å‡ºç°äºä¸€ä¸ªè¡¨è¾¾å¼ä¸­æ—¶ï¼Œè¡¨è¾¾å¼æ‰€ä½¿ç”¨çš„å€¼å°±æ˜¯è¿™äº›å­—ç¬¦æ‰€å­˜å‚¨çš„åœ°å€ï¼Œè€Œä¸æ˜¯è¿™äº›å­—ç¬¦æœ¬èº«ã€‚å› æ­¤ï¼Œå¯ä»¥æŠŠå­—ç¬¦ä¸²å¸¸é‡èµ‹å€¼ç»™ä¸€ä¸ªâ€œæŒ‡å‘å­—ç¬¦çš„æŒ‡é’ˆâ€ã€‚ä½†æ˜¯ä¸èƒ½æŠŠå­—ç¬¦ä¸²å¸¸é‡èµ‹å€¼ç»™ä¸€ä¸ªå­—ç¬¦æ•°ç»„ï¼Œå› ä¸ºå­—ç¬¦ä¸²å¸¸é‡çš„ç›´æ¥å€¼æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œè€Œä¸æ˜¯è¿™äº›å­—ç¬¦æœ¬èº«ã€‚ 3.2 åŸºæœ¬ç”³æ˜int a; 3.2.1 åˆå§‹åŒ–3.2.2 å£°æ˜ç®€å•æ•°ç»„int arr[100]; 3.2.3 å£°æ˜æŒ‡é’ˆint *a; int *b,*c; char *message = &quot;hello world&quot;; /* char *message; message = &quot;hello world&quot;; */ 3.2.4 éšå¼å£°æ˜å‡½æ•°å¦‚æœä¸æ˜¾ç¤ºçš„å£°æ˜è¿”å›å€¼çš„ç±»å‹ï¼Œå°±é»˜è®¤è¿”å›æ•´å‹ã€‚ f(int x) { return x*2; } int main() { printf(&quot;ret = %d\\n&quot;,f(3)); return 0; } 3.3 typedefä¸ºæ•°æ®ç±»å‹å®šä¹‰æ–°çš„åå­—ï¼Œè€Œä¸æ˜¯äº§ç”Ÿæ–°çš„ç±»å‹ã€‚ int const a; const int a; // äºŒè€…ç­‰ä»· int const *pi; // constä¿®é¥° *pi ï¼Œå¯ä»¥ä¿®æ”¹piçš„å€¼ä½†æ˜¯ä¸å¯ä»¥ä¿®æ”¹piæ‰€æŒ‡å‘çš„åœ°å€çš„å€¼ int * const cpi; // å¯ä»¥ä¿®æ”¹cpiæ‰€æŒ‡å‘åœ°å€çš„å€¼ä½†æ˜¯ä¸å¯ä»¥ä¿®æ”¹cpiæŒ‡å‘çš„åœ°å€ã€‚ int const * const cpci; // æ— è®ºæ˜¯cpciæŒ‡é’ˆæœ¬èº«è¿˜æ˜¯å®ƒæ‰€æŒ‡å‘çš„åœ°å€çš„å€¼ éƒ½ä¸å¯ä»¥ä¿®æ”¹ 3.5 ä½œç”¨åŸŸ3.5.1 ä»£ç å—ä½œç”¨åŸŸä»»ä½•åœ¨ä»£ç å—çš„å¼€å§‹ä½ç½®å£°æ˜çš„æ ‡è¯†ç¬¦éƒ½å…·æœ‰ä»£ç å—ä½œç”¨åŸŸã€‚ 3.5.2 æ–‡ä»¶ä½œç”¨åŸŸåœ¨ä»£ç å—ä¹‹å¤–å£°æ˜çš„æ ‡è¯†ç¬¦éƒ½å…·æœ‰æ–‡ä»¶ä½œç”¨åŸŸã€‚ 3.5.3 åŸå‹ä½œç”¨åŸŸåªé€‚ç”¨äºåœ¨å‡½æ•°åŸå‹ä¸­å£°æ˜çš„å‚æ•°åã€‚ int f(int x) { return x; } 3.6 é“¾æ¥å±æ€§æ ‡è¯†ç¬¦çš„é“¾æ¥å±æ€§å†³å®šå¦‚ä½•å¤„ç†åœ¨ä¸åŒæ–‡ä»¶ä¸­å‡ºç°çš„æ ‡è¯†ç¬¦ã€‚ é“¾æ¥å±æ€§ external (extern) å±äºexternalé“¾æ¥å±æ€§çš„è¡¨ç¤ºç¬¦ä¸è®ºå£°æ˜å¤šå°‘æ¬¡ã€ä½äºå‡ ä¸ªæºæ–‡ä»¶éƒ½è¡¨ç¤ºåŒä¸€å®ä½“ã€‚ internal (static) å±äºinternalçš„è¿æ¥å±æ€§çš„æ ‡è¯†ç¬¦åœ¨åŒä¸€æºæ–‡ä»¶å†…çš„æ‰€æœ‰å£°æ˜ä¸­éƒ½æŒ‡åŒä¸€ä¸ªå®ä½“ã€‚ none (auto) æ²¡æœ‰é“¾æ¥å±æ€§çš„æ ‡è¯†ç¬¦æ€»æ˜¯è¢«å½“åšå•ç‹¬çš„ä¸ªä½“ã€‚ 3.7 å­˜å‚¨ç±»å‹å˜é‡çš„å­˜å‚¨ç±»å‹æ˜¯æŒ‡å­˜å‚¨å˜é‡å€¼çš„å†…å­˜ç±»å‹ã€‚å˜é‡çš„å­˜å‚¨ç±»å‹å†³å®šå˜é‡ä½•æ—¶åˆ›å»ºã€ä½•æ—¶é”€æ¯ä»¥åŠå®ƒçš„å€¼å°†ä¿æŒå¤šä¹…ã€‚ æ™®é€šå†…å­˜ è¿è¡Œæ—¶å †æ ˆ ç¡¬ä»¶å¯„å­˜å™¨ å˜é‡çš„ç¼ºçœå­˜å‚¨ç±»å‹å–å†³äºå®ƒçš„å£°æ˜ä½ç½®ã€‚åœ¨ä»»ä½•ä»£ç å—ä¹‹å¤–å£°æ˜çš„å˜é‡æ€»æ˜¯å­˜å‚¨äºé™æ€å†…å­˜ä¸­(ä¸å±äºå †æ ˆ)ï¼Œè¿™ç±»å˜é‡ç§°ä¸ºé™æ€å˜é‡ã€‚é™æ€å˜é‡åœ¨ç¨‹åºè¿è¡Œä¹‹å‰åˆ›å»ºï¼Œåœ¨ç¨‹åºçš„æ•´ä¸ªæ‰§è¡ŒæœŸé—´å§‹ç»ˆå­˜åœ¨ã€‚ åœ¨ä»£ç å—å†…éƒ¨å£°æ˜çš„å˜é‡çš„ç¼ºçœå†…å­˜å­˜å‚¨ç±»å‹æ˜¯è‡ªåŠ¨çš„(automatic)ï¼Œå®ƒå­˜å‚¨äºå †æ ˆä¸­ï¼Œç§°ä¸ºè‡ªåŠ¨(auto)å˜é‡ã€‚åœ¨ç¨‹åºæ‰§è¡Œåˆ°å£°æ˜è‡ªåŠ¨å˜é‡çš„ä»£ç å—æ—¶ï¼Œè‡ªåŠ¨å˜é‡æ‰è¢«åˆ›å»ºï¼Œå½“ç¨‹åºç¦»å¼€è¯¥ä»£ç å—æ—¶è‡ªè¡Œé”€æ¯ã€‚ å¯¹äºåœ¨ä»£ç å—å†…éƒ¨å£°æ˜çš„å˜é‡ï¼ŒåŠ ä¸Šstaticå…³é”®å­—ï¼Œå¯ä»¥ä½¿å®ƒçš„å­˜å‚¨ç±»å‹ä»è‡ªåŠ¨å˜ä¸ºé™æ€ã€‚å…·æœ‰é™æ€å­˜å‚¨ç±»å‹çš„å˜é‡åœ¨æ•´ä¸ªç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­ä¸€ç›´å­˜åœ¨ï¼Œè€Œä¸ä»…ä»…åœ¨å£°æ˜å®ƒçš„ä»£ç å—çš„æ‰§è¡Œæ—¶å­˜åœ¨ã€‚ä¿®æ”¹å˜é‡çš„å­˜å‚¨ç±»å‹å¹¶ä¸è¡¨ç¤ºä¿®æ”¹è¯¥å˜é‡çš„ä½œç”¨åŸŸï¼Œå®ƒä»ç„¶åªèƒ½åœ¨è¯¥ä»£ç å—å†…éƒ¨æŒ‰å˜é‡åè®¿é—®ã€‚å‡½æ•°å½¢å¼å‚æ•°ä¸èƒ½å£°æ˜ä¸ºé™æ€ï¼Œå› ä¸ºå®å‚æ€»æ˜¯åœ¨å †æ ˆä¸­ä¼ é€’ç»™å‡½æ•°ï¼Œç”¨äºæ”¯æŒé€’å½’ã€‚ registerå¯ä»¥ç”¨äºè‡ªåŠ¨å˜é‡å£°æ˜ï¼Œæç¤ºä»–ä»¬åº”è¯¥å­˜å‚¨äºæœºå™¨çš„ç¡¬ä»¶å¯„å­˜å™¨è€Œä¸æ˜¯å†…å­˜ä¸­ï¼Œè¿™ç±»å˜é‡ç§°ä¸ºå¯„å­˜å™¨å˜é‡(å› ä¸ºä¸åœ¨å†…å­˜ä¸­ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨&amp;å–åœ°å€ã€‚) åˆå§‹åŒ– é™æ€å˜é‡ é™æ€å˜é‡çš„åˆå§‹åŒ–ä¸­ï¼Œå¯ä»¥æŠŠå¯æ‰§è¡Œç¨‹åºæ–‡ä»¶æƒ³è¦åˆå§‹åŒ–çš„å€¼æ”¾åœ¨å½“ç¨‹åºæ‰§è¡Œæ—¶å˜é‡å°†ä¼šä½¿ç”¨çš„ä½ç½®ã€‚å½“å¯æ‰§è¡Œæ–‡ä»¶è½½å…¥åˆ°å†…å­˜æ—¶ï¼Œè¿™ä¸ªå·²ç»ä¿å­˜äº†æ­£ç¡®åˆå§‹å€¼çš„ä½ç½®å°†èµ‹å€¼ç»™é‚£ä¸ªå˜é‡ã€‚å®Œæˆè¿™ä¸ªä»»åŠ¡å¹¶ä¸éœ€è¦é¢å¤–æ—¶é—´ï¼Œä¹Ÿä¸éœ€è¦é¢å¤–æŒ‡ä»¤ï¼Œå˜é‡å°†ä¼šå¾—åˆ°æ­£ç¡®çš„å€¼ã€‚å¦‚æœä¸æ˜¾å¼çš„æŒ‡å®šå…¶åˆå§‹å€¼ï¼Œé™æ€å˜é‡å°†åˆå§‹åŒ–ä¸º0ã€‚ è‡ªåŠ¨å˜é‡ è‡ªåŠ¨å˜é‡åˆå§‹åŒ–éœ€è¦æ›´å¤šçš„å¼€é”€ï¼Œå› ä¸ºå½“ç¨‹åºé“¾æ¥æ—¶è¿˜æ— æ³•åˆ¤æ–­è‡ªåŠ¨å˜é‡çš„å­˜å‚¨ä½ç½®ã€‚ ç¬¬å…­ç«  æŒ‡é’ˆ6.14 æ€»ç»“å£°æ˜ä¸€ä¸ªæŒ‡é’ˆå˜é‡å¹¶ä¸ä¼šè‡ªåŠ¨åˆ†é…ä»»ä½•å†…å­˜ã€‚ ç¬¬ä¸ƒç«  å‡½æ•°int* find_int(int key, int arr[], int length); è¿™ç§å£°æ˜æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯ç”¨å•ç‹¬çš„ä¸€è¡Œç»™å‡ºå‚æ•°çš„ç±»å‹ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å°±åªè®°ä½å‡½æ•°è¿”å›å€¼çš„ç±»å‹ï¼Œä¸ä¿å­˜å‡½æ•°çš„å‚æ•°æ•°é‡å’Œç±»å‹ä¿¡æ¯ã€‚ int func(); è¿™ç§å£°æ˜ä¼šè¢«è§£é‡Šä¸ºæ—§å¼é£æ ¼çš„å£°æ˜ï¼Œåªä¿å­˜äº†å‡½æ•°çš„è¿”å›å€¼ç±»å‹ã€‚ int func(void); ä½¿ç”¨æ–°é£æ ¼åŸå‹æ—¶ï¼Œå¾—åŠ ä¸Švoidæç¤ºæ²¡æœ‰ä»»ä½•å‚æ•°7.3 å‡½æ•°çš„å‚æ•°Cå‡½æ•°çš„æ‰€æœ‰å‚æ•°å‡ä»¥â€œå€¼ä¼ é€’è°ƒç”¨â€æ–¹å¼è¿›è¡Œä¼ é€’ã€‚(å‚æ•°ä¸ºæŒ‡é’ˆæ—¶ä¹Ÿä¼šå‘ç”Ÿå€¼æ‹·è´ï¼Œæ‹·è´åœ°å€) 7.6 å¯å˜å‚æ•°åˆ—è¡¨7.6.1 stdargå®ç¬¬å…«ç«  æ•°ç»„ ä¸‹æ ‡ï¼šä¸ºäº†å¯¹ä¸‹æ ‡è¡¨è¾¾å¼æ±‚å€¼ï¼Œç¼–è¯‘å™¨åœ¨ç¨‹åºä¸­æ’å…¥æŒ‡ä»¤ï¼Œå–å¾—açš„å€¼ï¼Œå¹¶æŠŠå®ƒä¸æ•´å½¢çš„é•¿åº¦(ä¹Ÿå°±æ˜¯4)ç›¸ä¹˜ï¼Œè¿™ä¸ªä¹˜æ³•éœ€è¦èŠ±è´¹ä¸€å®šçš„æ—¶é—´å’Œç©ºé—´ã€‚ æŒ‡é’ˆï¼šå°½ç®¡ä¸å­˜åœ¨ä¸‹æ ‡ï¼Œä½†è¿˜æ˜¯å­˜åœ¨ä¹˜æ³•è¿ç®—ï¼Œ1è¿™ä¸ªå€¼å¿…é¡»å’Œæ•´æ•°çš„é•¿åº¦ç›¸ä¹˜ï¼Œç„¶åå†ä¸æŒ‡é’ˆç›¸åŠ ã€‚ä½†æ˜¯è¿™é‡Œå­˜åœ¨ä¸€ä¸ªé‡å¤§åŒºåˆ«ï¼šå¾ªç¯æ¯æ¬¡æ‰§è¡Œæ—¶ï¼Œæ‰§è¡Œä¹˜æ³•çš„è¿ç®—éƒ½æ˜¯ä¸¤ä¸ªç›¸åŒçš„æ•°(1å’Œ4)ã€‚ç»“æœï¼Œè¿™ä¸ªä¹˜æ³•åªåœ¨ç¼–è¯‘æ—¶æ‰§è¡Œä¸€æ¬¡â€”-ç¨‹åºç°åœ¨åŒ…å«äº†ä¸€æ¡æŒ‡ä»¤ï¼ŒæŠŠ4ä¸æŒ‡é’ˆç›¸åŠ ã€‚ç¨‹åºåœ¨æ‰§è¡Œæ—¶å¹¶ä¸æ‰§è¡Œä¹˜æ³•è¿ç®—ã€‚ int main() { int arr[100] = { 0 }, *ap; for (int i = 0; i &lt; 100; ++i) { // ä¸‹æ ‡ arr[i] = 0; } for (ap = arr; ap &lt; arr+10; ++ap) { // æŒ‡é’ˆ *ap = 0; } return 0; } 8.1 ä¸€ç»´æ•°ç»„8.1.1 æ•°ç»„åint a; // æ ‡é‡ int b[10]; // é›†åˆï¼Œç§°ä¸ºæ•°ç»„ æ•°æ®åæ˜¯å¸¸é‡æŒ‡é’ˆã€‚ æ•°ç»„ååœ¨ä¸¤ç§æƒ…å†µä¸‹è¡¨ç¤ºæ•´ä¸ªæ•°ç»„ï¼Œå…¶ä½™ä¸€å¾‹è¡¨ç¤ºé¦–å…ƒç´ ã€‚ int arr[10]; sizeof(arr); &amp;arr;8.1.2 ä¸‹æ ‡å¼•ç”¨æ•°ç»„ä¸‹æ ‡å¼•ç”¨å’Œé—´æ¥è®¿é—®å®Œå…¨ç›¸åŒã€‚ Cæ£€æŸ¥ä¸‹æ ‡æ‰€æ¶‰åŠçš„å¼€é”€æ¯”ä½ æƒ³è±¡çš„å¤§å¾—å¤šã€‚ç¼–è¯‘å™¨å¿…é¡»åœ¨ç¨‹åºä¸­æ’å…¥æŒ‡ä»¤ï¼Œè¯å®ä¸‹æ ‡è¡¨è¾¾å¼çš„ç»“æœæ‰€å¼•ç”¨çš„å…ƒç´ å’ŒæŒ‡é’ˆè¡¨è¾¾å¼æ‰€æŒ‡å‘çš„å…ƒç´ å±äºåŒä¸€æ•°ç»„ã€‚è¿™ä¸ªæ¯”è¾ƒæ“ä½œéœ€è¦ç¨‹åºä¸­æ‰€æœ‰æ•°ç»„çš„ä½ç½®å’Œé•¿åº¦æ–¹é¢çš„ä¿¡æ¯ã€‚è¿™å°†å ç”¨ä¸€äº›ç©ºé—´ã€‚å½“ç¨‹åºè¿è¡Œæ—¶ï¼Œè¿™äº›ä¿¡æ¯å¿…é¡»è¿›è¡Œæ›´æ–°ï¼Œä»¥åæ˜ è‡ªåŠ¨å’ŒåŠ¨æ€åˆ†é…çš„æ•°ç»„ï¼Œè¿™åˆå°†å ç”¨ä¸€å®šçš„æ—¶é—´ã€‚ 8.1.3 æŒ‡é’ˆä¸ä¸‹æ ‡int main(){ int arr1[10],a; for ( a = 0; a &lt; 10; ++a) { arr1[a] = 0; } return 0; } ä¸ºäº†å¯¹ä¸‹æ ‡è¡¨è¾¾å¼æ±‚å€¼ï¼Œç¼–è¯‘å™¨åœ¨ç¨‹åºä¸­æ’å…¥æŒ‡ä»¤ï¼Œå–å¾—açš„å€¼ï¼Œå¹¶æŠŠå®ƒä¸æ•´å½¢çš„é•¿åº¦(4)ç›¸ä¹˜ã€‚è¿™ä¸ªä¹˜æ³•éœ€è¦èŠ±è´¹ä¸€å®šçš„ç©ºé—´å’Œæ—¶é—´ã€‚ int main(){ int arr2[10],*ap; for (ap=arr2; ap &lt; arr2; ++ap) { *ap = 0; } return 0; } è¿™é‡Œçš„ä¹˜æ³•è¿ç®—å‡ºç°åœ¨forè¯­å¥çš„è°ƒæ•´éƒ¨åˆ†(++ap)ï¼Œ1è¿™ä¸ªå€¼å¿…é¡»ä¸æ•´å½¢çš„é•¿åº¦ç›¸ä¹˜ï¼Œç„¶åå†ä¸æŒ‡é’ˆç›¸åŠ ã€‚ä½†æ˜¯è¿™é‡Œå­˜åœ¨å¾ˆå¤§çš„åŒºåˆ«ï¼šå¾ªç¯æ¯æ¬¡æ‰§è¡Œæ—¶ï¼Œæ‰§è¡Œä¹˜æ³•è¿ç®—çš„éƒ½æ˜¯ä¸¤ä¸ªç›¸åŒçš„æ•°(1å’Œ4)ã€‚ç»“æœè¿™ä¸ªä¹˜æ³•åªä¼šåœ¨ç¼–è¯‘æ—¶æ‰§è¡Œä¸€æ¬¡â€”-ç¨‹åºåŒ…å«ä¸€æ¡æŒ‡ä»¤ï¼ŒæŠŠ4ä¸æŒ‡é’ˆç›¸åŠ ã€‚ç¨‹åºåœ¨è¿è¡Œæ—¶å¹¶ä¸æ‰§è¡Œä¹˜æ³•è¿ç®—ã€‚ 8.1.4 æŒ‡é’ˆçš„æ•ˆç‡8.1.5 æŒ‡é’ˆå’Œæ•°ç»„æ•°ç»„å’ŒæŒ‡é’ˆä¸ç›¸ç­‰ã€‚ int a[5]; int *p; å£°æ˜ä¸€ä¸ªæ•°ç»„æ—¶ï¼Œç¼–è¯‘å™¨å°†æ ¹æ®å£°æ˜æ‰€æŒ‡å®šçš„å…ƒç´ æ•°é‡ä¸ºæ•°ç»„ä¿å­˜å†…å­˜ç©ºé—´ï¼Œç„¶ååˆ›å»ºæ•°ç»„åï¼Œå®ƒçš„å€¼æ˜¯ä¸€ä¸ªå¸¸é‡ï¼ŒæŒ‡å‘è¿™æ®µç©ºé—´çš„èµ·å§‹ä½ç½®ã€‚ å£°æ˜ä¸€ä¸ªæŒ‡é’ˆå˜é‡æ—¶ï¼Œç¼–è¯‘å™¨åªä¸ºæŒ‡é’ˆæœ¬èº«ä¿ç•™å†…å­˜ç©ºé—´ï¼Œå®ƒå¹¶ä¸ä¸ºä»»ä½•æ•´å½¢å€¼åˆ†é…å†…å­˜ç©ºé—´ã€‚è€Œä¸”æŒ‡é’ˆå˜é‡å¹¶æœªè¢«åˆå§‹åŒ–ä¸ºæŒ‡å‘ä»»ä½•ç°æœ‰çš„å†…å­˜ç©ºé—´ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªè‡ªåŠ¨å˜é‡ï¼Œå®ƒç”šè‡³ä¸ä¼šè¢«åˆå§‹åŒ–ã€‚ å› æ­¤ï¼š*aæ˜¯åˆæ³•çš„ã€‚*bå°†è®¿é—®å†…å­˜ä¸­æŸä¸ªä¸ç¡®å®šçš„ä½ç½®ï¼Œæˆ–è€…å¯¼è‡´ç¨‹åºç»ˆæ­¢ã€‚ä½†æ˜¯b++å¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Œa++ç¼ºä¸è¡Œï¼Œå› ä¸ºaæ˜¯ä¸€ä¸ªå¸¸é‡ã€‚ 8.1.6 ä½œä¸ºå‡½æ•°å‚æ•°çš„æ•°ç»„åä¸€ä¸ªæ•°ç»„åä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°ï¼šåœ¨å‡½æ•°ä¼ å‚æ—¶å°±ä¼šå‘ç”Ÿæ‹·è´ã€‚å¯çŸ¥æ•°ç»„æ˜¯ä¸€ä¸ªåœ°å€å¸¸é‡ï¼Œåœ¨ä¼ å‚ç»™å‡½æ•°æ—¶ï¼Œå‘ç”Ÿåœ°å€æ‹·è´ï¼Œæ•°ç»„å(åœ°å€å¸¸é‡)ä¼ é€’ç»™å‡½æ•°çš„å½¢å‚ï¼Œå½¢å‚å®ä¾‹åŒ–æˆä¸€ä¸ªæŒ‡é’ˆå˜é‡ï¼ŒæŒ‡é’ˆå˜é‡å­˜æ”¾æ•°ç»„çš„åœ°å€å¸¸é‡ã€‚å› æ­¤æ•°ç»„åœ°å€ä¼ å…¥å‡½æ•°ä¹‹åï¼Œå‘ç”Ÿé™ç»´ï¼Œé™ç»´æˆä¸€ä¸ªæŒ‡é’ˆã€‚å‡½æ•°å¦‚æœæ‰§è¡Œäº†ä¸‹æ ‡åº”ç”¨ï¼Œå®é™…å±±æ˜¯å¯¹è¿™ä¸ªæŒ‡é’ˆè¿›è¡Œé—´æ¥è®¿é—®æ“ä½œï¼Œå¹¶ä¸”é€šè¿‡è¿™ç§é—´æ¥è®¿é—®ï¼Œå‡½æ•°å¯ä»¥è®¿é—®å’Œä¿®æ”¹è°ƒç”¨ç¨‹åºçš„æ•°ç»„å…ƒç´ ã€‚ 8.1.7 å£°æ˜æ•°ç»„å‚æ•°int strlen(char *string); int strlen(char string[]);8.1.8 åˆå§‹åŒ–char message1[] = &quot;Hello&quot;; char *message2 = &quot;Hello&quot;; 8.2.3 ä¸‹æ ‡int matrix[3][10]; matrix martrixæ­¤æ—¶æŒ‡å‘ç¬¬ä¸€ä¸ªäºŒç»´æ•°ç»„ matrix+1 *(matrix+1) *(matrix+1)+5 8.5 æ€»ç»“ åœ¨ç»å¤§å¤šæ•°è¡¨è¾¾å¼ä¸­ï¼Œæ•°ç»„åæ˜¯æŒ‡å‘æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆã€‚åªæœ‰ä¸¤ä¸ªè§„åˆ™ä¾‹å¤–ï¼š sizeof(arr)ï¼Œè¿”å›æ•´ä¸ªæ•°ç»„å ç”¨çš„å­—èŠ‚ï¼Œè€Œä¸æ˜¯è¿”å›æŒ‡é’ˆå ç”¨çš„å­—èŠ‚ã€‚ &amp;arrï¼Œå•ç›®æ“ä½œç¬¦&amp;è¿”å›ä¸€ä¸ªæŒ‡å‘æ•´ä¸ªæ•°ç»„çš„æŒ‡é’ˆï¼Œè€Œä¸æ˜¯æŒ‡å‘æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆçš„æŒ‡é’ˆã€‚ æŒ‡é’ˆå’Œæ•°ç»„ä¸ç›¸ç­‰ã€‚ å£°æ˜ä¸€ä¸ªæ•°ç»„ï¼ŒåŒæ—¶ä¹Ÿåˆ†é…äº†ä¸€äº›å†…å­˜ï¼Œç”¨äºå®¹çº³æ•°ç»„å…ƒç´ ã€‚ å£°æ˜ä¸€ä¸ªæŒ‡é’ˆï¼Œåªåˆ†é…ç”¨äºå®¹çº³æŒ‡é’ˆæœ¬èº«çš„ç©ºé—´ã€‚ å½“æ•°ç»„åä½œä¸ºå‡½æ•°å‚æ•°ä¼ é€’ã€‚å®é™…ä¼ é€’çš„æ˜¯ä¸€ä¸ªæŒ‡å‘æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆã€‚å‡½æ•°æ‰€æ¥æ”¶åˆ°çš„å‚æ•°å®é™…ä¸Šæ˜¯åŸå‚æ•°çš„ä¸€ä»½æ‹·è´ï¼Œæ‰€ä»¥å‡½æ•°å¯ä»¥å¯¹å…¶è¿›è¡Œæ“çºµè€Œä¸å½±å“å®é™…çš„å‚æ•°ã€‚ä½†æ˜¯å¯¹æŒ‡é’ˆæ‰§è¡Œé—´æ¥è®¿é—®æ“ä½œå…è®¸å‡½æ•°ä¿®æ”¹åŸå…ˆæ•°ç»„çš„å…ƒç´ ã€‚ æ•°ç»„å½¢å‚æ—¢å¯ä»¥å£°æ˜æˆæ•°ç»„ä¹Ÿå¯ä»¥å£°æ˜æˆæŒ‡é’ˆï¼Œè¿™ä¸¤ç§å£°æ˜å½¢å¼åªæœ‰å½“ä»–ä»¬ä½œä¸ºå‡½æ•°å½¢å‚æ—¶æ‰ç›¸ç­‰ã€‚ ç¬¬ä¹ç«  å­—ç¬¦ä¸²ã€å­—ç¬¦å’Œå­—èŠ‚9.1 å­—ç¬¦ä¸²åŸºç¡€å­—ç¬¦ä¸²æ˜¯ä¸€ä¸²é›¶ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ï¼Œä»¥NULç»“å°¾ã€‚ 9.3 ä¸å—é™åˆ¶çš„å­—ç¬¦ä¸²å‡½æ•°9.3.1 å¤åˆ¶å­—ç¬¦ä¸²char *strcpy(char *dst, char const *src); #include &lt;stdio.h&gt; #include &lt;string.h&gt; int main() { char dest[] = &quot;abcde&quot;; strcpy(dest,&quot;xyz&quot;); printf(&quot;%s\\n&quot;,dest); // xyz return 0; } ç›®æ ‡å‚æ•°ä»¥å‰çš„å†…å®¹å°†è¢«è¦†ç›–ï¼Œå³ä½¿æ–°çš„å­—ç¬¦ä¸²æ¯”deståŸå…ˆçš„å†…å­˜æ›´çŸ­ã€‚(NULä¹Ÿä¼šè¢«å¤åˆ¶) 9.3.2 è¿æ¥å­—ç¬¦ä¸²char * strcat(char *dst, char const *src); #include &lt;stdio.h&gt; #include &lt;string.h&gt; int main() { char message[100] = {0}; strcat(message,&quot;hello&quot;); strcat(message,&quot; world&quot;); printf(&quot;%s\\n&quot;,message); return 0; } 9.3.3 å‡½æ•°çš„è¿”å›å€¼ã€‚strcpyå’Œstrcatéƒ½è¿”å›å®ƒä»¬ç¬¬ä¸€ä¸ªå‚æ•°çš„ä¸€ä»½æ‹·è´ï¼Œå°±æ˜¯æŒ‡å‘ç›®æ ‡å­—ç¬¦æ•°ç»„çš„æŒ‡é’ˆã€‚ 9.3.4 å­—ç¬¦ä¸²æ¯”è¾ƒint strcmp(char const *s1, char const *s2); int main() { int ret = strcmp(&quot;duwei&quot;,&quot;zhangsan&quot;); /* if (ret){ // retçš„å€¼æœ‰ä¸‰ç§æƒ…å†µï¼šå¤§äº0ï¼Œç­‰äº0ï¼Œå°äº0ã€‚å°†å…¶ç”¨boolå€¼è¡¨è¾¾æ˜¯ä¸€ç§åé£æ ¼ï¼Œæ­£ç¡®çš„æ–¹å¼æ˜¯å°†å…¶ä¸0å€¼è¿›è¡Œæ¯”è¾ƒ printf(&quot;duwei &gt; zhangsan&quot;); } */ if (ret &gt; 0){ printf(&quot;duwei &gt; zhangsan&quot;); } return 0; }9.5 å­—ç¬¦ä¸²æŸ¥æ‰¾9.5.1 æŸ¥æ‰¾ä¸€ä¸ªå­—ç¬¦#include &lt;stdio.h&gt; #include &lt;string.h&gt; int main() { char message[] = &quot;learn C language.&quot;; char *p1 = strchr(message,&#39;a&#39;); // è¿”å›ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½® printf(&quot;p1 - message = %lu\\n&quot;,p1-message); char *p2 = strrchr(message, &#39;a&#39;); // è¿”å›æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½® printf(&quot;p2 - message = %lu\\n&quot;,p2-message); return 0; } 9.5.2 æŸ¥æ‰¾ä»»ä½•å‡ ä¸ªå­—ç¬¦char *strpbrk(char const *str, char const *group); æŸ¥æ‰¾ä¸€ç»„å­—ç¬¦ä¸²åœ¨å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚ #include &lt;stdio.h&gt; #include &lt;string.h&gt; int main() { char message[] = &quot;learn C language.&quot;; char *p = strpbrk(message,&quot;zC&quot;); // è¿”å›zæˆ–è€…Cç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œ printf(&quot;%s\\n&quot;,p); return 0; } 9.5.3 æŸ¥æ‰¾ä¸€ä¸ªå­ä¸²char *strstr(char const *s1, char const *s2); #include &lt;stdio.h&gt; #include &lt;string.h&gt; int main() { char message[] = &quot;learn C language.&quot;; char *p = strstr(message,&quot;lang&quot;); printf(&quot;%s\\n&quot;,p); return 0; } 9.9 å†…å­˜æ“ä½œ","categories":[{"name":"Cè¯­è¨€","slug":"Cè¯­è¨€","permalink":"http://blog.3amupupup.online/categories/C%E8%AF%AD%E8%A8%80/"}],"tags":[{"name":"book","slug":"book","permalink":"http://blog.3amupupup.online/tags/book/"}]},{"title":"nginxå†…å­˜æ± ","slug":"ngx_mem_pool","date":"2021-03-18T03:09:52.065Z","updated":"2021-03-18T03:09:52.065Z","comments":true,"path":"2021/03/18/ngx_mem_pool/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/ngx_mem_pool/","excerpt":"","text":"nginxå†…å­˜æ± å†…å­˜æ± çš„æ•°æ®ç»“æ„ // src/core/ngx_palloc.h typedef struct { u_char *last; /* å†…å­˜æ± ä¸­æœªä½¿ç”¨å†…å­˜çš„å¼€å§‹èŠ‚ç‚¹åœ°å€ */ u_char *end; /* å†…å­˜æ± çš„ç»“æŸåœ°å€ */ ngx_pool_t *next; /* æŒ‡å‘ä¸‹ä¸€ä¸ªå†…å­˜æ± ,ç»„æˆé“¾è¡¨ */ ngx_uint_t failed; /* å¤±è´¥æ¬¡æ•° */ } ngx_pool_data_t; // typedef struct ngx_pool_s ngx_pool_t; struct ngx_pool_s { ngx_pool_data_t d; /* å†…å­˜æ± çš„æ•°æ®åŒºåŸŸ(å°å—æ•°æ®) */ size_t max; /* æœ€å¤§æ¯æ¬¡å¯åˆ†é…å†…å­˜,å¤§äºè¿™ä¸ªå€¼å°†è¢«æ·»åŠ åˆ°å¤§å—æ•°æ®é“¾è¡¨ä¸Š,å°äºè¿™ä¸ªå€¼å°†è¢«æ·»åŠ åˆ°å°å—æ•°æ®é“¾è¡¨ä¸Š */ ngx_pool_t *current; /* æŒ‡å‘å½“å‰çš„å†…å­˜æ± æŒ‡é’ˆåœ°å€ã€‚ngx_pool_té“¾è¡¨ä¸Šæœ€åä¸€ä¸ªç¼“å­˜æ± ç»“æ„ */ ngx_chain_t *chain; /* ç¼“å†²åŒºé“¾è¡¨ */ ngx_pool_large_t *large; /* å­˜å‚¨å¤§å—æ•°æ®çš„é“¾è¡¨ */ ngx_pool_cleanup_t *cleanup; /* å¯è‡ªå®šä¹‰å›è°ƒå‡½æ•°ï¼Œæ¸…é™¤å†…å­˜å—åˆ†é…çš„å†…å­˜ */ ngx_log_t *log; /* æ—¥å¿— */ }; // typedef struct ngx_pool_cleanup_s ngx_pool_cleanup_t; struct ngx_pool_cleanup_s { ngx_pool_cleanup_pt handler; /* æ¸…ç†çš„å›è°ƒå‡½æ•° */ void *data; /* æŒ‡å‘å­˜å‚¨çš„æ•°æ®åœ°å€ */ ngx_pool_cleanup_t *next; /* ä¸‹ä¸€ä¸ªngx_pool_cleanup_t */ }; // src/os/unix/ngx_alloc.c // ä¸¤ç§ç”³è¯·å†…å­˜æ¥å£ void * ngx_alloc(size_t size, ngx_log_t *log) { void *p; p = malloc(size); // è°ƒç”¨mallocåˆ†é…å†…å­˜ if (p == NULL) { // æ£€æµ‹æ˜¯å¦åˆ†é…æˆåŠŸ ngx_log_error(NGX_LOG_EMERG, log, ngx_errno, &quot;malloc(%uz) failed&quot;, size); } ngx_log_debug2(NGX_LOG_DEBUG_ALLOC, log, 0, &quot;malloc: %p:%uz&quot;, p, size); return p; } void * ngx_calloc(size_t size, ngx_log_t *log) { void *p; p = ngx_alloc(size, log); // è¿˜æ˜¯è°ƒç”¨ngx_allocåˆ†é…çš„å†…å­˜ if (p) { ngx_memzero(p, size); // å¦‚æœåˆ†é…æˆåŠŸåˆ™å°†å†…å­˜å—å…¨éƒ¨åˆå§‹åŒ–ä¸º0ï¼Œåº•å±‚è°ƒç”¨çš„memesetåº“å‡½æ•° } return p; } /* ngx_callocå’Œngx_allocçš„åŒºåˆ«åœ¨äºï¼šngx_callocä¼šå°†åˆ†é…çš„å†…å­˜åˆå§‹åŒ–ä¸ºé›¶å€¼ï¼Œngx_allocåªåˆ†é…ä¸åˆå§‹åŒ–ã€‚ */ // src/core/ngx_palloc.c // åˆ›å»ºå†…å­˜æ± çš„å‡½æ•° // typedef struct ngx_pool_s ngx_pool_t; ngx_pool_t * ngx_create_pool(size_t size, ngx_log_t *log) { ngx_pool_t *p; // å£°æ˜ä¸€ä¸ªngx_pool_tç±»å‹çš„æŒ‡é’ˆå˜é‡ç”¨äºä¿å­˜ç”³è¯·çš„å†…å­˜çš„åœ°å€ p = ngx_memalign(NGX_POOL_ALIGNMENT, size, log); // è¿™ä¸ªå‡½æ•°æš‚æ—¶è·³è¿‡ï¼ŒåŠŸèƒ½å°±æ˜¯åˆ†é…sizeå¤§å°çš„å†…å­˜ if (p == NULL) { // æ£€æµ‹æ˜¯å¦åˆ†é…æˆåŠŸ return NULL; } p-&gt;d.last = (u_char *) p + sizeof(ngx_pool_t); // pæ˜¯è¿™å—å†…å­˜çš„é¦–åœ°å€ï¼ŒåŠ ä¸Šngx_pool_tè¿™ä¸ªç»“æ„ä½“çš„å†…å­˜å¤§å°ä¹‹åï¼Œæ­¤æ—¶çš„lastæŒ‡å‘çš„æ˜¯å¯ç”¨å†…å­˜çš„èµ·å§‹ä½ç½®(åˆ†é…sizeå¤§å°çš„å†…å­˜ä¹‹åï¼Œå‰sizeof(ngx_pool_t)ä¸ªå­—èŠ‚çš„å†…å­˜è¢«è¿™ä¸ªç»“æ„ä½“é‡Œå…ƒç´ å ç”¨äº†ï¼ŒlastæŒ‡å‘çš„æ˜¯è¿™äº›å…ƒç´ çš„æœ«å°¾ï¼Œè¿™ä¹‹åçš„å†…å­˜å­—èŠ‚ä¸€ç›´åˆ°endéƒ½æ˜¯å¯ä»¥è¢«ä½¿ç”¨çš„ï¼Œä¹Ÿå°±æœ‰size-sizeof(ngx_pool_t)ä¸ªå­—èŠ‚æ—¶èƒ½å¤Ÿè¢«ç”³è¯·è€…è‡ªå®šä¹‰ä½¿ç”¨çš„)ã€‚ p-&gt;d.end = (u_char *) p + size; // å†…å­˜ä½¿ç”¨èŒƒå›´çš„ç»“æŸåœ°å€ p-&gt;d.next = NULL; // nextæŒ‡å‘NULLï¼Œé¿å…é‡æŒ‡é’ˆ p-&gt;d.failed = 0; // å¤±è´¥æ¬¡æ•°çš„ä»0å¼€å§‹è®¡æ•° size = size - sizeof(ngx_pool_t); // æ­¤æ—¶sizeè¦å‡å»sizeof(ngx_pool_t) p-&gt;max = (size &lt; NGX_MAX_ALLOC_FROM_POOL) ? size : NGX_MAX_ALLOC_FROM_POOL; /* * NGX_MAX_ALLOC_FROM_POOL should be (ngx_pagesize - 1), i.e. 4095 on x86. * On Windows NT it decreases a number of locked pages in a kernel. */ // åªæœ‰ç¼“å­˜æ± çš„çˆ¶èŠ‚ç‚¹ï¼Œæ‰ä¼šç”¨åˆ°ä¸‹é¢çš„è¿™äº› ï¼Œå­èŠ‚ç‚¹åªæŒ‚è½½åœ¨p-&gt;d.next,å¹¶ä¸”åªè´Ÿè´£p-&gt;dçš„æ•°æ®å†…å®¹ p-&gt;current = p; p-&gt;chain = NULL; p-&gt;large = NULL; p-&gt;cleanup = NULL; p-&gt;log = log; return p; } // é”€æ¯å†…å­˜æ±  void ngx_destroy_pool(ngx_pool_t *pool) { ngx_pool_t *p, *n; ngx_pool_large_t *l; ngx_pool_cleanup_t *c; for (c = pool-&gt;cleanup; c; c = c-&gt;next) { // éå†é“¾è¡¨ï¼Œè°ƒç”¨å¯¹åº”çš„handlerå›æ”¶dataæ‰€æŒ‡å‘çš„å†…å­˜ if (c-&gt;handler) { ngx_log_debug1(NGX_LOG_DEBUG_ALLOC, pool-&gt;log, 0, &quot;run cleanup: %p&quot;, c); c-&gt;handler(c-&gt;data); // å›æ”¶ } } #if (NGX_DEBUG) // æ¡ä»¶ç¼–è¯‘ï¼Œå¦‚æœå¼€å¯äº†ngx_debugæ¨¡å¼åˆ™åœ¨é”€æ¯å†…å­˜æ—¶åº”è¯¥è®°å½•æ—¥å¿— /* * we could allocate the pool-&gt;log from this pool * so we cannot use this log while free()ing the pool */ for (l = pool-&gt;large; l; l = l-&gt;next) { ngx_log_debug1(NGX_LOG_DEBUG_ALLOC, pool-&gt;log, 0, &quot;free: %p&quot;, l-&gt;alloc); } for (p = pool, n = pool-&gt;d.next; /* void */; p = n, n = n-&gt;d.next) { ngx_log_debug2(NGX_LOG_DEBUG_ALLOC, pool-&gt;log, 0, &quot;free: %p, unused: %uz&quot;, p, p-&gt;d.end - p-&gt;d.last); if (n == NULL) { break; } } #endif for (l = pool-&gt;large; l; l = l-&gt;next) { // éå†å¤§å—æ•°æ®é“¾è¡¨ï¼Œé‡Šæ”¾å†…å­˜ if (l-&gt;alloc) { ngx_free(l-&gt;alloc); // #define ngx_free free,å°±æ˜¯è°ƒç”¨çš„freeï¼Œæ˜¯ä¸ªå®ï¼Œngx_alloc.h } } for (p = pool, n = pool-&gt;d.next; /* void */; p = n, n = n-&gt;d.next) { // éå†å°å—æ•°æ®é“¾è¡¨ï¼Œé‡Šæ”¾å†…å­˜ ngx_free(p); // // #define ngx_free freeï¼Œngx_alloc.h if (n == NULL) { break; } } } // é‡ç½®å†…å­˜æ± (é‡Šæ”¾æ“ä½œ) void ngx_reset_pool(ngx_pool_t *pool) { ngx_pool_t *p; ngx_pool_large_t *l; for (l = pool-&gt;large; l; l = l-&gt;next) { // æ¸…ç†æ‰å¤§å—æ•°æ®é“¾è¡¨ if (l-&gt;alloc) { ngx_free(l-&gt;alloc); // #define ngx_free free,å°±æ˜¯è°ƒç”¨çš„freeï¼Œæ˜¯ä¸ªå®ï¼Œngx_alloc.h } } for (p = pool; p; p = p-&gt;d.next) { // é‡ç½®lastçš„æŒ‡å‘ï¼Œæ¢å¤åˆ°lastçš„èµ·å§‹ä½ç½®(è¿™ä¸ªè¿‡ç¨‹å¹¶æ²¡æœ‰æ“¦é™¤å†…å­˜åŒºåŸŸä¸Šçš„æ•°æ®)ï¼Œä¸‹æ¬¡ç›´æ¥ä½¿ç”¨å³å¯ï¼Œæ›´ä¸ç”¨è¿˜ç»™æ“ä½œç³»ç»Ÿï¼Œé¿å…é¢‘ç¹mallocå’Œfree p-&gt;d.last = (u_char *) p + sizeof(ngx_pool_t); p-&gt;d.failed = 0; } pool-&gt;current = pool; pool-&gt;chain = NULL; // å†…å­˜æ± çˆ¶ç»“ç‚¹çš„ç¼“å­˜ã€å¤§å—æ•°æ®é“¾è¡¨ç½®ç©º pool-&gt;large = NULL; } // ngxåˆ†é…å¤§å—æ•°æ®å†…å­˜çš„å‡½æ•° void * ngx_palloc(ngx_pool_t *pool, size_t size) { #if !(NGX_DEBUG_PALLOC) // æ¡ä»¶ç¼–è¯‘ if (size &lt;= pool-&gt;max) { // å¦‚æœè¦åˆ†é…çš„å†…å­˜sizeå°äºå†…å­˜æ± çš„æœ€å¤§maxï¼Œåˆ™èµ°åˆ†é…å°å—æ•°æ®å†…å­˜çš„é€»è¾‘ return ngx_palloc_small(pool, size, 1); } #endif return ngx_palloc_large(pool, size); // åˆ†é…å¤§å†…å­˜å—ï¼ŒæŒ‚åœ¨å¤§å†…å­˜å—é“¾è¡¨ä¸Šå» } // åˆ†é…å°å†…å­˜å—çš„é€»è¾‘ // å…ˆéå†å°å—æ•°æ®å†…å­˜çš„é“¾è¡¨ï¼Œå¦‚æœæ‰¾åˆ°åˆé€‚çš„åˆ™å°†å…¶ç»“ç‚¹ä¸Šçš„lastå¾€åç§»åŠ¨sizeä¸ªå­—èŠ‚ï¼Œå†å°†lastçš„åŸæœ¬ä½ç½®çš„å†…å­˜åœ°å€è¿”å›ï¼Œå¦‚æœæ²¡æœ‰åˆé€‚çš„ç»“ç‚¹ï¼Œåˆ™èµ°æ‰©å®¹çš„é€»è¾‘ static ngx_inline void * ngx_palloc_small(ngx_pool_t *pool, size_t size, ngx_uint_t align) { u_char *m; ngx_pool_t *p; p = pool-&gt;current; do { // å¾ªç¯è¯»å–p-&gt;d.nextçš„å„ä¸ªngx_pool_tç»“ç‚¹ï¼Œæ‰¾åˆ°å‰©ä½™ç©ºé—´å¤§äºsizeçš„ç»“ç‚¹å¹¶è¿”å›åœ°å€ m = p-&gt;d.last; if (align) { m = ngx_align_ptr(m, NGX_ALIGNMENT); } if ((size_t) (p-&gt;d.end - m) &gt;= size) { // å¦‚æœæ•°æ®åŒºä¸Šå¯ç”¨çš„å†…å­˜æ‰“å°å¤§äºè°ƒç”¨è€…ä¼ å…¥çš„size p-&gt;d.last = m + size; // ç§»åŠ¨last sizeä¸ªå­—èŠ‚ return m; // må°±æ˜¯åˆ†é…å‡ºå»çš„è¿™å—å†…å­˜çš„èµ·å§‹åœ°å€ } p = p-&gt;d.next; } while (p); return ngx_palloc_block(pool, size); // å¦‚æœæ²¡æ‰¾åˆ°èƒ½å®¹çº³sizeçš„ç»“ç‚¹åˆ™æ–°ç”³è¯·ä¸€ä¸ªæ± å­ç»“ç‚¹ï¼Œèµ°æ‰©å®¹çš„é€»è¾‘ } // åˆ†é…å¤§æ•°æ®å—å†…å­˜é€»è¾‘ static void * ngx_palloc_large(ngx_pool_t *pool, size_t size) { void *p; // ä¿å­˜åˆ†é…çš„å†…å­˜å—åœ°å€çš„æŒ‡é’ˆå˜é‡ ngx_uint_t n; ngx_pool_large_t *large; // å¤§å—æ•°æ®é“¾è¡¨ç»“ç‚¹çš„æŒ‡é’ˆå˜é‡ p = ngx_alloc(size, pool-&gt;log); // ç”³è¯·sizeå¤§å°çš„å†…å­˜å— if (p == NULL) { return NULL; } n = 0; for (large = pool-&gt;large; large; large = large-&gt;next) { // éå†å¤§å†…å­˜å—é“¾è¡¨ if (large-&gt;alloc == NULL) { // å°†æ–°èŠ‚ç‚¹æ·»åŠ åˆ°æœ«å°¾ä¸Šå» large-&gt;alloc = p; return p; } if (n++ &gt; 3) { // åªæŸ¥ä¸‰æ¬¡ï¼Œå¦åˆ™å°±ç»“æŸæ­¤æ“ä½œ break; } } large = ngx_palloc_small(pool, sizeof(ngx_pool_large_t), 1); if (large == NULL) { // å¦‚æœç”³è¯·å¤±è´¥åˆ™è¦æŠŠpé‡Šæ”¾æ‰é¿å…å†…å­˜æ³„éœ² ngx_free(p); return NULL; } large-&gt;alloc = p; large-&gt;next = pool-&gt;large; pool-&gt;large = large; return p; } // å†…å­˜æ± æ‰©å®¹ static void * ngx_palloc_block(ngx_pool_t *pool, size_t size) { u_char *m; size_t psize; ngx_pool_t *p, *new; psize = (size_t) (pool-&gt;d.end - (u_char *) pool); // endæŒ‡å‘ngx_pool_tæœ«å°¾ï¼Œpoolæ˜¯ngx_pool_té¦–åœ°å€ï¼Œæœ«å°¾åœ°å€å‡å»é¦–åœ°å€è½¬æ¢æˆsize_tå¾—åˆ°çš„å°±æ˜¯è¿™ä¸ªç»“æ„(ngx_pool_t)çš„size m = ngx_memalign(NGX_POOL_ALIGNMENT, psize, pool-&gt;log); // è°ƒç”¨posix_memalign()åˆ†é…å†…å­˜ if (m == NULL) { return NULL; } new = (ngx_pool_t *) m; // ç±»å‹è½¬æ¢ new-&gt;d.end = m + psize; // mæ˜¯é¦–åœ°å€ï¼Œpsizeæ˜¯ngx_pool_tçš„å¤§å°ï¼Œè¿™ä¸ªæ“ä½œæ—¶åœ¨åˆ†é…çš„å†…å­˜mä¸Šå–ä¸€ä¸ªngx_pool_tå¤§å°çš„å†…å­˜å— new-&gt;d.next = NULL; // ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘nullé¿å…é‡æŒ‡é’ˆ new-&gt;d.failed = 0; // å¤±è´¥æ¬¡æ•°åˆå§‹åŒ–0 m += sizeof(ngx_pool_data_t); m = ngx_align_ptr(m, NGX_ALIGNMENT); // æ²¡çœ‹æ‡‚ /* #define ngx_align_ptr(p, a) \\ (u_char *) (((uintptr_t) (p) + ((uintptr_t) a - 1)) &amp; ~((uintptr_t) a - 1)) */ new-&gt;d.last = m + size; // lastä¹‹åçš„sizeä¸ªå­—èŠ‚è¢«æ ‡è¯†å·²ç»åˆ†é…äº†ï¼Œä¹Ÿå°±æ˜¯æ­¤æ—¶ç”³è¯·çš„å†…å­˜å— for (p = pool-&gt;current; p-&gt;d.next; p = p-&gt;d.next) { if (p-&gt;d.failed++ &gt; 4) { pool-&gt;current = p-&gt;d.next; } } p-&gt;d.next = new;å°†æ­¤æ—¶çš„newæ·»åŠ åˆ°å°æ•°æ®é“¾è¡¨ä¸Šå» return m; } void * ngx_memalign(size_t alignment, size_t size, ngx_log_t *log) { void *p; int err; err = posix_memalign(&amp;p, alignment, size); // è°ƒç”¨posix_memalign( )æˆåŠŸæ—¶ä¼šè¿”å›sizeå­—èŠ‚çš„åŠ¨æ€å†…å­˜ï¼Œå¹¶ä¸”è¿™å—å†…å­˜çš„åœ°å€æ˜¯alignmentçš„å€æ•° if (err) { ngx_log_error(NGX_LOG_EMERG, log, err, &quot;posix_memalign(%uz, %uz) failed&quot;, alignment, size); p = NULL; } ngx_log_debug3(NGX_LOG_DEBUG_ALLOC, log, 0, &quot;posix_memalign: %p:%uz @%uz&quot;, p, size, alignment); return p; } // é‡Šæ”¾å†…å­˜ ngx_int_t ngx_pfree(ngx_pool_t *pool, void *p) { ngx_pool_large_t *l; for (l = pool-&gt;large; l; l = l-&gt;next) { if (p == l-&gt;alloc) { ngx_log_debug1(NGX_LOG_DEBUG_ALLOC, pool-&gt;log, 0, &quot;free: %p&quot;, l-&gt;alloc); ngx_free(l-&gt;alloc); // #define ngx_free free,å°±æ˜¯è°ƒç”¨çš„freeï¼Œæ˜¯ä¸ªå®ï¼Œngx_alloc.h l-&gt;alloc = NULL; return NGX_OK; } } return NGX_DECLINED; } // cleanupç»“æ„ ngx_pool_cleanup_t * ngx_pool_cleanup_add(ngx_pool_t *p, size_t size) { ngx_pool_cleanup_t *c; c = ngx_palloc(p, sizeof(ngx_pool_cleanup_t)); // åˆ†é…å†…å­˜æ“ä½œ if (c == NULL) { // æ£€æµ‹æ˜¯å¦åˆ†é…å¤±è´¥ return NULL; } if (size) { c-&gt;data = ngx_palloc(p, size); // å†æ¬¡è¯´ä¸‹è¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½ï¼šè¿™ä¸ªå‡½æ•°å®é™…ä¸Šæ˜¯æ ¹æ®sizeçš„å¤§å°(ä¸maxæ¯”è¾ƒ)è°ƒç”¨ngx_palloc_smallæˆ–è€…ngx_palloc_largeï¼Œå› æ­¤åˆ†é…çš„å†…å­˜å­˜åœ¨äºå°æ•°æ®å†…å­˜å—é“¾è¡¨ä¸Šæˆ–è€…å¤§æ•°æ®å†…å­˜å—é“¾è¡¨ä¸Šï¼Œè€Œcleanupç»“ç‚¹ä¸­dataä¿å­˜çš„æ˜¯åˆ†é…çš„å†…å­˜çš„åœ°å€ï¼Œæ¬¡ç»“ç‚¹ä¸Šè¿˜æœ‰ä¸€ä¸ªhandlerå›è°ƒå‡½æ•°ï¼Œä¾¿äºæˆ‘ä»¬è‡ªå®šä¹‰é‡Šæ”¾å†…å­˜çš„å‡½æ•°ï¼Œä½¿æˆ‘ä»¬æœ‰èƒ½åŠ›åœ¨å†…å­˜æ± ä¸Šä¿å­˜ä¸€äº›ç‰¹æ®Šçš„æ•°æ®ç±»å‹æˆ–è€…è‡ªå®šä¹‰æ•°æ®ç±»å‹å¹¶è‡ªå®šä¹‰å…¶é‡Šæ”¾çš„é€»è¾‘ if (c-&gt;data == NULL) { // æ£€æµ‹å¤±è´¥ä¸å¦ return NULL; } } else { c-&gt;data = NULL; } c-&gt;handler = NULL; // handleræ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œé»˜è®¤ç»™çš„NULLï¼Œéœ€è¦è°ƒç”¨è€…è‡ªè¡Œå®šä¹‰ c-&gt;next = p-&gt;cleanup; p-&gt;cleanup = c; ngx_log_debug1(NGX_LOG_DEBUG_ALLOC, p-&gt;log, 0, &quot;add cleanup: %p&quot;, c); return c; } //ä¸€ä¸ªcleanupä¸Šæ¸…ç†æ–‡ä»¶æè¿°ç¬¦çš„å›è°ƒå‡½æ•° void ngx_pool_run_cleanup_file(ngx_pool_t *p, ngx_fd_t fd) { ngx_pool_cleanup_t *c; ngx_pool_cleanup_file_t *cf; for (c = p-&gt;cleanup; c; c = c-&gt;next) { if (c-&gt;handler == ngx_pool_cleanup_file) { cf = c-&gt;data; if (cf-&gt;fd == fd) { c-&gt;handler(cf); c-&gt;handler = NULL; return; } } } } // å…³é—­æ–‡ä»¶çš„å›è°ƒ void ngx_pool_cleanup_file(void *data) { ngx_pool_cleanup_file_t *c = data; ngx_log_debug1(NGX_LOG_DEBUG_ALLOC, c-&gt;log, 0, &quot;file cleanup: fd:%d&quot;, c-&gt;fd); if (ngx_close_file(c-&gt;fd) == NGX_FILE_ERROR) { ngx_log_error(NGX_LOG_ALERT, c-&gt;log, ngx_errno, ngx_close_file_n &quot; \\&quot;%s\\&quot; failed&quot;, c-&gt;name); } } // void ngx_pool_delete_file(void *data) { ngx_pool_cleanup_file_t *c = data; ngx_err_t err; ngx_log_debug2(NGX_LOG_DEBUG_ALLOC, c-&gt;log, 0, &quot;file cleanup: fd:%d %s&quot;, c-&gt;fd, c-&gt;name); if (ngx_delete_file(c-&gt;name) == NGX_FILE_ERROR) { err = ngx_errno; if (err != NGX_ENOENT) { ngx_log_error(NGX_LOG_CRIT, c-&gt;log, err, ngx_delete_file_n &quot; \\&quot;%s\\&quot; failed&quot;, c-&gt;name); } } if (ngx_close_file(c-&gt;fd) == NGX_FILE_ERROR) { ngx_log_error(NGX_LOG_ALERT, c-&gt;log, ngx_errno, ngx_close_file_n &quot; \\&quot;%s\\&quot; failed&quot;, c-&gt;name); } }","categories":[{"name":"Cè¯­è¨€","slug":"Cè¯­è¨€","permalink":"http://blog.3amupupup.online/categories/C%E8%AF%AD%E8%A8%80/"}],"tags":[{"name":"nginx","slug":"nginx","permalink":"http://blog.3amupupup.online/tags/nginx/"}]},{"title":"C Primer Plus","slug":"C Primer Plus","date":"2021-03-18T03:09:52.065Z","updated":"2021-03-18T03:09:52.066Z","comments":true,"path":"2021/03/18/C Primer Plus/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/C%20Primer%20Plus/","excerpt":"","text":"#include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;string.h&gt; #include &lt;errno.h&gt; #include &lt;stddef.h&gt; #define LEN 40 #define MAX 41 /* å¸¸é‡ï¼šåœ¨ç¨‹åºä½¿ç”¨ä¹‹å‰å·²ç»é¢„è®¾å®šå¥½ï¼Œåœ¨æ•´ä¸ªç¨‹åºçš„è¿è¡Œè¿‡ç¨‹ä¸­æ²¡æœ‰å˜åŒ– å˜é‡ï¼šåœ¨ç¨‹åºè¿è¡ŒæœŸé—´å¯èƒ½ä¼šè¢«æ”¹å˜æˆ–è€…èµ‹å€¼ æ•°æ®ï¼š æ˜¾ç¤ºåè¿›åˆ¶æ•°ï¼š%d æ˜¾ç¤ºå…«è¿›åˆ¶æ•°ï¼š%o æ˜¾ç¤ºåå…­è¿›åˆ¶æ•°ï¼š%x æŒ‡é’ˆ&amp;æ•°ç»„ï¼š æ•°ç»„åæ˜¯é¦–å…ƒç´ åœ°å€ï¼š arr[i]=*(arr+i) äºŒè€…ç­‰ä»· ç‰¹æ®Šæƒ…å†µï¼š 1. sizeof(æ•°ç»„å) - æ•°ç»„åè¡¨ç¤ºæ•´ä¸ªæ•°ç»„ 2. &amp;æ•°ç»„å - æ•°ç»„åè¡¨ç¤ºæ•´ä¸ªæ•°ç»„ æŒ‡é’ˆæ“ä½œï¼š èµ‹å€¼ï¼šå¯ä»¥æŠŠåœ°å€èµ‹ç»™æŒ‡é’ˆ è§£å¼•ç”¨ï¼š*è¿ç®—ç¬¦è·å¾—æŒ‡é’ˆæŒ‡å‘åœ°å€ä¸Šå­˜å‚¨çš„å€¼ å–åœ°å€ï¼š&amp;è¿ç®—ç¬¦ï¼ŒæŒ‡é’ˆä¹Ÿæ‹¥æœ‰è‡ªå·±çš„åœ°å€ æŒ‡é’ˆä¸æ•´æ•°ç›¸åŠ ï¼šint *a = 1; a+1 å³ açš„åœ°å€ + sizeof(int)*1ï¼Œæ­¥é•¿ä¸ºaæŒ‡å‘çš„æ•°æ®ç±»å‹çš„å¤§å° æŒ‡é’ˆæ±‚å·® æ¯”è¾ƒï¼šå¦‚æœè¦ä½¿ç”¨å…³ç³»è¿ç®—ç¬¦æ¯”è¾ƒä¸¤ä¸ªæŒ‡é’ˆï¼Œé‚£ä¹ˆè¦ç¡®ä¿ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘åŒä¸€æ•°æ®ç±»å‹çš„å¯¹è±¡ è§£å¼•ç”¨æœªåˆå§‹åŒ–çš„æŒ‡é’ˆï¼šä¸¥é‡çš„é”™è¯¯ int main(void){ int *pt; //é”™è¯¯å†™æ³• int *pt = NULL; //æ­£ç¡®å†™æ³• *pt = 100; // ptåœ¨å®šä¹‰ä¹‹åæœªè¢«åˆå§‹åŒ–ï¼Œå…¶å€¼æ˜¯ä¸€ä¸ªéšæœºå€¼ï¼Œä¸èƒ½ç¡®å®š100çš„å­˜å‚¨ä½ç½®ï¼Œè¿™å¯èƒ½ä¸ä¼šå‡ºä»€ä¹ˆé”™ï¼Œä½†æ˜¯ä¹Ÿæœ‰å¯èƒ½æ“¦å†™æ•°æ®æˆ–ä»£ç ï¼Œå¯¼è‡´ç¨‹åºå´©æºƒï¼Œå› æ­¤åˆ›å»ºæŒ‡é’ˆå¿…é¡»åˆå§‹åŒ–ï¼Œç‰¹æ®Šæƒ…å†µä¸‹å¯ä»¥å°†æŒ‡é’ˆæŒ‡å‘NULL printf(&quot;%d\\n&quot;, *p); return 0; } constï¼š 1ã€æŠŠconstæˆ–è€…éconstæ•°æ®çš„åœ°å€åˆå§‹åŒ–ä¸ºæŒ‡å‘constçš„æŒ‡é’ˆæˆ–è€…ä¸ºå…¶èµ‹å€¼æ˜¯åˆæ³•çš„ã€‚ int main(void){ int arr1[10] = {1,2,3,4,5,6,7,8,9,10}; const int arr2[10] = {11,12,13,14,15,16,17,18,19,20}; const int * pt = arr1; //æŠŠptæŒ‡å‘çš„intç±»å‹çš„å€¼å£°æ˜ä¸ºconst(æ³¨æ„æ˜¯å€¼è€Œéåœ°å€)ï¼Œæ‰€ä»¥ä¸èƒ½å¤Ÿç”¨*ptä¿®æ”¹æ•°ç»„çš„å€¼ï¼Œä½†æ˜¯èƒ½ä¿®æ”¹ptæ‰€æŒ‡å‘çš„åœ°å€ pt = arr2; pt = &amp;arr1[3]; return 0; } 2ã€åªèƒ½æŠŠéconstæ•°æ®çš„åœ°å€èµ‹ç»™æ™®é€šæŒ‡é’ˆï¼Œ int main(void){ int arr1[10] = {1,2,3,4,5,6,7,8,9,10}; const int arr2[10] = {11,12,13,14,15,16,17,18,19,20}; const int * pt = arr1; int * pt2 = arr1; pt2 = arr2; //éæ³•ï¼Œåªèƒ½å°†éconstçš„æ•°æ®çš„åœ°å€èµ‹å€¼ç»™æ™®é€šæŒ‡é’ˆï¼Œå¦åˆ™é€šè¿‡æŒ‡é’ˆå°±èƒ½æ”¹å˜constæ•°ç»„ä¸­çš„æ•°ç»„ï¼Œæ˜¾ç„¶ä¸åˆç†ã€‚ pt2 = &amp;arr1[3]; return 0; } 3ã€åˆ›å»ºä¸€ä¸ªä¸èƒ½æ”¹å˜æŒ‡å‘åœ°å€çš„æŒ‡é’ˆï¼Œä½†æ˜¯èƒ½æ”¹å˜æŒ‡é’ˆæŒ‡å‘çš„åœ°å€çš„å€¼ int main(void){ int arr1[10] = {1,2,3,4,5,6,7,8,9,10}; const int arr2[10] = {11,12,13,14,15,16,17,18,19,20}; const int * pt = arr1; int * pt2 = arr1; pt2 = &amp;arr1[3]; int * const pt3 = arr1; pt3 = &amp;arr1[3]; //éæ³• *(pt3+1) = 100; printf(&quot;new = %d\\n&quot;,arr1[1]); return 0; } æŒ‡é’ˆå’Œå¤šç»´æ•°ç»„ï¼š int main(void){ int arr[3][4]; printf(&quot;%d\\n&quot;,**arr); // arr = arr[0] = &amp;arr[0][0],**arr ä¸ *&amp;arr[0][0]ç­‰ä»·ï¼Œ**arrdç¬¬ä¸€æ¬¡è§£å¼•ç”¨è¡¨ç¤ºarr[0],æ­¤æ—¶ä»ç„¶æ˜¯ä¸ªåœ°å€æ‰€ä»¥éœ€è¦å†æ¬¡è§£å¼•ç”¨ printf(&quot;arr = %p, arr[0] = %p, arr[0][0] = %p\\n&quot;,arr,arr[0],&amp;arr[0][0]); // arr = 0x7ffeeeec7be0, arr[0] = 0x7ffeeeec7be0, arr[0][0] = 0x7ffeeeec7be0 return 0; } æŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆï¼š int *p[]; //æŒ‡é’ˆæ•°ç»„ int (*p)[]; // æ•°ç»„æŒ‡é’ˆ ----ä¾‹é¢˜ï¼š int main(void){ int arr[10] = {100 ,2,3,4,5,6,7,8,9,10}; int res = max(arr); printf(&quot;%d\\n&quot;,res); return 0; } int max(int *arr){ int temp; for (int i = 1; i &lt; 10; ++i) { if (arr[0]&lt;arr[i]) { temp = arr[0]; arr[0] = arr[i]; arr[i] = temp; } } return arr[0]; } åˆ†é…å†…å­˜ malloc å’Œ free ä¹‹å‰æ‰€ä½¿ç”¨çš„çš„å­˜å‚¨ç±»åˆ«æœ‰ä¸€ä¸ªå…±åŒä¹‹å¤„ï¼šåœ¨ç¡®å®šå­˜å‚¨ç±»åˆ«ä¹‹åï¼Œæ ¹æ®å·²å®šåˆ¶å¥½çš„å†…å­˜ç®¡ç†è§„åˆ™ï¼Œå°†è‡ªåŠ¨é€‰æ‹©å…¶ä½œç”¨åŸŸå’Œå­˜å‚¨æœŸï¼Œç„¶è€Œè¿˜æœ‰æ›´çµæ´»çš„é€‰æ‹©ï¼Œå³ä½¿ç”¨åº“å‡½æ•°åˆ†é…å’Œç®¡ç†å†…å­˜ã€‚ int main(){ double * ptd1; ptd1 = (double *)malloc(30 * sizeof(double)); //ä¸º30ä¸ªdoubleç±»å‹çš„å€¼ç”³è¯·å†…å­˜ç©ºé—´ï¼Œå¹¶è®©ptdæŒ‡å‘è¯¥ç‰‡å†…å­˜çš„é¦–åœ°å€ã€‚doubleç±»å‹ä¸”é•¿åº¦ä¸º30çš„æ•°ç»„ if (ptd1==NULL){ printf(&quot;å†…å­˜åˆ†é…å¤±è´¥\\n&quot;); exit(-1); } free(ptd1); //é‡Šæ”¾å†…å­˜ long * ptd2; ptd2 = (long *)calloc(100,sizeof(long)); printf(&quot;ptd2 = %d\\n&quot;,ptd2); free(ptd2); return 0; } å¯ä»¥è®¤ä¸ºç¨‹åºæŠŠå®ƒçš„å¯ç”¨å†…å­˜åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼šä¸€éƒ¨åˆ†ä¾›å…·æœ‰å¤–éƒ¨é“¾æ¥ã€å†…éƒ¨é“¾æ¥å’Œæ— è¿æ¥çš„é™æ€å˜é‡ä½¿ç”¨ï¼›ä¸€éƒ¨åˆ†ä¾›è‡ªåŠ¨å˜é‡ä½¿ç”¨ï¼›ä¸€éƒ¨åˆ†ä¾›åŠ¨æ€å†…å­˜åˆ†é…ã€‚ int num1 = 100; //æ–‡ä»¶ä½œç”¨åŸŸï¼Œå¤–éƒ¨é“¾æ¥ static int num2 = 100; //æ–‡ä»¶ä½œç”¨åŸŸï¼Œå†…éƒ¨é“¾æ¥ã€‚ //æ— è®ºå¤–éƒ¨è¿˜æ˜¯å†…éƒ¨é“¾æ¥ï¼Œæ–‡ä»¶ä½œç”¨åŸŸå˜é‡éƒ½å…·æœ‰é™æ€å­˜å‚¨æœŸ(éšç¨‹åºæ‰§è¡Œåˆ›å»ºï¼Œç¨‹åºç»“æŸé”€æ¯ï¼Œåœ¨ç¨‹åºæ‰§è¡Œå’Œç»“æŸæœŸé—´ä¸€ç›´å­˜åœ¨) //å—çº§ä½œç”¨åŸŸå…·æœ‰è‡ªåŠ¨å­˜å‚¨å™¨ã€‚å½“ç¨‹åºè¿›å…¥å®šä¹‰è¿™äº›å˜é‡çš„å—æ—¶ï¼Œä¸ºè¿™äº›å˜é‡åˆ†é…å†…å­˜ï¼Œå½“é€€å‡ºè¿™ä¸ªå—æ—¶ï¼Œé‡Šæ”¾åˆšæ‰ä¸ºå˜é‡åˆ†é…çš„å†…å­˜ã€‚(å˜é•¿æ•°ç»„ç•¥æœ‰ä¸åŒï¼Œå®ƒçš„å­˜å‚¨å™¨ä»ç”Ÿå‘½åˆ°å—ç»“å°¾) //å—çº§ä½œç”¨åŸŸä¹Ÿèƒ½å…·æœ‰é™æ€å­˜å‚¨æœŸã€‚åœ¨å—ä¸­å£°æ˜å˜é‡æ—¶ï¼ŒåŠ ä¸Šstaticå…³é”®å­—ã€‚ä½†æ˜¯åªæœ‰æ‰§è¡Œå…¶æ‰€åœ¨çš„å‡½æ•°æ—¶æ‰èƒ½è®¿é—®ï¼Œè¯¥å‡½æ•°å¯ä»¥æä¾›æ”¹å˜é‡çš„å­˜å‚¨åœ°å€ä»¥ä¾¿é—´æ¥çš„è®¿é—®å¯¹è±¡ï¼Œä¾‹å¦‚è¿”å›ä¸€ä¸ªæŒ‡é’ˆ //é™æ€å˜é‡ï¼šè¯¥å˜é‡åœ¨å†…å­˜ä¸­åŸåœ°ä¸åŠ¨ï¼Œå¹¶ä¸æ˜¯å€¼ä¸å¯æ”¹å˜ã€‚ void trystat(void){ int fade = 1; //å‡½æ•°æ‰§è¡Œä¸€æ¬¡ï¼Œåˆå§‹åŒ–ä¸€æ¬¡ static int stay = 1; //åªåœ¨ç¼–è¯‘é˜¶æ®µåˆå§‹åŒ–ä¸€æ¬¡ printf(&quot;fade = %d and stay = %d\\n&quot;,fade++,stay++); } void test(void){ extern int num1; //å¯é€‰é‡å¤å£°æ˜ printf(&quot;%d\\n&quot;,num1); } ---------------------------------------------------------------------------------- Cçš„å­˜å‚¨ç±»åˆ«ï¼š(é™æ€å­˜å‚¨æœŸï¼šéšç€ç¨‹åºè¿è¡Œåˆ›å»ºï¼Œç¨‹åºç»“æŸé”€æ¯ï¼Œåœ¨è¿™æœŸé—´ä¸€ç›´å­˜åœ¨ï¼›æ–‡ä»¶ä½œç”¨åŸŸï¼šå¯ä»¥å¤šä¸ªç¨‹åºæ–‡ä»¶ä½¿ç”¨ï¼›è‡ªåŠ¨å­˜å‚¨æœŸï¼šå½“ç¨‹åºè¿›å…¥å®šä¹‰è¿™äº›å˜é‡çš„å—æ—¶ï¼Œä¸ºè¿™äº›å˜é‡åˆ†é…å†…å­˜ï¼Œå½“é€€å‡ºè¿™ä¸ªå—æ—¶ï¼Œé‡Šæ”¾åˆšæ‰ä¸ºå˜é‡åˆ†é…çš„å†…å­˜ï¼›é™æ€å­˜å‚¨æœŸï¼šåœ¨å—ä¸­å£°æ˜å˜é‡æ—¶ï¼ŒåŠ ä¸Šstaticå…³é”®å­—ã€‚ä½†æ˜¯åªæœ‰æ‰§è¡Œå…¶æ‰€åœ¨çš„å‡½æ•°æ—¶æ‰èƒ½è®¿é—®ï¼Œè¯¥å‡½æ•°å¯ä»¥æä¾›æ”¹å˜é‡çš„å­˜å‚¨åœ°å€ä»¥ä¾¿é—´æ¥çš„è®¿é—®å¯¹è±¡) è‡ªåŠ¨ï¼šåœ¨å—ä¸­ä¸å¸¦å­˜å‚¨ç±»åˆ«è¯´æ˜ç¬¦æˆ–å¸¦auto(é»˜è®¤)å­˜å‚¨ç±»è¯´æ˜ç¬¦å£°æ˜çš„å˜é‡(æˆ–è€…ä½œä¸ºå‡½æ•°å¤´ä¸­çš„å½¢å‚)å±äºè‡ªåŠ¨å­˜å‚¨ç±»åˆ«ã€‚ å¯„å­˜å™¨ï¼šåœ¨å—ä¸­å¸¦registerå­˜å‚¨ç±»åˆ«è¯´æ˜ç¬¦å£°æ˜çš„å˜é‡(æˆ–ä½œä¸ºå‡½æ•°å¤´ä¸­çš„å½¢å‚)å±äºå¯„å­˜å™¨å­˜å‚¨ç±»åˆ«ï¼Œå…·æœ‰è‡ªåŠ¨å­˜å‚¨åŒºã€å—ä½œç”¨åŸŸã€æ— é“¾æ¥ä¸”æ— æ³•è·å–å…¶åœ°å€ã€‚ é™æ€ã€æ— é“¾æ¥ï¼šåœ¨å—ä¸­å¸¦æœ‰staticå­˜å‚¨ç±»åˆ«è¯´æ˜ç¬¦å£°æ˜çš„å˜é‡ï¼Œå…·æœ‰é™æ€å­˜å‚¨æœŸã€å—ä½œç”¨åŸŸã€æ— é“¾æ¥ï¼Œåªåœ¨ç¼–è¯‘æ—¶åˆå§‹åŒ–ä¸€æ¬¡ é™æ€ã€å¤–éƒ¨é“¾æ¥ï¼šåœ¨æ‰€æœ‰å‡½æ•°å¤–éƒ¨ä¸”æ²¡æœ‰ä½¿ç”¨staticå­˜å‚¨ç±»åˆ«è¯´æ˜ç¬¦ï¼Œå…·æœ‰é™æ€å­˜å‚¨æœŸã€æ–‡ä»¶ä½œç”¨åŸŸã€å¤–éƒ¨é“¾æ¥ã€‚åªèƒ½åœ¨ç¼–è¯‘å™¨è¢«åˆå§‹åŒ–ä¸€æ¬¡ é™æ€ã€å†…éƒ¨é“¾æ¥ï¼šåœ¨æ‰€æœ‰å‡½æ•°å¤–ä½¿ç”¨äº†staticå­˜å‚¨ç±»åˆ«è¯´æ˜ç¬¦ï¼Œå…·æœ‰é™æ€å­˜å‚¨æœŸã€æ–‡ä»¶ä½œç”¨åŸŸã€å†…éƒ¨é“¾æ¥ã€‚åªèƒ½åœ¨ç¼–è¯‘å™¨è¢«åˆå§‹åŒ–ä¸€æ¬¡ åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼šç”±malloc()ç›¸å…³å‡½æ•°åˆ†é…ã€‚ ç±»å‹é™å®šç¬¦ï¼šconstã€volatileã€restrictã€_Automicï¼Œconsté™å®šç¬¦é™å®šæ•°æ®åœ¨ç¨‹åºè¿è¡Œæ—¶ä¸èƒ½æ”¹å˜ã€‚å¯¹æŒ‡é’ˆä½¿ç”¨constæ—¶ï¼Œå¯é™å®šæŒ‡é’ˆæœ¬èº«ä¸èƒ½æ”¹å˜æˆ–è€…æŒ‡å‘çš„æ•°æ®ä¸èƒ½æ”¹å˜ã€‚ ---------------------------------------------------------------------------------- æ–‡ä»¶è¾“å…¥ä¸è¾“å‡ºï¼š r:åªè¯»æ‰“å¼€ w:è¦†ç›–å†™ a:è¿½åŠ å†™ r+:è¯»å†™ w+:è¯»ï¼Œè¦†ç›–å†™ a+:è¯»ï¼Œè¿½åŠ å†™ int main(){ int ch; //è¯»æ–‡ä»¶æ—¶å­˜å‚¨æ¯ä¸ªå­—ç¬¦çš„åœ°æ–¹ FILE *fp; //æ–‡ä»¶æŒ‡é’ˆ int count = 0; fp = fopen(&quot;test.txt&quot;,&quot;r&quot;); if (fp==NULL){ return 0; } for (;(ch = getc(fp))!=EOF;){ //getc() putc() è¦ä¼ é€’æ–‡ä»¶çš„æŒ‡é’ˆã€‚ putc(ch,stdout); count++; } fclose(fp); printf(&quot;\\n%d\\n&quot;, count); return 0; } --------------- æ–‡ä»¶è¯»å†™demo: int main(){ int ch; FILE *fp,*wfp; int count = 0; wfp = fopen(&quot;test.txt&quot;,&quot;a+&quot;); if ((fp=fopen(&quot;/Users/duwei/ingress-controller-manager.yaml&quot;,&quot;r&quot;))==NULL) { printf(&quot;%s\\n&quot;,strerror(errno)); //strerror(errno) } for (;(ch = getc(fp)) != EOF;) { putc(ch,wfp); } fclose(fp); return 0; } --------------- rewindï¼š int main(){ FILE *fp; char str1[10],str2[10],str3[10]; int year; fp = fopen(&quot;test.txt&quot;,&quot;w+&quot;); fputs(&quot;we are in 2020&quot;,fp); rewind(fp);//å†™å®Œæ—¶æ–‡ä»¶æè¿°ç¬¦åœ¨æœ«å°¾ï¼Œrewindå°†æ–‡ä»¶æè¿°ç¬¦æ‹‰å›æ–‡ä»¶å¼€å§‹çš„åœ°æ–¹ fscanf(fp,&quot;%s %s %s %de&quot;,&amp;str1,&amp;str2,&amp;str3,&amp;year); printf(&quot;Read String1 |%s|\\n&quot;, str1 ); printf(&quot;Read String2 |%s|\\n&quot;, str2 ); printf(&quot;Read String3 |%s|\\n&quot;, str3 ); printf(&quot;Read Integer |%d|\\n&quot;, year ); fprintf(stderr, &quot;end.\\n&quot;); fclose(fp); return 0; } ç»“æ„ä½“ï¼š --------------- struct book{ char title[100]; char author[100]; int value; }; void setV(struct book bk); int main(){ struct book library[100]; library[0].value = 99; printf(&quot;out func,value = %d\\n&quot;,library[0].value ); setV(library[0]); printf(&quot;out func,value = %d\\n&quot;,library[0].value ); } void setV(struct book bk){ bk.value=999; printf(&quot;in func,value = %d\\n&quot;,bk.value); } stdout: out func,value = 99 in func,value = 999 out func,value = 99 ç»“è®ºï¼šç»“æ„ä½“æ˜¯å€¼ä¼ é€’ã€‚ --------------- å¯¹é½è§„åˆ™ï¼š 1ã€ç¬¬ä¸€ä¸ªæˆå‘˜åœ¨ä¸ç»“æ„ä½“å˜é‡åç§»é‡ä¸º0çš„åœ°å€å¤„ã€‚(c1ä¸ºèµ·å§‹ä½ç½®) 2ã€å…¶å®ƒæˆå‘˜å˜é‡è¦å¯¹é½åˆ°æŸä¸ªæ•°(å¯¹é½æ•°ï¼Œvsé»˜è®¤ä¸º8ï¼Œæˆ‘ç”¨çš„gccï¼Œå¯¹é½æ•°å°±æ˜¯æˆå‘˜è‡ªèº«å¤§å°)çš„æ•´æ•°å€çš„åœ°å€å¤„ã€‚(å¯¹é½æ•°: ç¼–è¯‘å™¨é»˜è®¤çš„å¯¹é½æ•° ä¸ è¯¥æˆå‘˜å¤§å° æ¯”è¾ƒï¼Œå°çš„å°±æ˜¯è¯¥æˆå‘˜çš„å¯¹é½æ•°ã€‚aå¤§å°ä¸º4ï¼Œç¼–è¯‘å™¨é»˜è®¤çš„æ˜¯8ï¼Œé‚£ä¹ˆè¯¥æˆå‘˜çš„å¯¹é½æ•°å°±æ˜¯4ï¼Œ æ‰€ä»¥açš„ä½ç½®è¦ä¸º4çš„å€æ•°å¤„ï¼Œæ‰€ä»¥açš„ä½ç½®ä¸º4ï¼Œå¦å¤–aå å››ä¸ªå­—èŠ‚ã€‚åŒç†c2çš„å¯¹é½æ•°æ˜¯1(1ä¸8æ¯”è¾ƒ)ï¼Œæ‰€ä»¥c2çš„ä½ç½®ä¸º8ã€‚) 3ã€ç»“æ„ä½“æ€»å¤§å°ä¸ºæœ€å¤§å¯¹é½æ•°(æ¯ä¸ªæˆå‘˜å˜é‡éƒ½æœ‰ä¸€ä¸ªå¯¹é½æ•°)çš„æ•´æ•°å€ã€‚(s1ä¸­çš„æœ€å¤§å¯¹é½æ•°ä¸º4[æ¥è‡ªa]ï¼Œå½“å‰ä¸‰ä¸ªå˜é‡å äº†0-8ä¹Ÿå°±æ˜¯9ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥ç»“æ„ä½“s1çš„æ•´ä½“å¤§å°ä¸º3*4=12å­—èŠ‚) 4ã€å¦‚æœåµŒå¥—äº†ç»“æ„çš„æƒ…å†µï¼ŒåµŒå¥—çš„ç»“æ„ä½“å¯¹é½åˆ°è‡ªå·±çš„æœ€å¤§å¯¹é½æ•°çš„æ•´æ•°å€å¤„ï¼Œç»“æ„ä½“çš„æ•´ä½“å¤§å°å°±æ˜¯æ‰€æœ‰æœ€å¤§å¯¹é½æ•°(å«åµŒå¥—ç»“æ„ä½“çš„å¯¹é½æ•°)çš„æ•´æ•°å€ã€‚ åœ¨è®¾è®¡ç»“æ„ä½“æ—¶å€™ï¼Œå°†å ç”¨ç©ºé—´å°çš„æˆå‘˜å°½é‡é›†ä¸­åœ¨ä¸€èµ·ã€‚ #pragma pack(4) //è®¾ç½®é»˜è®¤å¯¹é½æ•° struct S1 { char c1; int a; char c2; }; _________________ ____ __________ 0 |_________________| c1 | 1 |_________________| | | 2 |_________________| | | 3 |_________________| _|__ 4 |_________________| a s1: 12ä¸ªå­—èŠ‚,1ã€2ã€3ã€9ã€10ã€11æµªè´¹æ‰ 5 |_________________| | 6 |_________________| | 7 |_________________| ____ | 8 |_________________| _c2_ | 9 |_________________| | 10 |_________________| | 11 |_________________| _____|____ 12 |_________________| 13 |_________________| 14 |_________________| |_________________| |_________________| |_________________| |_________________| |_________________| |_________________| |_________________| åŒç†s2å¦‚ä¸‹ï¼š struct S2 { char c1; char c2; int a; }; _________________ ____ _________ 0 |_________________| _c1_ | 1 |_________________| _c2_ | 2 |_________________| | 3 |_________________| ____ 4 |_________________| a s1: 8 ä¸ªå­—èŠ‚,2ã€3æµªè´¹æ‰ 5 |_________________| | 6 |_________________| | 7 |_________________| ____ ____|_____ 8 |_________________| 9 |_________________| 10 |_________________| 11 |_________________| 12 |_________________| 13 |_________________| 14 |_________________| |_________________| |_________________| |_________________| |_________________| |_________________| |_________________| |_________________| struct S3 { double d; char c; int i; }; struct S4 { char c1; struct S3 s3; double d; }; â€”â€”â€”â€”â€”â€”â€”â€”----------â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” struct S{ int a; char c; double d; }; void Init(struct S * tmp) { tmp-&gt;a = 100; tmp-&gt;c = &#39;d&#39;; tmp-&gt;d = 3.14; } int main(){ struct S s = {0}; Init(&amp;s); printf(&quot;%d\\n&quot;, s.a); } â€”â€”â€”â€”â€”â€”â€”â€”----------â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” ä½æ®µï¼š(äºŒè¿›åˆ¶ä½) 1ã€ä½æ®µçš„æˆå‘˜å¯ä»¥ä½¿ intã€unsigned intã€signed int æˆ–è€…æ˜¯charï¼ˆå±äºæ•´å‹å®¶æ—ï¼‰ç±»å‹ã€‚ 2ã€ä½æ®µçš„ç©ºé—´ä¸Šæ˜¯æŒ‰ç…§éœ€è¦ä»¥4ä¸ªå­—èŠ‚(int)æˆ–è€…ä¸€ä¸ªå­—èŠ‚(char)çš„æ–¹å¼æ¥å¼€è¾Ÿçš„ã€‚ 3ã€ä½æ®µæ¶‰åŠå¾ˆå¤šä¸ç¡®å®šå› ç´ ï¼Œä¸è·¨å¹³å°ï¼Œæ³¨é‡å¯ç§»æ¤çš„ç¨‹åºåº”é¿å…ä½¿ç”¨ä½æ®µã€‚ 4ã€æ¯ä¸€æ¬¡å¼€è¾Ÿçš„å†…å­˜ï¼Œä»å³å¾€å·¦ä½¿ç”¨ã€‚ struct S { int _a:2; //2ä»£è¡¨åªéœ€è¦ä¸¤ä¸ªæ¯”ç‰¹ä½ int _b:5; //5ä»£è¡¨åªéœ€è¦äº”ä¸ªæ¯”ç‰¹ä½ int _c:10; int _d:30; }; //47ä¸ªæ¯”ç‰¹ä½ éœ€è¦ 6å­—èŠ‚*8bit = 48æ¯”ç‰¹ int main() { struct S s; printf(&quot;%d\\n&quot;, sizeof(s)); //ç»“æœä¸º8ï¼Œintç±»å‹æ‰€ä»¥ä¸€æ¬¡å¼€è¾Ÿå››ä¸ªå­—èŠ‚ï¼Œå¼€è¾Ÿä¸¤æ¬¡ã€‚ return 0; } â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” struct S { char a:3; char b:4; char c:5; char d:4; }; int main() { | | | | struct S s = {0}; | | | | | | | | | | | | | | | | | | | | | | | | | s.a = 10; //äºŒè¿›åˆ¶ï¼š1010ï¼Œä½†æ˜¯é•¿åº¦åªç»™äº†3 | b | a | | b | | d | s.b = 20; s.c = 3; s.d = 4; printf(&quot;%d\\n&quot;, sizeof(s)); // ç±»å‹æ˜¯charï¼šå¼€è¾Ÿä¸€ä¸ªå­—èŠ‚æ”¾å…¥aï¼Œå†æ”¾å…¥bï¼Œæ­¤æ—¶ä¸€ä¸ªå­—èŠ‚è¢«å ç”¨äº†7ä¸ªæ¯”ç‰¹ï¼Œå‰©ä¸‹çš„1ä¸ªæ¯”ç‰¹ä¸è¶³ä»¥å­˜æ”¾cï¼Œæ‰€ä»¥å†å¼€è¾Ÿä¸€ä¸ªå­—èŠ‚æ”¾å…¥5ï¼Œå‰©ä¸‹çš„3ä¸ªå­—èŠ‚ä¸è¶³ä»¥å­˜æ”¾dï¼Œsoå†æ¬¡å¼€è¾Ÿä¸€ä¸ªå­—èŠ‚ã€‚æµªè´¹äº†8æ¯”ç‰¹ã€‚ printf(&quot;%d\\n&quot;, s.a); return 0; } â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” æšä¸¾ï¼š enum Sex { MALE, FAMALE, SECRET }; enum Color { RED, //0 GREEN, //1 BLUE //2 }; int main(){ enum Sex s = MALE; enum Color c = BLUE; printf(&quot;%d,%d,%d\\n&quot;, RED,GREEN,BLUE); } â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” union: union Un { char c; int i; //å¯¹é½æ•°ä¸º4 char arr[5]; //å¯¹é½æ•°æ˜¯1è€Œä¸æ˜¯5ï¼Œæœ€å°å ç”¨å†…å­˜ä¸º æœ€å¤§å¯¹é½æ•°çš„æ•´æ•°å€ }; int main() { union Un u; printf(&quot;%lu\\n&quot;, sizeof(u)); printf(&quot;%p\\n&quot;, &amp;u); printf(&quot;%p\\n&quot;, &amp;u.c); } â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” åŠ¨æ€å†…å­˜åˆ†é…ï¼š _____________________________________ | å±€éƒ¨å˜é‡ | | å‡½æ•°å½¢å‚ | | | | | | | æ ˆåŒº | | | | | | | | |â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”| | åŠ¨æ€å†…å­˜åˆ†é… | | | | | | | | | | | | | å †åŒº | | | | | | | | | | | | |â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”| | | | å…¨å±€å˜é‡ | | é™æ€å˜é‡ | | | | | | | é™æ€åŒº | | | | | | | | | | | | â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” int main() { int * p1 = (int *)malloc(10*sizeof(int)); //åˆå§‹åŒ–ä¹‹åé»˜è®¤å€¼æ˜¯éšæœºçš„ï¼Œint * p = realloc(NULL,40) if (p1 == NULL) { printf(&quot;%s\\n&quot;, strerror(errno)); } else { for (int i = 0; i &lt; 10; ++i) { printf(&quot;p1 = %d\\n&quot;, p1[i]); } } free(p1); p1 = NULL; printf(&quot;\\n&quot;); int * p2 = (int *)calloc(10,sizeof(int)); //åˆå§‹åŒ–ä¹‹åé»˜è®¤å€¼æ˜¯0 if (p2 == NULL) { printf(&quot;%s\\n&quot;, strerror(errno)); } else { for (int i = 0; i &lt; 10; ++i) { printf(&quot;p2 = %d\\n&quot;, *(p2+i)); } } free(p2); p2 = NULL; printf(&quot;\\n&quot;); int * p3 = (int *)malloc(20); if (p3 == NULL) { printf(&quot;%s\\n&quot;, strerror(errno)); } else { for (int i = 0; i &lt; 5; ++i) { *(p3+i) = i; } } int * p4 = realloc(p3,40); //è°ƒæ•´å·²å¼€è¾Ÿå†…å­˜çš„å¤§å°ã€‚ // 1ã€å¦‚æœp3æŒ‡å‘çš„å†…å­˜ç©ºé—´åæœ‰è¶³å¤Ÿçš„ç©ºé—´å¯ä»¥è¿½åŠ ï¼Œåˆ™ç›´æ¥è¿½åŠ åè¿”å›p3ã€‚ // 2ã€å¦‚æœp3æŒ‡å‘çš„å†…å­˜ç©ºé—´åæ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´å¯ä»¥è¿½åŠ ï¼Œåˆ™å¼€è¾Ÿä¸€å—å…¨æ–°çš„å†…å­˜åŒºåŸŸï¼Œå°†åŸæ¥å†…å­˜ä¸­çš„æ•°æ®æ‹·è´è‡³æ–°å†…å­˜ï¼Œé‡Šæ”¾æ—§å†…å­˜ç©ºé—´ï¼Œè¿”å›æ–°å¼€è¾Ÿçš„å†…å­˜ç©ºé—´åœ°å€ if (p4!=NULL) { p3 = p4; } for (int i = 0; i &lt; 40; ++i) { printf(&quot;p3 = %d\\n&quot;, *(p4+i)); } free(p3); p3 = NULL; return 0; } */ // #pragma pack(4) //è®¾ç½®é»˜è®¤å¯¹é½æ•° // void GetMemory(char **p) // { // p = (char *)malloc(100); // } // void Test(void) // { // char * str = NULL; // GetMemory(&amp;str); // strcpy(str,&quot;hello world&quot;); // printf(str); // } // int main() // { // //strä¼ ç»™GetMemory()å‡½æ•°ï¼Œä¼ çš„æ˜¯strè€Œä¸æ˜¯strçš„åœ°å€ï¼Œæ‰€ä»¥pæ˜¯strçš„å€¼æ‹·è´ï¼Œpçš„å€¼ä¸ºNULLï¼Œå‡½æ•°é‡Œå°†ç”³è¯·çš„å†…å­˜çš„åœ°å€èµ‹ç»™pï¼ŒGetMemoryæ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œ // //pæ˜¯ä¸´æ—¶å˜é‡è¢«é”€æ¯ï¼Œæ‰€ä»¥strçš„å€¼è¿˜æ˜¯NULL // Test(); // return 0; // } // char *GetMemory(void) // { // char p[] = &quot;hello world&quot;; // return p; // } // void Test(void) // { // char * str = NULL; // str = GetMemory(); // printf(str); // } // int main() // { // Test(); // return 0; // } int main() { int a = 10000; FILE* pf = fopen(&quot;test.txt&quot;,&quot;wb&quot;); fwrite(&amp;a,4,1,pf); fclose(pf); pf = NULL; return 0; }","categories":[{"name":"Cè¯­è¨€","slug":"Cè¯­è¨€","permalink":"http://blog.3amupupup.online/categories/C%E8%AF%AD%E8%A8%80/"}],"tags":[{"name":"c primer plus","slug":"c-primer-plus","permalink":"http://blog.3amupupup.online/tags/c-primer-plus/"}]},{"title":"Cè¯­è¨€é¢„å¤„ç†","slug":"Cè¯­è¨€é¢„å¤„ç†","date":"2021-03-18T03:09:52.064Z","updated":"2021-03-18T03:09:52.065Z","comments":true,"path":"2021/03/18/Cè¯­è¨€é¢„å¤„ç†/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/C%E8%AF%AD%E8%A8%80%E9%A2%84%E5%A4%84%E7%90%86/","excerpt":"","text":"#include &lt;stdio.h&gt; int g_val = 1000; int main(){ int i = 0; int arr[10] = { 0 }; for (i = 0; i &lt; 10; i++){ arr[i] = i; } for (i = 0; i &lt; 10; i++){ printf(&quot;%d &quot;, arr[i]); } return 0; } 1ã€é¢„ç¼–è¯‘/é¢„å¤„ç†(gcc -E test.c &gt; test.iï¼Œæ–‡æœ¬æ“ä½œ) #include å¤´æ–‡ä»¶çš„åŒ…å« åˆ é™¤æ³¨é‡Š #define è¿›è¡Œç¬¦å·æ›¿æ¢ 2ã€ç¼–è¯‘(gcc -S test.iï¼Œå°†cä»£ç ç¼–è¯‘æˆæ±‡ç¼–ä»£ç ) è¯­æ³•åˆ†æ è¯æ³•åˆ†æ è¯­ä¹‰åˆ†æ ç¬¦å·æ±‡æ€» 3ã€æ±‡ç¼–(gcc -c test.s)å°†æ±‡ç¼–ä»£ç è½¬æ¢æˆäºŒè¿›åˆ¶æŒ‡ä»¤ 4ã€é“¾æ¥ åˆå¹¶æ®µè¡¨ ç¬¦å·è¡¨çš„åˆå¹¶å’Œé‡æ–°å®šä½ 5ã€å®å‡½æ•°åœ¨è°ƒç”¨çš„æ—¶å€™ä¼šæœ‰å‡½æ•°è°ƒç”¨å’Œè¿”å›çš„å¼€é”€ã€‚ å®åœ¨é¢„å¤„ç†é˜¶æ®µå°±å®Œæˆäº†æ›¿æ¢ï¼Œæ²¡æœ‰è°ƒç”¨å’Œè¿”å›çš„å¼€é”€ã€‚","categories":[{"name":"Cè¯­è¨€","slug":"Cè¯­è¨€","permalink":"http://blog.3amupupup.online/categories/C%E8%AF%AD%E8%A8%80/"}],"tags":[{"name":"c","slug":"c","permalink":"http://blog.3amupupup.online/tags/c/"}]},{"title":"ç¬¬äºŒç«  ä¿¡æ¯çš„è¡¨ç¤ºå’Œå¤„ç†","slug":"ç¬¬äºŒç«  ä¿¡æ¯çš„è¡¨ç¤ºå’Œå¤„ç†","date":"2021-03-18T03:09:52.062Z","updated":"2021-03-18T03:09:52.063Z","comments":true,"path":"2021/03/18/ç¬¬äºŒç«  ä¿¡æ¯çš„è¡¨ç¤ºå’Œå¤„ç†/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/%E7%AC%AC%E4%BA%8C%E7%AB%A0%20%E4%BF%A1%E6%81%AF%E7%9A%84%E8%A1%A8%E7%A4%BA%E5%92%8C%E5%A4%84%E7%90%86/","excerpt":"","text":"2.1 ä¿¡æ¯å­˜å‚¨ å¤§å¤šæ•°è®¡ç®—æœºä½¿ç”¨8ä½çš„å—ï¼Œæˆ–è€…å­—èŠ‚(byte)ï¼Œä½œä¸ºæœ€å°çš„å¯å¯»å€çš„å†…å­˜å•ä½ï¼Œè€Œä¸æ˜¯è®¿é—®å†…å­˜ä¸­å•ç‹¬çš„ä½ã€‚ Cç¼–è¯‘å™¨æŠŠæŒ‡é’ˆå’Œç±»å‹è”ç³»èµ·æ¥ï¼Œè¿™æ ·å°±å¯ä»¥æ ¹æ®æŒ‡é’ˆå€¼çš„ç±»å‹ï¼Œç”Ÿæˆä¸åŒçš„æœºå™¨çº§åˆ«ä»£ç æ¥è®¿é—®å­˜å‚¨åœ¨æŒ‡é’ˆæ‰€æŒ‡å‘ä½ç½®å¤„çš„å€¼ã€‚å°½ç®¡Cç¼–è¯‘å™¨ç»´æŠ¤ç€è¿™ä¸ªç±»å‹çš„ä¿¡æ¯ï¼Œä½†æ˜¯å®ƒç”Ÿæˆçš„å®é™…æœºå™¨çº§ç¨‹åºä¸åŒ…å«å…³äºæ•°æ®ç±»å‹çš„ä¿¡æ¯ã€‚ æœºå™¨çº§ç¨‹åºå°†å†…å­˜è§†ä¸ºä¸€ä¸ªéå¸¸å¤§çš„å­—èŠ‚æ•°ç»„ï¼Œç§°ä¸ºè™šæ‹Ÿå†…å­˜(virtual memory)ã€‚å†…å­˜çš„æ¯ä¸€ä¸ªå­—èŠ‚éƒ½æ˜¯ç”±å”¯ä¸€çš„æ•°å­—æ ‡è¯†çš„ï¼Œç§°ä¸ºåœ°å€(address)ã€‚æ‰€æœ‰åœ°å€çš„é›†åˆå°±ç§°ä¸ºè™šæ‹Ÿåœ°å€ç©ºé—´(virtual address space)ã€‚ 2.1.1 åå…­è¿›åˆ¶è¡¨ç¤ºæ³• åå…­è¿›åˆ¶ 1 7 3 A 4 äºŒ è¿› åˆ¶ 0001 0111 0011 1010 0100 2.1.2 å­—æ•°æ®å¤§å° å¯¹äºä¸€ä¸ªå­—é•¿ä¸ºwä½çš„æœºå™¨è€Œè¨€ï¼Œè™šæ‹Ÿåœ°å€çš„èŒƒå›´æ˜¯0 ~ 2^w-1ï¼Œç¨‹åºæœ€å¤šè®¿é—®2^wä¸ªå­—èŠ‚ã€‚ ä¸¾ä¸ªä¾‹å­ï¼š 32ä½æ“ä½œç³»ç»Ÿï¼Œä¼ è¾“æ€»çº¿æ˜¯32ä½ï¼Œ8bitä¸ºä¸€ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆåœ¨è¯»æˆ–è€…å†™æ•°æ®æ—¶ä¸€æ¬¡å°±èƒ½ä¼ è¾“32/8=4ä¸ªå­—èŠ‚ã€‚ä¸€ä¸ªå­—é•¿å°±æ˜¯4å­—èŠ‚ã€‚ 2.1.3 å¯»å€å’Œå­—èŠ‚é¡ºåº å¯¹äºè·¨è¶Šå¤šå­—èŠ‚çš„ç¨‹åºå¯¹è±¡ï¼Œå¿…é¡»å»ºç«‹ä¸¤ä¸ªè§„åˆ™ï¼šâ‘  è¿™ä¸ªå¯¹è±¡çš„åœ°å€æ˜¯ä»€ä¹ˆï¼Œâ‘¡ åœ¨å†…å­˜ä¸Šå¦‚ä½•æ’åˆ— å¤šå­—èŠ‚å¯¹è±¡ä¼šè¢«å­˜å‚¨ä¸ºè¿ç»­çš„å­—èŠ‚åºåˆ—ï¼Œå¯¹è±¡çš„åœ°å€ä¸ºæ‰€ä½¿ç”¨å­—èŠ‚ä¸­æœ€å°çš„åœ°å€ã€‚ æ’åˆ—è¡¨ç¤ºä¸€ä¸ªå¯¹è±¡çš„å­—èŠ‚æœ‰ä¸¤ä¸ªé€šç”¨è§„åˆ™ï¼šå°ç«¯æ³• &amp; å¤§ç«¯æ³• ä½æœ‰æ•ˆå­—èŠ‚å­˜å‚¨åœ¨ä½åœ°å€ä¸Šï¼Œç§°ä¸ºå°ç«¯å­˜å‚¨ï¼Œåä¹‹åˆ™ä¸ºå¤§ç«¯å­˜å‚¨ã€‚ Cè¯­è¨€ä¸­å­—ç¬¦ä¸²è¢«ç¼–ç ä¸ºä¸€ä¸ªä»¥null(å…¶å€¼ä¸º0)å­—ç¬¦ç»“å°¾çš„å­—ç¬¦æ•°ç»„ã€‚ 2.1.6 å¸ƒå°” NOT: ~ int main(){ int a = 10; // 0000 0000 0000 0000 0000 0000 0000 1010 printf(&quot;%d\\n&quot;,~a); // 1111 1111 1111 1111 1111 1111 1111 0101 è¡¥ // 1111 1111 1111 1111 1111 1111 1111 0100 å // 1000 0000 0000 0000 0000 0000 0000 1011 åŸ } AND: &amp; int main(){ int a = 10; // 0000 0000 0000 0000 0000 0000 0000 1010 int b = 15; // 0000 0000 0000 0000 0000 0000 0000 1111 printf(&quot;%d\\n&quot;,a&amp;b); // 0000 0000 0000 0000 0000 0000 0000 1010 } OR: | int main(){ int a = 2; // 0000 0000 0000 0000 0000 0000 0000 0010 int b = 11; // 0000 0000 0000 0000 0000 0000 0000 1011 printf(&quot;%d\\n&quot;,a|b); // 0000 0000 0000 0000 0000 0000 0000 1011 } EXCLUSIVE-OR: ^ int main(){ int a = 10; // 0000 0000 0000 0000 0000 0000 0000 1010 int b = 2; // 0000 0000 0000 0000 0000 0000 0000 0010 printf(&quot;%d\\n&quot;,a^b); // 0000 0000 0000 0000 0000 0000 0000 1000 } 2.1.9 ç§»ä½è¿ç®—int main(){ unsigned int a = 10; // 0000 0000 0000 0000 0000 0000 0000 1010 a = a &gt;&gt; 3; // 0000 0000 0000 0000 0000 0000 0000 0001 printf(&quot;a = %d\\n&quot;,a); // 1,æ— ç¬¦å·å³ç§»è¡¥0 int b = -5; // åŸç : 1000 0000 0000 0000 0000 0000 0000 0101 // åç : 1111 1111 1111 1111 1111 1111 1111 1010 // è¡¥ç : 1111 1111 1111 1111 1111 1111 1111 1011 b = b &lt;&lt; 3; // è¡¥ç : 1111 1111 1111 1111 1111 1111 1101 1000 // åç : 1111 1111 1111 1111 1111 1111 1101 0111 // åŸç : 1000 0000 0000 0000 0000 0000 0010 1000 printf(&quot;b = %d\\n&quot;,b); // -40 int c = -5; // åŸç : 1000 0000 0000 0000 0000 0000 0000 0101 // åç : 1111 1111 1111 1111 1111 1111 1111 1010 // è¡¥ç : 1111 1111 1111 1111 1111 1111 1111 1011 c = c &gt;&gt; 3; // è¡¥ç : 1111 1111 1111 1111 1111 1111 1111 1111 // åç : 1111 1111 1111 1111 1111 1111 1111 1110 // è¡¥ç : 1000 0000 0000 0000 0000 0000 0000 0001 printf(&quot;c = %d\\n&quot;,c); // -1,æœ‰ç¬¦å·æ•°å³ç§»æ—¶è¡¥ç¬¦å·ä½ } 2.2 æ•´æ•°è¡¨ç¤º","categories":[{"name":"æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ","slug":"æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ","permalink":"http://blog.3amupupup.online/categories/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/"}],"tags":[{"name":"c","slug":"c","permalink":"http://blog.3amupupup.online/tags/c/"}]},{"title":"Cè¯­è¨€å®ç°linuxå‘½ä»¤","slug":"Cè¯­è¨€å®ç°linuxå‘½ä»¤","date":"2021-03-18T03:09:52.061Z","updated":"2021-03-18T03:09:52.062Z","comments":true,"path":"2021/03/18/Cè¯­è¨€å®ç°linuxå‘½ä»¤/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/C%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0linux%E5%91%BD%E4%BB%A4/","excerpt":"","text":"tail #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;string.h&gt; #include &lt;stdint.h&gt; #define FILE_LINE_LEN 1024 long g_curr_offset = 0; int32_t c_tail(const char *file); int32_t c_tail(const char *file) { if (!file){ return -1; } FILE *fp = fopen(file,â€râ€); if (!fp){ printf(â€œcan not open %s\\nâ€,file); return -2; } fseek(fp, g_curr_offset, SEEK_SET); char text[FILE_LINE_LEN]; uint32_t len; while (!feof(fp)){ memset(text, 0x0, FILE_LINE_LEN); fgets(text, FILE_LINE_LEN, fp); len = strlen(text); if (0 == len || &#39;\\n&#39; != text[len -1]){ continue; } text[len-1] = 0; g_curr_offset += len; printf(&quot;%s\\n&quot;,text); } fclose(fp); return 0; } int main(int argc, char *argv[]) { if (argc != 2) { printf(â€œUsage: exe file_name\\nâ€); exit(-1); } while (1) { c_tail(argv[1]); } return 0; }","categories":[],"tags":[]},{"title":"PracticeSql","slug":"PracticeSql","date":"2021-03-18T03:09:52.060Z","updated":"2021-03-18T03:09:52.060Z","comments":true,"path":"2021/03/18/PracticeSql/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/PracticeSql/","excerpt":"","text":"select TrueName,IDCard,Mobile from xb_mem_info where IDCard like &#39;%1999%&#39; limit 10; select id,TrueName,IDCard,soundex(TrueName) from xb_mem_info where soundex(TrueName)=soundex(&#39;æœç»´&#39;);select upper(NickName) as new,NickName from xb_mem_info limit 10; select id,Mobile,TrueName,IDCard,Mobile+id as sumid from xb_mem_info where id=3; select concat(curdate(),&#39; &#39;,curtime()); select count(1) from xb_mem_info; select count(*) from xb_mem_info; select max(Mobile) from xb_mem_info; select distinct name from student ; å»é‡ select count(distinct name) from student; select stutel,count(*) as newnum from student group by stutel ;ä¸åŒçš„stutelå‡ºç°çš„æ¬¡æ•° select name,count(*) as newnum from student group by name having count(*)&gt;3; select name,count(*) as newnum from student group by name having name=&#39;duwei1&#39;; havingè¿‡æ»¤åˆ†ç»„ï¼Œwhereè¿‡æ»¤è¡Œ select name,count(*) from student where stutel&gt;13487459071 group by name having count(*) &gt;2; ( select name,count(*) from student group by name order by count(*) desc; select name,count(*) from student group by name having count(*) &gt;= 1 order by count(*) desc; ) create database if not exists learn; å¤åˆ¶è¡¨æ•°æ®è‡³å¦ä¸€ä¸ªè¡¨ CREATE TABLE IF NOT EXISTS teacher ( id int PRIMARY KEY AUTO_INCREMENT COMMENT &#39;id ä¸»é”®&#39;, name varchar(20) NOT NULL COMMENT &#39;å§“å&#39;, telnum varchar(11) COMMENT &#39;æ‰‹æœºå·ç &#39;, addr varchar(100) DEFAULT &#39;unknow address&#39; COMMENT &#39;åœ°å€&#39; ) ENGINE = innodb; æ·»åŠ ã€åˆ é™¤ç´¢å¼• ä¿®æ”¹åˆ—å æ·»åŠ åˆ— å¤åˆ¶è¡¨æ“ä½œ create table new_table like old_table; //ä»…å¤åˆ¶è¡¨ç»“æ„ create table new_table select column form old_table;//ä»…å¤åˆ¶è¡¨æ•°æ® truncate table table_name;//æ¸…ç©ºè¡¨(åˆ é™¤å†åˆ›å»º) delete from table;//ä»…åˆ é™¤æ•°æ® æ•°æ®ç±»å‹ä¸€ã€å€¼ç±»å‹ 1ã€æ•´å½¢ ç±»å‹ å­—èŠ‚ èŒƒå›´ int 4 -2^31~2^31-1 mediumint 3 -2^23~2^23-1 smallint 2 -2^15~2^15-1 tinyint 1 -2^7~2^7-1 bigint 8 -2^63~2^63-1 æ— ç¬¦å·æ•´æ•°ï¼ˆunsignedï¼‰ï¼Œæ— ç¬¦å·æ²¡æœ‰è´Ÿæ•°ï¼Œæ•´æ•°éƒ¨åˆ†æ˜¯æœ‰ç¬¦å·çš„ä¸¤å€ã€‚ mysql&gt; create table stu( -&gt; id smallint unsigned auto_increment primary key comment &#39;ä¸»é”®&#39;, -&gt; age tinyint unsigned not null comment &#39;å¹´é¾„&#39;, -&gt; money bigint unsigned comment &#39;å­˜æ¬¾&#39; -&gt; ); Query OK, 0 rows affected (0.01 sec) mysql&gt; desc stu; +-------+----------------------+------+-----+---------+----------------+ | Field | Type | Null | Key | Default | Extra | +-------+----------------------+------+-----+---------+----------------+ | id | smallint(5) unsigned | NO | PRI | NULL | auto_increment | | age | tinyint(3) unsigned | NO | | NULL | | | money | bigint(20) unsigned | YES | | NULL | | +-------+----------------------+------+-----+---------+----------------+ 3 rows in set (0.00 sec) mysql&gt; insert into stu values (null,5,11); Query OK, 1 row affected (0.00 sec) mysql&gt; select * from stu; +----+-----+-------+ | id | age | money | +----+-----+-------+ | 1 | 5 | 11 | +----+-----+-------+ 1 row in set (0.00 sec) mysql&gt; drop table stu; Query OK, 0 rows affected (0.01 sec) mysql&gt; create table stu( -&gt; id int(5), -&gt; age int(5) zerofill -&gt; ); Query OK, 0 rows affected (0.01 sec) mysql&gt; desc stu; +-------+--------------------------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +-------+--------------------------+------+-----+---------+-------+ | id | int(5) | YES | | NULL | | | age | int(5) unsigned zerofill | YES | | NULL | | +-------+--------------------------+------+-----+---------+-------+ 2 rows in set (0.00 sec) mysql&gt; insert into stu values(1,11); Query OK, 1 row affected (0.00 sec) mysql&gt; select * from stu; +------+-------+ | id | age | +------+-------+ | 1 | 00011 | +------+-------+ 1 row in set (0.00 sec) mysql&gt; insert into stu values(1111111,1111111); Query OK, 1 row affected (0.00 sec) mysql&gt; select * from stu; +---------+---------+ | id | age | +---------+---------+ | 1 | 00011 | | 1111111 | 1111111 | +---------+---------+ 2 rows in set (0.00 sec) 2ã€æµ®ç‚¹å‹ï¼ˆç²¾åº¦è¶…å‡ºåˆ™ä¼šå››èˆäº”å…¥ï¼Œç²¾ç¡®åº¦ä¼šä¸¢å¤±ï¼‰ æµ®ç‚¹å‹ å ç”¨å­—èŠ‚ èŒƒå›´ floatï¼ˆå•ç²¾åº¦ï¼‰ 4 -3.4E+38~3.4E+38 doubleï¼ˆåŒç²¾åº¦ï¼‰ 8 -1.8E+308~1.8E+308 æµ®ç‚¹æ•°å£°æ˜ï¼šfloat(M,D) double(M,D) M:æ€»ä½æ•° D:å°æ•°ä½æ•° mysql&gt; create table t1( -&gt; num1 float(5,2), -&gt; num2 double(4,1) -&gt; ); Query OK, 0 rows affected (0.02 sec) mysql&gt; insert into t1 values(1.23,1.23) -&gt; ; Query OK, 1 row affected (0.01 sec) mysql&gt; select * from t1; +------+------+ | num1 | num2 | +------+------+ | 1.23 | 1.2 | +------+------+ 1 row in set (0.00 sec) mysql&gt; insert into t1 values(1555.23,122222.23); ERROR 1264 (22003): Out of range value for column &#39;num1&#39; at row 1 mysql&gt; insert into t1 values(123.233336,12.23444); Query OK, 1 row affected (0.01 sec) mysql&gt; select * from t1; +--------+------+ | num1 | num2 | +--------+------+ | 1.23 | 1.2 | | 123.23 | 12.2 | +--------+------+ 2 rows in set (0.00 sec) mysql&gt; insert into t1 values(9.9999,9.999); Query OK, 1 row affected (0.00 sec) mysql&gt; select * from t1; +--------+-------+ | num1 | num2 | +--------+-------+ | 1.23 | 1.2 | | 123.23 | 12.2 | | 999.99 | 999.9 | | 10.00 | 10.0 | +--------+-------+ 4 rows in set (0.00 sec) 3ã€å®šç‚¹æ•°ï¼ˆç²¾åº¦ä¸ä¼šä¸¢å¤±ï¼‰ è¯­æ³•ï¼šdecimal(M,D) å®šç‚¹æ•°éƒ½æ˜¯å˜é•¿çš„ï¼Œå¤§è‡´æ¯9ä¸ªæ•°å­—ç”¨å››ä¸ªå­—èŠ‚æ¥å­˜å‚¨ã€‚å®šç‚¹æ•°ä¹‹æ‰€ä»¥èƒ½ä¿å­˜ç²¾ç¡®å°æ•°ï¼Œå› ä¸ºæ•´æ•°å’Œå°æ•°æ˜¯åˆ†å¼€å­˜å‚¨çš„ã€‚å ç”¨çš„èµ„æºæ¯”æµ®ç‚¹æ•°è¦å¤šã€‚ å®šç‚¹æ•°å’Œæµ®ç‚¹æ•°éƒ½æ”¯æŒæ˜¾ç¤ºå®½åº¦å’Œæ— ç¬¦å·æ•°ã€‚ mysql&gt; create table t4( -&gt; num decimal(20,19) -&gt; ); Query OK, 0 rows affected (0.01 sec) mysql&gt; insert into t4 values (1.1234567890123456789); Query OK, 1 row affected (0.00 sec) mysql&gt; select * from t4; +-----------------------+ | num | +-----------------------+ | 1.1234567890123456789 | +-----------------------+ 1 row in set (0.00 sec) äºŒã€å­—ç¬¦å‹ varcharï¼šå°äºç­‰äºè§„å®šçš„é•¿åº¦ï¼Œå›æ”¶å¤šä½™å­—ç¬¦ï¼ŒèŠ‚çœç©ºé—´ã€‚ charï¼šå°äºç­‰äºè§„å®šçš„é•¿åº¦ï¼Œä¸å›æ”¶å¤šä½™å­—ç¬¦ï¼Œæ‰§è¡Œæ•ˆç‡æ¯”å˜é•¿é«˜ã€‚ æ•°æ®ç±»å‹ æè¿° é•¿åº¦ char(é•¿åº¦) å®šé•¿ æœ€å¤§255 varchar(é•¿åº¦) å˜é•¿ æœ€å¤§65535ï¼ˆç†è®ºå€¼ï¼‰ tinytext å¤§æ®µæ–‡æœ¬ 2^8-1=255 text å¤§æ®µæ–‡æœ¬ 2^16-1=65535 mediumtext å¤§æ®µæ–‡æœ¬ 2^24-1 longtext å¤§æ®µæ–‡æœ¬ 2^32-1 mysql&gt; create table t3( -&gt; name varchar(10), -&gt; sex char(1) -&gt; ); Query OK, 0 rows affected (0.01 sec) mysql&gt; insert into t3(name) values(&#39;12345678900&#39;); ERROR 1406 (22001): Data too long for column &#39;name&#39; at row 1 mysql&gt; insert into t3(name) values(&#39;1234567890&#39;); Query OK, 1 row affected (0.00 sec) mysql&gt; select * from t3; +------------+------+ | name | sex | +------------+------+ | 1234567890 | NULL | +------------+------+ mysql&gt; insert into t3(name) values(&#39;123456&#39;); Query OK, 1 row affected (0.00 sec) mysql&gt; select * from t3; +------------+------+ | name | sex | +------------+------+ | 1234567890 | NULL | | 123456 | NULL | +------------+------+ 2 rows in set (0.00 sec) ä¸‰ã€æšä¸¾ï¼ˆenmuï¼‰ ä¼˜ç‚¹ï¼š è¿è¡Œé€Ÿåº¦å¿«ï¼ˆæ•°å­—æ¯”å­—ç¬¦ä¸²è¿ç®—é€Ÿåº¦å¿«ï¼‰ â€‹ é™åˆ¶æ•°æ® â€‹ èŠ‚çœç©ºé—´ mysql&gt; create table t5( -&gt; name varchar(20), -&gt; sex enum(&#39;ç”·&#39;,&#39;å¥³&#39;,&#39;ä¿å¯†&#39;) -&gt; ); Query OK, 0 rows affected (0.02 sec) mysql&gt; insert into t5 values(&#39;tom&#39;,&#39;ç”·&#39;); Query OK, 1 row affected (0.00 sec) mysql&gt; insert into t5 values(&#39;jim&#39;,&#39;å¥³&#39;); Query OK, 1 row affected (0.00 sec) mysql&gt; insert into t5 values(&#39;marry&#39;,&#39;æœªçŸ¥&#39;); ERROR 1265 (01000): Data truncated for column &#39;sex&#39; at row 1 #åªèƒ½æ’å…¥æšä¸¾å€¼ mysql&gt; insert into t5 values(&#39;yls&#39;,&#39;ä¿å¯†&#39;); Query OK, 1 row affected (0.00 sec) mysql&gt; select * from t5; +------+--------+ | name | sex | +------+--------+ | tom | ç”· | | jim | å¥³ | | yls | ä¿å¯† | +------+--------+ 3 rows in set (0.00 sec) mysql&gt; select sex+0 from t5; #å†…éƒ¨é€šè¿‡æ•°å­—å­˜å‚¨ +-------+ | sex+0 | +-------+ | 1 | | 2 | | 3 | +-------+ 3 rows in set (0.01 sec) mysql&gt; insert into t5 values(&#39;qss&#39;,&#39;3&#39;); #èƒ½ç›´æ¥æ’å…¥æ•°å­— Query OK, 1 row affected (0.01 sec) mysql&gt; select * from t5; +------+--------+ | name | sex | +------+--------+ | tom | ç”· | | jim | å¥³ | | yls | ä¿å¯† | | qss | ä¿å¯† | +------+--------+ 4 rows in set (0.00 sec) å››ã€é›†åˆï¼ˆsetï¼‰æœ€å¤š64ä¸ªé€‰é¡¹ mysql&gt; create table t6( -&gt; hobby set(&#39;çˆ¬å±±&#39;,&#39;è¯»ä¹¦&#39;,&#39;golang&#39;) -&gt; ); Query OK, 0 rows affected (0.02 sec) mysql&gt; insert into t6 values(&#39;çˆ¬å±±&#39;); Query OK, 1 row affected (0.00 sec) mysql&gt; insert into t6 values(&#39;çˆ¬å±±&#39;,&#39;è¯»ä¹¦&#39;); ERROR 1136 (21S01): Column count doesn&#39;t match value count at row 1 mysql&gt; insert into t6 values(&#39;çˆ¬å±±,è¯»ä¹¦&#39;); Query OK, 1 row affected (0.01 sec) mysql&gt; select * from t6; +---------------+ | hobby | +---------------+ | çˆ¬å±± | | çˆ¬å±±,è¯»ä¹¦ | +---------------+ 2 rows in set (0.00 sec) mysql&gt; insert into t6 values(&#39;è¯»ä¹¦,çˆ¬å±±&#39;); #æ’å…¥é¡ºåºä¸ä¸€æ ·ï¼Œä½†æ˜¯æ˜¾ç¤ºé¡ºåºä¼šä¸€æ ·ã€‚ Query OK, 1 row affected (0.01 sec) mysql&gt; select * from t6; +---------------+ | hobby | +---------------+ | çˆ¬å±± | | çˆ¬å±±,è¯»ä¹¦ | | çˆ¬å±±,è¯»ä¹¦ | +---------------+ 3 rows in set (0.00 sec) äº”ã€æ—¶é—´ç±»å‹ æ•°æ®ç±»å‹ æè¿° datetime æ—¥æœŸæ—¶é—´ï¼Œå ç”¨8ä¸ªå­—èŠ‚ date æ—¥æœŸï¼Œå ç”¨3ä¸ªå­—èŠ‚ time æ—¶é—´ï¼Œå ç”¨3ä¸ªå­—èŠ‚ timestamp æ—¶é—´æˆ³ï¼Œå ç”¨4ä¸ªå­—èŠ‚ year å¹´ä»½ï¼Œå ç”¨1ä¸ªå­—èŠ‚ 1ã€datetime æ ¼å¼ï¼šå¹´-æœˆ-æ—¥ å°æ—¶ï¼šåˆ†é’Ÿï¼šç§’ ï¼ˆèŒƒå›´ï¼š0001-9999å¹´ï¼‰ mysql&gt; create table t7( -&gt; field datetime -&gt; ); Query OK, 0 rows affected (0.01 sec) mysql&gt; insert into t7 values(&#39;2020-02-29 04:25:29&#39;); Query OK, 1 row affected (0.00 sec) mysql&gt; select * from t7; +---------------------+ | field | +---------------------+ | 2020-02-29 04:25:29 | +---------------------+ 1 row in set (0.00 sec) 2ã€date mysql&gt; create table t8( -&gt; field date -&gt; ); Query OK, 0 rows affected (0.01 sec) mysql&gt; insert into t8 values(&#39;2020-02-29&#39;); Query OK, 1 row affected (0.00 sec) mysql&gt; select * from t8; +------------+ | field | +------------+ | 2020-02-29 | +------------+ 1 row in set (0.00 sec) 3ã€timestampï¼ˆæ—¥æœŸå½¢å¼ï¼‰ 4ã€year æœ€å¤šåªèƒ½è¡¨ç¤º255ä¸ªå¹´ä»½ï¼ŒèŒƒå›´1901-2155 5ã€time è¡¨ç¤ºæ—¶é—´æˆ–è€…æ—¶é—´é—´éš” å…­ã€boolean mysql&gt; create table t9( -&gt; field boolean -&gt; ); Query OK, 0 rows affected (0.01 sec) mysql&gt; insert into t9 values (true),(false); Query OK, 2 rows affected (0.00 sec) Records: 2 Duplicates: 0 Warnings: 0 mysql&gt; select * from t9; +-------+ | field | +-------+ | 1 | | 0 | +-------+ 2 rows in set (0.00 sec) åˆ—å±æ€§(null | not null)default:é»˜è®¤å€¼ mysql&gt; create table t10( -&gt; id int unsigned, -&gt; addr varchar(20) not null default &#39;ä¸è¯¦&#39; -&gt; ); Query OK, 0 rows affected (0.01 sec) mysql&gt; insert into t10 values(1,&#39;æ­å·&#39;),(2,default); Query OK, 2 rows affected (0.01 sec) Records: 2 Duplicates: 0 Warnings: 0 mysql&gt; select * from t10; +------+--------+ | id | addr | +------+--------+ | 1 | æ­å· | | 2 | ä¸è¯¦ | +------+--------+ 2 rows in set (0.00 sec) auto_increment:auto_incrementå¿…é¡»æ˜¯ä¸»é”®ï¼Œä½†æ˜¯ä¸»é”®ä¸ä¸€å®šæ˜¯è‡ªå¢ã€‚ â€‹ ç»™è‡ªå¢åˆ—æ’å…¥æ•°æ®ï¼Œä½¿ç”¨nullå…³é”®å­—ã€‚ è‡ªå¢åˆ—ä¸Šçš„æ•°æ®è¢«åˆ é™¤ï¼Œé»˜è®¤æƒ…å†µä¸‹æ­¤è®°å½•ç¼–å·ä¸å†ä½¿ç”¨ã€‚å”¯ä¸€é”®ï¼š â€‹ ç‰¹ç‚¹ï¼šä¸èƒ½é‡å¤ï¼Œå¯ä»¥ä¸ºç©ºï¼ŒåŒä¸€å¼ è¡¨å¯ä»¥æ‹¥æœ‰å¤šä¸ªå”¯ä¸€é”® â€‹ ä½œç”¨ï¼šä¿è¯æ•°æ®ä¸èƒ½é‡å¤ï¼Œä¿è¯æ•°æ®å®Œæ•´æ€§ï¼ŒåŠ å¿«æ•°æ®è®¿é—® â€‹ æ·»åŠ å”¯ä¸€é”®ï¼š â€‹ mysql&gt; create table t14( -&gt; id int primary key, -&gt; name varchar(20) unique -&gt; ); Query OK, 0 rows affected (0.02 sec) ----------------------------------------------------------------------------------------------- mysql&gt; create table t15( -&gt; id int primary key, -&gt; name varchar(20) -&gt; ); Query OK, 0 rows affected (0.01 sec) mysql&gt; alter table t15 add unique(name); Query OK, 0 rows affected (0.01 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql&gt; desc t15; +-------+-------------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +-------+-------------+------+-----+---------+-------+ | id | int(11) | NO | PRI | NULL | | | name | varchar(20) | YES | UNI | NULL | | +-------+-------------+------+-----+---------+-------+ 2 rows in set (0.00 sec) ----------------------------------------------------------------------------------------------- mysql&gt; create table t16( -&gt; id int, -&gt; name varchar(20), -&gt; addr varchar(20) -&gt; ); Query OK, 0 rows affected (0.01 sec) mysql&gt; alter table t16 add unique(name),add unique(addr); Query OK, 0 rows affected (0.01 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql&gt; desc t16; +-------+-------------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +-------+-------------+------+-----+---------+-------+ | id | int(11) | YES | | NULL | | | name | varchar(20) | YES | UNI | NULL | | | addr | varchar(20) | YES | UNI | NULL | | +-------+-------------+------+-----+---------+-------+ 3 rows in set (0.00 sec) ----------------------------------------------------------------------------------------------- mysql&gt; create table t17( -&gt; id int, -&gt; name varchar(20), -&gt; addr varchar(20) -&gt; ); Query OK, 0 rows affected (0.01 sec) mysql&gt; alter table t16 add unique(name,addr); #nameã€addrç»„åˆæˆå”¯ä¸€é”® Query OK, 0 rows affected (0.01 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql&gt; desc t16; +-------+-------------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +-------+-------------+------+-----+---------+-------+ | id | int(11) | YES | | NULL | | | name | varchar(20) | YES | UNI | NULL | | | addr | varchar(20) | YES | UNI | NULL | | +-------+-------------+------+-----+---------+-------+ 3 rows in set (0.00 sec) â€‹ æŸ¥çœ‹å”¯ä¸€é”®ï¼š mysql&gt; show create table t15\\G *************************** 1. row *************************** Table: t15 Create Table: CREATE TABLE `t15` ( `id` int(11) NOT NULL, `name` varchar(20) DEFAULT NULL, PRIMARY KEY (`id`), UNIQUE KEY `name` (`name`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 1 row in set (0.00 sec) mysql&gt; show create table t16\\G *************************** 1. row *************************** Table: t16 Create Table: CREATE TABLE `t16` ( `id` int(11) DEFAULT NULL, `name` varchar(20) DEFAULT NULL, `addr` varchar(20) DEFAULT NULL, UNIQUE KEY `name` (`name`), UNIQUE KEY `addr` (`addr`), UNIQUE KEY `name_2` (`name`,`addr`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 1 row in set (0.00 sec) â€‹ åˆ é™¤å”¯ä¸€é”®: mysql&gt; show create table t16\\G *************************** 1. row *************************** Table: t16 Create Table: CREATE TABLE `t16` ( `id` int(11) DEFAULT NULL, `name` varchar(20) DEFAULT NULL, `addr` varchar(20) DEFAULT NULL, UNIQUE KEY `name` (`name`), UNIQUE KEY `addr` (`addr`), UNIQUE KEY `name_2` (`name`,`addr`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 1 row in set (0.00 sec) mysql&gt; alter table t16 drop index name_2; Query OK, 0 rows affected (0.02 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql&gt; show create table t16\\G *************************** 1. row *************************** Table: t16 Create Table: CREATE TABLE `t16` ( `id` int(11) DEFAULT NULL, `name` varchar(20) DEFAULT NULL, `addr` varchar(20) DEFAULT NULL, UNIQUE KEY `name` (`name`), UNIQUE KEY `addr` (`addr`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 1 row in set (0.00 sec) primary key: â€‹ å”¯ä¸€æ ‡è¯†è¡¨ä¸­è®°å½•çš„ä¸€ä¸ªæˆ–è€…ä¸€ç»„åˆ— â€‹ ä¸èƒ½é‡å¤ï¼Œä¸èƒ½ä¸ºç©º â€‹ ä¸€ä¸ªè¡¨åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®ï¼Œå¯ä»¥ç”±å¤šä¸ªå­—æ®µç»„æˆ â€‹ ä¿è¯æ•°æ®å®Œæ•´æ€§ï¼ŒåŠ å¿«æŸ¥è¯¢é€Ÿåº¦ é€‰æ‹©ä¸»é”®åŸåˆ™ï¼š â€‹ æ·»åŠ ä¸»é”®ï¼šmysql&gt; create table t11( -&gt; id varchar(5) primary key, -&gt; name varchar(10) not null -&gt; ); Query OK, 0 rows affected (0.01 sec) mysql&gt; insert into t11 values(&#39;s2531&#39;,&#39;tom&#39;),(&#39;s2532&#39;,&#39;berry&#39;); Query OK, 2 rows affected (0.00 sec) Records: 2 Duplicates: 0 Warnings: 0 mysql&gt; insert into t11 values(&#39;s2531&#39;,&#39;tom&#39;); ERROR 1062 (23000): Duplicate entry &#39;s2531&#39; for key &#39;PRIMARY&#39; mysql&gt; insert into t11 values(null,&#39;tom&#39;); ERROR 1048 (23000): Column &#39;id&#39; cannot be null æ·»åŠ ä¸»é”®çš„æ–¹æ³•mysql&gt; create table t11( -&gt; id varchar(5) primary key, -&gt; name varchar(10) not null -&gt; ); Query OK, 0 rows affected (0.02 sec) ----------------------------------------------------------------------------------------------- mysql&gt; create table t12( -&gt; id int, -&gt; name varchar(10), -&gt; primary key(id) -&gt; ); Query OK, 0 rows affected (0.02 sec) ----------------------------------------------------------------------------------------------- mysql&gt; create table t13( -&gt; id int, -&gt; name varchar(10) -&gt; ); Query OK, 0 rows affected (0.01 sec) mysql&gt; alter table t13 add primary key(id); Query OK, 0 rows affected (0.01 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql&gt; desc t13; +-------+-------------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +-------+-------------+------+-----+---------+-------+ | id | int(11) | NO | PRI | NULL | | | name | varchar(10) | YES | | NULL | | +-------+-------------+------+-----+---------+-------+ 2 rows in set (0.00 sec) åˆ é™¤ä¸»é”®ï¼šmysql&gt; alter table t13 drop primary key; Query OK, 0 rows affected (0.02 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql&gt; desc t13; +-------+-------------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +-------+-------------+------+-----+---------+-------+ | id | int(11) | NO | | NULL | | | name | varchar(10) | YES | | NULL | | +-------+-------------+------+-----+---------+-------+ 2 rows in set (0.00 sec) æ•°æ®å®Œæ•´æ€§å¼•ç”¨å®Œæ•´æ€§ å¤–é”® mysql&gt; create table stuinfo( -&gt; stunum char(4) primary key, -&gt; name varchar(10) not null -&gt; ); Query OK, 0 rows affected (0.01 sec) mysql&gt; create table stumarks( -&gt; stuid char(4) primary key, -&gt; score tinyint unsigned, -&gt; foreign key (stuid) references stuinfo(stunum) -&gt; ); Query OK, 0 rows affected (0.01 sec) ----------------------------------------------------------------------------------------------- mysql&gt; insert into stumarks values(&#39;s101&#39;,88); ERROR 1452 (23000): Cannot add or update a child row: a foreign key constraint fails (`school`.`stumarks`, CONSTRAINT `stumarks_ibfk_1` FOREIGN KEY (`stuid`) REFERENCES `stuinfo` (`stunum`)) /* ä¸»è¡¨ä¸­ä¸å­˜åœ¨s101ï¼Œä»è¡¨æ˜¯æ— æ³•æ’å…¥çš„ */ mysql&gt; insert into stuinfo values(&#39;s101&#39;,&#39;tom&#39;); Query OK, 1 row affected (0.00 sec) mysql&gt; insert into stumarks values(&#39;s101&#39;,88); Query OK, 1 row affected (0.00 sec) ----------------------------------------------------------------------------------------------- mysql&gt; delete from stuinfo where stunum=&#39;s101&#39;; ERROR 1451 (23000): Cannot delete or update a parent row: a foreign key constraint fails (`school`.`stumarks`, CONSTRAINT `stumarks_ibfk_1` FOREIGN KEY (`stuid`) REFERENCES `stuinfo` (`stunum`)) mysql&gt; delete from stumarks where stuid=&#39;s101&#39;; Query OK, 1 row affected (0.00 sec) mysql&gt; delete from stuinfo where stunum=&#39;s101&#39;; Query OK, 1 row affected (0.01 sec) /*åˆ é™¤ä¸»è¡¨çš„æ•°æ®å¿…é¡»å…ˆåˆ é™¤ä»è¡¨ä¸­çš„å¯¹åº”æ•°æ®*/ ----------------------------------------------------------------------------------------------- mysql&gt; drop table stumarks; Query OK, 0 rows affected (0.00 sec) mysql&gt; drop table stuinfo; Query OK, 0 rows affected (0.00 sec) mysql&gt; create table stuinfo( -&gt; stunum char(4) primary key, -&gt; name varchar(10) not null -&gt; ); Query OK, 0 rows affected (0.01 sec) mysql&gt; create table stumarks( -&gt; stuid char(4) primary key, -&gt; score tinyint unsigned -&gt; ); Query OK, 0 rows affected (0.01 sec) mysql&gt; alter table stumarks add foreign key(stuid) references stuinfo(stunum); Query OK, 0 rows affected (0.02 sec) Records: 0 Duplicates: 0 Warnings: 0 /*ä¿®æ”¹è¡¨çš„æ—¶å€™æ·»åŠ å¤–é”®*/ ----------------------------------------------------------------------------------------------- mysql&gt; show create table stumarks\\G *************************** 1. row *************************** Table: stumarks Create Table: CREATE TABLE `stumarks` ( `stuid` char(4) NOT NULL, `score` tinyint(3) unsigned DEFAULT NULL, PRIMARY KEY (`stuid`), CONSTRAINT `stumarks_ibfk_1` FOREIGN KEY (`stuid`) REFERENCES `stuinfo` (`stunum`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 1 row in set (0.00 sec) mysql&gt; alter table stumarks drop foreign key stumarks_ibfk_1; Query OK, 0 rows affected (0.01 sec) Records: 0 Duplicates: 0 Warnings: 0 /*åˆ é™¤å¤–é”®*/ ----------------------------------------------------------------------------------------------- mysql&gt; create table stuinfo( -&gt; stunum char(4) primary key, -&gt; name varchar(10) not null -&gt; ); Query OK, 0 rows affected (0.01 sec) mysql&gt; create table stumarks( -&gt; stuid int auto_increment primary key, -&gt; stunum char(4), -&gt; score tinyint unsigned, -&gt; foreign key (stunum) references stuinfo(stunum) on delete set null on update cascade -&gt; ); Query OK, 0 rows affected (0.01 sec) mysql&gt; insert into stuinfo values(&#39;100&#39;,tom); ERROR 1054 (42S22): Unknown column &#39;tom&#39; in &#39;field list&#39; mysql&gt; insert into stuinfo values(&#39;100&#39;,&#39;tom&#39;); Query OK, 1 row affected (0.00 sec) mysql&gt; insert into stumarks values(null,&#39;100&#39;,88); Query OK, 1 row affected (0.00 sec) mysql&gt; select * from stuinfo; +--------+------+ | stunum | name | +--------+------+ | 100 | tom | +--------+------+ 1 row in set (0.00 sec) mysql&gt; select * from stumarks; +-------+--------+-------+ | stuid | stunum | score | +-------+--------+-------+ | 1 | 100 | 88 | +-------+--------+-------+ 1 row in set (0.00 sec) mysql&gt; update stuinfo set stunum=&#39;101&#39; where stunum=&#39;100&#39;; Query OK, 1 row affected (0.00 sec) Rows matched: 1 Changed: 1 Warnings: 0 mysql&gt; select * from stumarks; +-------+--------+-------+ | stuid | stunum | score | +-------+--------+-------+ | 1 | 101 | 88 | +-------+--------+-------+ 1 row in set (0.00 sec) mysql&gt; delete from stuinfo where stunum=&#39;101&#39;; Query OK, 1 row affected (0.00 sec) mysql&gt; select * from stuinfo; Empty set (0.00 sec) mysql&gt; select * from stumarks; +-------+--------+-------+ | stuid | stunum | score | +-------+--------+-------+ | 1 | NULL | 88 | +-------+--------+-------+ 1 row in set (0.00 sec) /*çº§è”æ“ä½œï¼šå½“ä¸»è¡¨ä¸­çš„æ•°æ®åˆ é™¤æ˜¯ï¼Œä»è¡¨ä¸­å¯¹åº”çš„è®°å½•ç½®ç©ºï¼›æ›´æ–°æ—¶ä¹Ÿå¯¹åº”æ›´æ–°*/ /*in ã€not in*/ mysql&gt; select id,truename as &#39;å§“å&#39;,idcard from xb_mem_info where id not in (10,330,499,331) limit 5; +----+-----------+--------------------+ | id | å§“å | idcard | +----+-----------+--------------------+ | 1 | 5990 | NULL | | 3 | è”¡ä¼Ÿä¼˜ | 360727198706152011 | | 4 | é»„æ° | 360727199108280093 | | 5 | è°­è¾‰é‡‘ | 360729199606260020 | | 6 | é»„ç¾éœ | 36072719870519202X | +----+-----------+--------------------+ 5 rows in set (0.01 sec) mysql&gt; select id,truename as &#39;å§“å&#39;,idcard from xb_mem_info where id in (10,330,499,331) limit 5; +-----+-----------+--------------------+ | id | å§“å | idcard | +-----+-----------+--------------------+ | 10 | è”¡ç´ å | 360727198902202020 | | 330 | 9375 | NULL | | 331 | 2782 | NULL | | 499 | é™ˆä¹¦èŠ¹ | 410727197812236921 | +-----+-----------+--------------------+ 4 rows in set (0.00 sec) ----------------------------------------------------------------------------------------------- /*betweenã€not between*/ mysql&gt; select id,truename,idcard from xb_mem_info where id between 10 and 15 limit 6; +----+-----------+--------------------+ | id | truename | idcard | +----+-----------+--------------------+ | 10 | è”¡ç´ å | 360727198902202020 | | 11 | 5729 | NULL | | 12 | é™ˆå¥é¾™ | 500226199001052237 | | 13 | 3330 | NULL | | 14 | ç‹å¿ è¯š | 500381199401114118 | | 15 | è«é» | 511025198608230010 | +----+-----------+--------------------+ 6 rows in set (0.00 sec) mysql&gt; select id,truename,idcard from xb_mem_info where id not between 10 and 15 limit 6; +----+-----------+--------------------+ | id | truename | idcard | +----+-----------+--------------------+ | 1 | 5990 | NULL | | 3 | è”¡ä¼Ÿä¼˜ | 360727198706152011 | | 4 | é»„æ° | 360727199108280093 | | 5 | è°­è¾‰é‡‘ | 360729199606260020 | | 6 | é»„ç¾éœ | 36072719870519202X | | 7 | é»„ç‡•èŠ³ | 360727199309232020 | +----+-----------+--------------------+ 6 rows in set (0.00 sec) ----------------------------------------------------------------------------------------------- /*is nullã€is not null*/ mysql&gt; select id,truename,idcard from xb_mem_info where idcard is null limit 10; +----+----------+--------+ | id | truename | idcard | +----+----------+--------+ | 1 | 5990 | NULL | | 11 | 5729 | NULL | | 13 | 3330 | NULL | | 17 | 1468 | NULL | | 20 | NULL | NULL | | 21 | 9474 | NULL | | 22 | 5469 | NULL | | 23 | 9453 | NULL | | 25 | 2643 | NULL | | 26 | 4491 | NULL | +----+----------+--------+ 10 rows in set (0.00 sec) mysql&gt; select id,truename,idcard from xb_mem_info where idcard is not null limit 10; +----+-----------+--------------------+ | id | truename | idcard | +----+-----------+--------------------+ | 3 | è”¡ä¼Ÿä¼˜ | 360727198706152011 | | 4 | é»„æ° | 360727199108280093 | | 5 | è°­è¾‰é‡‘ | 360729199606260020 | | 6 | é»„ç¾éœ | 36072719870519202X | | 7 | é»„ç‡•èŠ³ | 360727199309232020 | | 8 | ç‹ç»åª› | 360732199709234122 | | 9 | åˆ˜åˆ©ç›› | 360727198907082013 | | 10 | è”¡ç´ å | 360727198902202020 | | 12 | é™ˆå¥é¾™ | 500226199001052237 | | 14 | ç‹å¿ è¯š | 500381199401114118 | +----+-----------+--------------------+ 10 rows in set (0.00 sec) ----------------------------------------------------------------------------------------------- /*sum()*/ mysql&gt; select sum(id) from xb_mem_info; +----------+ | sum(id) | +----------+ | 60856657 | +----------+ 1 row in set (0.01 sec) ----------------------------------------------------------------------------------------------- /*avg()*/ mysql&gt; select avg(idcard) from xb_mem_info; +----------------------+ | avg(idcard) | +----------------------+ | 3.556618801202589e17 | +----------------------+ 1 row in set, 789 warnings (0.01 sec) ----------------------------------------------------------------------------------------------- /*max()*/ mysql&gt; select max(idcard) from xb_mem_info; +--------------------+ | max(idcard) | +--------------------+ | 659001199107054831 | +--------------------+ 1 row in set (0.00 sec) ----------------------------------------------------------------------------------------------- /*min*/ mysql&gt; select min(idcard) from xb_mem_info; +--------------------+ | min(idcard) | +--------------------+ | 110101198112240038 | +--------------------+ 1 row in set (0.01 sec) ----------------------------------------------------------------------------------------------- /*count()*/ mysql&gt; select count(*) from xb_mem_info; +----------+ | count(*) | +----------+ | 11029 | +----------+ 1 row in set (0.00 sec) mysql&gt; select count(1) from xb_mem_info; +----------+ | count(1) | +----------+ | 11029 | +----------+ 1 row in set (0.00 sec) æ‰§è¡Œæ•ˆç‡ä¸Šï¼š åˆ—åä¸ºä¸»é”®ï¼Œcount(åˆ—å)ä¼šæ¯”count(1)å¿« åˆ—åä¸ä¸ºä¸»é”®ï¼Œcount(1)ä¼šæ¯”count(åˆ—å)å¿« å¦‚æœè¡¨å¤šä¸ªåˆ—å¹¶ä¸”æ²¡æœ‰ä¸»é”®ï¼Œåˆ™ countï¼ˆ1ï¼‰ çš„æ‰§è¡Œæ•ˆç‡ä¼˜äº countï¼ˆ*ï¼‰ å¦‚æœæœ‰ä¸»é”®ï¼Œåˆ™ select countï¼ˆä¸»é”®ï¼‰çš„æ‰§è¡Œæ•ˆç‡æ˜¯æœ€ä¼˜çš„ å¦‚æœè¡¨åªæœ‰ä¸€ä¸ªå­—æ®µï¼Œåˆ™ select countï¼ˆ*ï¼‰æœ€ä¼˜ã€‚ https://blog.csdn.net/iFuMI/article/details/77920767 ---------------------------------------------------------------------------------------- /*order by*/ mysql&gt; select id,truename,idcard from xb_mem_info where idcard is not null order by idcard limit 10; +------+-----------+--------------------+ | id | truename | idcard | +------+-----------+--------------------+ | 8847 | æ›¹ç£Š | 110101198112240038 | | 6870 | ææ›Œ | 11010119870608102X | | 6854 | éƒ­æ€é…‰ | 11010119930224451X | | 934 | åˆ˜æ™¨æ™ | 110102197902222725 | | 1190 | æ¨å®½ | 110102198007070432 | | 7085 | ç‹ç’ | 110102198103131530 | | 5252 | æ¨é›¨ | 110102198806162405 | | 3243 | éœå»º | 110103197801230650 | | 7744 | å­Ÿé¾™ | 110103198712181214 | | 5967 | ä½•æ— | 110104196302251256 | +------+-----------+--------------------+ 10 rows in set (0.00 sec) mysql&gt; select id,truename,idcard from xb_mem_info where idcard is not null order by idcard desc limit 10; +-------+-------------------------+--------------------+ | id | truename | idcard | +-------+-------------------------+--------------------+ | 3671 | æ¨å…ˆé”‹ | 659001199107054831 | | 7297 | å­™æ­£é’° | 65900119910511161X | | 5523 | å­Ÿè•Š | 659001198612115725 | | 2194 | èƒ¡å®‰Â·å·´åˆå¤åˆ«å…‹ | 654301199308090013 | | 10193 | å“ˆé‡Œå“ˆä»€Â·èƒ¡æ²™å›  | 654301198405201868 | | 912 | æ™æ°¸åº· | 65422219980303391X | | 6237 | å“ˆä¾é‚£å°”Â·å¶å°”è‚¯ | 654221199506131437 | | 1598 | åˆ˜æ´‹ | 65420219950519631X | | 9606 | éƒ­ç‰å¿  | 654123198710133299 | | 2521 | å±ˆè£å…° | 654122198810251325 | +-------+-------------------------+--------------------+ 10 rows in set (0.01 sec) ---------------------------------------------------------------------------------------- /*group by*/ mysql&gt; select * from test; +----+-----------+------+------+ | id | name | sex | age | +----+-----------+------+------+ | 1 | è”¡ä¼Ÿä¼˜ | ç”· | 33 | | 2 | é»„æ° | ç”· | 29 | | 3 | è°­è¾‰é‡‘ | ç”· | 24 | | 4 | é»„ç¾éœ | å¥³ | 30 | | 5 | é»„ç‡•èŠ³ | å¥³ | 27 | +----+-----------+------+------+ 5 rows in set (0.00 sec) mysql&gt; select avg(age) as avg_age,sex from test group by sex; +---------+------+ | avg_age | sex | +---------+------+ | 28.6667 | ç”· | | 28.5000 | å¥³ | +---------+------+ 2 rows in set (0.00 sec) ---------------------------------------------------------------------------------------- /*distinct*/ select distinct name from test; ---------------------------------------------------------------------------------------- /*å†…è¿æ¥ï¼šinner join*/ â‘ ï¼šselect column from t1 inner join t2 on t1.commen_column=t2.commen_column; â‘¡ï¼šselect column from t1,t2 where t1.commen_column=t2.commen_column; â‘¢ï¼šselect from t1 inner join t2 on t1.commen_column=t2.commen_column inner join t3 on t2.commen_column=t3.commen_column; ---------------------------------------------------------------------------------------- /*å·¦å¤–è¿æ¥ï¼šleft join*/ select column from t1 left join t2 on t1.commen_column=t2.commen_column; ---------------------------------------------------------------------------------------- /*æ·»åŠ ç´¢å¼•*/ mysql&gt; desc stu; +-------+--------------------------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +-------+--------------------------+------+-----+---------+-------+ | id | int(5) | YES | | NULL | | | age | int(5) unsigned zerofill | YES | | NULL | | +-------+--------------------------+------+-----+---------+-------+ 2 rows in set (0.00 sec) mysql&gt; create index idx_id on stu(id); # Query OK, 0 rows affected (0.03 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql&gt; show index from stu; +-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+ | Table | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | +-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+ | stu | 1 | idx_id | 1 | id | A | 2 | NULL | NULL | YES | BTREE | | | +-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+ 1 row in set (0.00 sec) ---------------------------------------------------------------------------------------- /*æ·»åŠ ç´¢å¼•*/ mysql&gt; desc t10; +-------+------------------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +-------+------------------+------+-----+---------+-------+ | id | int(10) unsigned | YES | | NULL | | | addr | varchar(20) | NO | | ä¸è¯¦ | | +-------+------------------+------+-----+---------+-------+ 2 rows in set (0.00 sec) mysql&gt; show index from t10; Empty set (0.00 sec) mysql&gt; alter table t10 add index idx_addr(addr); Query OK, 0 rows affected (0.01 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql&gt; show index from t10; +-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+ | Table | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | +-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+ | t10 | 1 | idx_addr | 1 | addr | A | 2 | NULL | NULL | | BTREE | | | +-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+ 1 row in set (0.00 sec) ---------------------------------------------------------------------------------------- /*åˆ›å»ºè¡¨æ—¶æ·»åŠ ç´¢å¼•*/ mysql&gt; create table t18( -&gt; id int, -&gt; name varchar(10), -&gt; index idx_name (name) -&gt; ); Query OK, 0 rows affected (0.01 sec) mysql&gt; show index from t18; +-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+ | Table | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | +-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+ | t18 | 1 | idx_name | 1 | name | A | 0 | NULL | NULL | YES | BTREE | | | +-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+ 1 row in set (0.00 sec) mysql&gt; drop index idx_name on t18; /*åˆ é™¤ç´¢å¼•*/ Query OK, 0 rows affected (0.02 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql&gt; show index from t18; Empty set (0.00 sec) /*å”¯ä¸€ç´¢å¼•*/ create unique index index_name table_name (column_name); alter table table_name add unqiue index index_name (column) ---------------------------------------------------------------------------------------- /*rand()*/ mysql&gt; select truename from xb_mem_info order by rand() limit 5; //éšæœºå–å€¼ +-----------+ | truename | +-----------+ | æ¨æ˜Œé¾™ | | é«˜èƒœå…µ | | é™†æƒ ç² | | çŸ³å…´ | | 1108 | +-----------+ 5 rows in set (0.01 sec) mysql&gt; select truename from xb_mem_info order by rand() limit 5; +-----------+ | truename | +-----------+ | é™ˆå¸¸å | | å´å®¾å®¾ | | åˆ˜å®æ–Œ | | 8011 | | æ¼†è‰³ç² | +-----------+ 5 rows in set (0.02 sec) mysql&gt; select truename from xb_mem_info order by rand() limit 5; +-----------+ | truename | +-----------+ | å¼ é›¨ | | å½­å®æ‰¬ | | æ–½æ ‘ä¼Ÿ | | æ˜“äºšå¹³ | | é™ˆæ³³å¸Œ | +-----------+ 5 rows in set (0.02 sec) title: jQueryå¯¹è¡¨å•çš„æ“ä½œåŠæ›´å¤šåº”ç”¨date: 2017-05-26 12:12:57categories: test","categories":[{"name":"mysql","slug":"mysql","permalink":"http://blog.3amupupup.online/categories/mysql/"}],"tags":[{"name":"sql_base","slug":"sql-base","permalink":"http://blog.3amupupup.online/tags/sql-base/"}]},{"title":"sql","slug":"sql","date":"2021-03-18T03:09:52.060Z","updated":"2021-03-18T03:09:52.061Z","comments":true,"path":"2021/03/18/sql/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/sql/","excerpt":"","text":"SELECT count(*) AS aggregate FROM bookrack WHERE book_id = ? AND created_at BETWEEN ? AND ? SELECT sum(price) AS aggregate FROM kuai_order_relation WHERE app_type = ? AND status = ? AND link_id != ? AND updated_at &lt;= ? SELECT count(*) AS aggregate FROM kuai_device_id WHERE app_type = ? AND link_id != ? SELECT * FROM push_newchapter WHERE created_at BETWEEN ? AND ? SELECT * FROM push_welfare WHERE created_at BETWEEN ? AND ? SELECT count(*) AS aggregate FROM kuai_device_id WHERE created_at BETWEEN ? AND ? AND adid IN (?) SELECT sum(cost) AS cost, adgroup_id, name FROM gdt_cost_hourly WHERE hourly &gt;= ? GROUP BY adgroup_id SELECT count(user_name) AS count, sum(price) AS price, appflags FROM third_party_order WHERE appflags IN (?) AND status = ? GROUP BY appflags SELECT user_id, book_name, bookrack.book_id, bookrack.chapte_id, bookrack.updated_at FROM bookrack LEFT JOIN book ON book.id = bookrack.book_id WHERE bookrack.updated_at BETWEEN ? AND ? AND book.is_shelves = ? AND book.id IN (?) GROUP BY user_id ORDER BY bookrack.updated_at DESC SELECT id FROM user WHERE created_at BETWEEN ? AND ?","categories":[],"tags":[]},{"title":"kubectl","slug":"kubectl","date":"2021-03-18T03:09:52.057Z","updated":"2021-03-18T03:09:52.059Z","comments":true,"path":"2021/03/18/kubectl/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/kubectl/","excerpt":"","text":"kubectlå‘½ä»¤æŠ€å·§: å¹³æ»‘æ›´æ–°éƒ¨ç½²ï¼ˆæ»šåŠ¨æ›´æ–°ï¼‰ã€‚ç›¸å½“äºé˜¿é‡Œäº‘çš„å®¹å™¨æœåŠ¡é‡Œçš„è§¦å‘å™¨ï¼Œè§¦å‘æ›´æ–°ã€‚kubectl -n vk rollout restart deployment workerman","categories":[{"name":"k8s","slug":"k8s","permalink":"http://blog.3amupupup.online/categories/k8s/"}],"tags":[{"name":"kubectl","slug":"kubectl","permalink":"http://blog.3amupupup.online/tags/kubectl/"}]},{"title":"cé™·é˜±ä¸ç¼ºé™·","slug":"cé™·é˜±ä¸ç¼ºé™·","date":"2021-03-18T03:09:52.054Z","updated":"2021-03-18T03:09:52.055Z","comments":true,"path":"2021/03/18/cé™·é˜±ä¸ç¼ºé™·/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/c%E9%99%B7%E9%98%B1%E4%B8%8E%E7%BC%BA%E9%99%B7/","excerpt":"","text":"1.5 å­—ç¬¦ä¸å­—ç¬¦ä¸² ç”¨å•å¼•å·å¼•èµ·çš„ä¸€ä¸ªå­—ç¬¦å®é™…ä¸Šä»£è¡¨ä¸€ä¸ªè¯ä¹¦ï¼Œæ•´æ•°å€¼å¯¹åº”äºè¯¥å­—ç¬¦åœ¨ç¼–è¯‘å™¨é‡‡ç”¨çš„å­—ç¬¦é›†ä¸­çš„åºåˆ—å€¼ã€‚ ç”¨åŒå¼•å·å¼•èµ·çš„å­—ç¬¦ä¸²ï¼Œä»£è¡¨çš„æ˜¯æŒ‡å‘ä¸€ä¸ªæ— åæ•°ç»„èµ·å§‹å­—ç¬¦çš„æŒ‡é’ˆã€‚ 2.1 ç†è§£å‡½æ•°å£°æ˜ float *g(), (*h)(); /* ()çš„ä¼˜å…ˆçº§æ¯”*é«˜ï¼Œ*g()ç­‰ä»·äº*(g()): gæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°çš„è¿”å›å€¼æ—¶ä¸€ä¸ªæŒ‡å‘æµ®ç‚¹æ•°çš„æŒ‡é’ˆã€‚ (*h)(): hæ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œè¿”å›å€¼æ—¶æµ®ç‚¹æ•°ç±»å‹ã€‚ (float (*)())è¡¨ç¤ºä¸€ä¸ªâ€œæŒ‡å‘è¿”å›å€¼ä¸ºæµ®ç‚¹ç±»å‹çš„å‡½æ•°çš„æŒ‡é’ˆâ€çš„ç±»å‹è½¬æ¢ç¬¦ã€‚ */ ((void()())0)(); /* (fp)() fpæ˜¯ä¸ªæŒ‡é’ˆ fp æ›¿æ¢ (void()())0 0å¼ºåˆ¶ç±»å‹è½¬æ¢æˆä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œè¯¥å‡½æ•°æ— è¿”å›å€¼æ— å‚æ•° */ void sigfunc(int); /* å£°æ˜ä¸€ä¸ªæŒ‡å‘sigfuncå‡½æ•°çš„æŒ‡é’ˆå˜é‡ï¼švoid (*psf)(int) */","categories":[],"tags":[]},{"title":"Nginx","slug":"Nginx","date":"2021-03-18T03:09:52.053Z","updated":"2021-03-18T03:09:52.053Z","comments":true,"path":"2021/03/18/Nginx/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/Nginx/","excerpt":"","text":"åˆè¯†nginxnginx å‘½ä»¤è¡Œ: æŒ‡ä»¤ åŠŸèƒ½ -c æŒ‡å®šä½¿ç”¨çš„é…ç½®æ–‡ä»¶ -t -T æ£€æŸ¥é…ç½®æ–‡ä»¶è¯­æ³• -g æŒ‡å®šé…ç½®æŒ‡ä»¤ -p æŒ‡å®šè¿è¡Œç›®å½• -v -V æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯ã€ç¼–è¯‘å‚æ•° -s å‘é€ä¿¡å·[reload|stop|quit|reopen(é‡æ–°æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶è®°å½•æ—¥å¿—)] nginxçƒ­éƒ¨ç½²: was é‡æ–°ç¼–è¯‘nginxç”Ÿæˆnginx(new)äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç¼–è¯‘å‚æ•°åœ¨åŸæ¥çš„åŸºç¡€ä¸Šæ·»åŠ ã€‚ å¤‡ä»½nginx(old)ï¼Œç”¨nginx(new)äºŒè¿›åˆ¶æ–‡ä»¶è¦†ç›–nginx(old)äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ æ‰¾å‡ºnginx(old)çš„masterè¿›ç¨‹çš„pidï¼Œkill -USR2 pidã€‚(nginxä¼šä½¿ç”¨nginx(new)äºŒè¿›åˆ¶æ–‡ä»¶å¯åŠ¨ï¼Œæ­¤æ—¶ps aux |grep nginxä¼šçœ‹è§ä¸¤ä¸ªmasterè¿›ç¨‹) kill -WINCH old_nginx_pidï¼Œæ—§ç‰ˆæœ¬çš„workerè¿›ç¨‹ä¼šä¼˜é›…ç»“æŸï¼Œmasterè¿›ç¨‹ä»ç„¶åœ¨è¿è¡Œ(å‡ºç°æ„å¤–æ—¶ï¼Œèƒ½å¤Ÿå›é€€ç‰ˆæœ¬)ã€‚ nginxé…ç½®æ–‡ä»¶æŒ‡ä»¤:gzip on; gzip_min_length 1;å½“å‘é€çš„å†…å®¹å°äº1å­—èŠ‚æ—¶å°±ä¸è¿›è¡Œå‹ç¼© gzip_comp_level 2;å‹ç¼©çº§åˆ«ï¼Œçº§åˆ«è¶Šé«˜è¶ŠæŸè€—æ€§èƒ½ gzip_types text/plain application/x-javascript text/css application/xml text/javascript image/jpg image/gig image/png;å‹ç¼©å¯¹è±¡ autoindex on;æ˜¾ç¤ºç½‘ç«™æ ¹ç›®å½•ç»“æ„(eg:ä¸‹è½½) set $limit_rate 1k;é™åˆ¶å‘é€åˆ°clientçš„é€Ÿåº¦(æ¯ç§’1k) access_log /data/wwwlogs/access.log main;è®°å½•nginxçš„è®¿é—®æ—¥å¿—,mainæ˜¯log_formatéœ€è¦è‡ªå·±æ ¹æ®éœ€æ±‚å®šä¹‰ proxy_cache_path /tmp/nginxcache levels=1:2 keys_zone=my_cache:10m max_size=10g inactive=60m use_temp_path off; upstream test { server ip:port; server ip:port; ... } server{ location / { proxy_cache my_cache;ä½¿ç”¨cache proxy_cache_key $host$uri$is_arges$arges; proxy_cache_valid 200 304 302 1d; proxy_set_header Host $host;ä¼ header proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_pass http://test; åå‘ä»£ç† } } nginxæ¶æ„è¿›ç¨‹ç»“æ„å¤šè¿›ç¨‹æ¨¡å¼ï¼Œmaster &amp; slaveï¼ˆmasterç®¡ç†å­è¿›ç¨‹ï¼‰ nginxè¿›ç¨‹ç®¡ç†ï¼šä¿¡å·masterè¿›ç¨‹ï¼š ç›‘æ§workè¿›ç¨‹â€”â€”CHLDä¿¡å·ï¼ˆlinuxä¸­å­è¿›ç¨‹é€€å‡ºæ—¶ä¼šå‘é€CHLDä¿¡å·ç»™çˆ¶è¿›ç¨‹ï¼Œå½“nginxå­è¿›ç¨‹é€€å‡ºæ—¶masterè¿›ç¨‹ä¼šæ”¶åˆ°CHLDä¿¡å·ï¼Œå°†å­è¿›ç¨‹é‡æ–°æ‹‰èµ·ï¼‰ æ¥å—ä¿¡å·ï¼šTERM ï¼ŒINTï¼ˆç«‹å³é€€å‡ºï¼Œstopï¼‰ï¼›QUITï¼ˆä¼˜é›…é€€å‡ºï¼Œquitï¼‰ï¼›HUPï¼ˆé‡è½½é…ç½®æ–‡ä»¶ï¼Œreloadï¼‰ï¼›USR1ï¼ˆé‡æ–°æ‰“å¼€æ—¥å¿—æ–‡ä»¶ï¼Œreopenï¼‰ï¼› workerè¿›ç¨‹ï¼šTERM ï¼ŒINTï¼›QUITï¼›USR1ï¼›WINCHreloadçœŸç›¸â‘  å‘masterè¿›ç¨‹å‘é€HUPä¿¡å·ï¼ˆreloadå‘½ä»¤ï¼‰ã€‚ â‘¡ masterè¿›ç¨‹æ ¡éªŒé…ç½®æ–‡ä»¶è¯­æ³•çš„æ­£ç¡®æ€§ã€‚ â‘¢ masterè¿›ç¨‹æ‰“å¼€æ–°çš„ç›‘å¬ç«¯å£ã€‚ â‘£ masterè¿›ç¨‹ç”¨æ–°é…ç½®å¯åŠ¨workerè¿›ç¨‹ã€‚ â‘¤ masterå‘è€çš„workerè¿›ç¨‹å‘é€QUITä¿¡å·ã€‚ â‘¥ è€workerè¿›ç¨‹å…³é—­ç›‘å¬å¥æŸ„ï¼Œå¤„ç†å®Œå½“å‰è¿æ¥ä¹‹åç»“æŸè¿›ç¨‹ã€‚ æ³¨ï¼šå¦‚æœé‡è½½ä¸­workerè¿›ç¨‹ç”±äºæŸäº›åŸå› æ— æ³•æ­£å¸¸é€€å‡ºï¼Œå°±ä¼šä¸€ç›´å ç”¨ç³»ç»Ÿèµ„æºï¼Œå¯ä»¥é€šè¿‡worker_shutdown_timeoutæŒ‡ä»¤è®¾ç½®workerè¿›ç¨‹é€€å‡ºçš„æœ€å¤§ç­‰å¾…æ—¶é—´ã€‚ workerè¿›ç¨‹çš„ä¼˜é›…å…³é—­ï¼ˆé’ˆå¯¹httpè¯·æ±‚ï¼‰â‘  è®¾ç½®å®šæ—¶å™¨ï¼ˆworker_shutdown_timeoutï¼‰ã€‚ â‘¡ å…³é—­ç›‘å¬å¥æŸ„ã€‚ï¼ˆä¿è¯workerè¿›ç¨‹ä¸ä¼šå†æ¥å—æ–°çš„è¿æ¥è¯·æ±‚ï¼‰ â‘¢ å…³é—­ç©ºé—²é“¾æ¥ã€‚ â‘£ åœ¨å¾ªç¯ä¸­ç­‰å¾…å…¨éƒ¨è¿æ¥å…³é—­ã€‚ï¼ˆå¦‚æœè®¾ç½®äº†worker_shutdown_timeoutï¼Œé‚£ä¹ˆå³ä½¿è¿æ¥æ²¡æœ‰å¤„ç†å®Œä¹Ÿä¼šå¼ºè¡Œå…³é—­ï¼‰ â‘¤ é€€å‡ºè¿›ç¨‹ã€‚ nginxäº‹ä»¶é©±åŠ¨æ¨¡å‹ epollçš„ä¼˜åŠ£åŠ¿åŠåŸç†","categories":[{"name":"è¿ç»´","slug":"è¿ç»´","permalink":"http://blog.3amupupup.online/categories/%E8%BF%90%E7%BB%B4/"}],"tags":[{"name":"Nginx","slug":"Nginx","permalink":"http://blog.3amupupup.online/tags/Nginx/"}]},{"title":"c++æ„é€ å‡½æ•°","slug":"c++æ„é€ å‡½æ•°","date":"2021-03-18T03:09:52.052Z","updated":"2021-03-18T03:09:52.052Z","comments":true,"path":"2021/03/18/c++æ„é€ å‡½æ•°/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/c++%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0/","excerpt":"","text":"#include &lt;iostream&gt; #include &lt;string&gt; using namespace std; class Person { public: Person() { cout &lt;&lt; &quot;è°ƒç”¨æ— å‚æ„é€ &quot; &lt;&lt; endl; this-&gt;name = &quot;null&quot;; this-&gt;age = 0; } Person(string name, int age) { cout &lt;&lt; &quot;è°ƒç”¨æœ‰å‚æ„é€ å‡½æ•°&quot; &lt;&lt; endl; this-&gt;name = name; this-&gt;age = age; } Person(const Person&amp; p) { cout &lt;&lt; &quot;è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°&quot; &lt;&lt; endl; this-&gt;name = p.name; this-&gt;age = p.age; } Person operator=(const Person&amp; p) // å¦‚æœç›´æ¥è¿”å›å¯¹è±¡ï¼Œåœ¨è¿”å›æ—¶ä¼šå¤šè°ƒç”¨ä¸€æ¬¡æ‹·è´æ„é€ å‡½æ•°ã€‚å¦‚æœè¿”å›å€¼ä¸ºå¼•ç”¨ï¼Œåˆ™ä¸ä¼šè°ƒç”¨æ‹·è´æ„é€ ã€‚å¦å¤–åœ¨ä¼ å‚çš„æ—¶å€™ä¹Ÿå°½é‡è¦ä½¿ç”¨å¼•ç”¨ï¼Œå¦‚æœä¸ä½¿ç”¨åˆ™ä¼šå¢åŠ ä¸€æ¬¡æ‹·è´æ„é€ å‡½æ•°çš„è°ƒç”¨ã€‚ { cout &lt;&lt; &quot;è°ƒç”¨é‡è½½ç¬¦=&quot; &lt;&lt; endl; this-&gt;age = p.age; this-&gt;name = p.name; return *this; } void Info() { cout &lt;&lt; this-&gt;name &lt;&lt; &quot;,&quot; &lt;&lt; this-&gt;age &lt;&lt; endl; } private: string name; int age; string family[3]; }; int main() { Person p1(&quot;duwei&quot;,25); Person p2; p2 = p1; return 0; } output: è°ƒç”¨æœ‰å‚æ„é€ å‡½æ•° è°ƒç”¨æ— å‚æ„é€  è°ƒç”¨é‡è½½ç¬¦= è°ƒç”¨æ‹·è´æ„é€ å‡½æ•° // ç”±äºé‡è½½ç¬¦=è¿”å›çš„æ˜¯éå¼•ç”¨é€ æˆçš„","categories":[],"tags":[]},{"title":"zabbix_dingdingAlert","slug":"zabbix_dingdingAlert","date":"2021-03-18T03:09:52.051Z","updated":"2021-03-18T03:09:52.052Z","comments":true,"path":"2021/03/18/zabbix_dingdingAlert/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/zabbix_dingdingAlert/","excerpt":"","text":"1ã€goè„šæœ¬package main import ( &quot;fmt&quot; &quot;os&quot; &quot;script/utils&quot; ) func main() { res := os.Args[1:] fmt.Println(res[0]) message := fmt.Sprintf(&quot;message:from zabbix\\n%s&quot;, res[0]) utils.SendDingMsg(message) } func SendDingMsg(msg string) { //è¯·æ±‚åœ°å€æ¨¡æ¿ webHook := `https://oapi.dingtalk.com/robot/send?access_token=ac19ab391d99a7xa93128af4e9bacbeafea151926c1187640233a2f3199baba9` content := `{&quot;msgtype&quot;: &quot;text&quot;, &quot;text&quot;: {&quot;content&quot;: &quot;` + msg + `&quot;} }` //åˆ›å»ºä¸€ä¸ªè¯·æ±‚ req, err := http.NewRequest(&quot;POST&quot;, webHook, strings.NewReader(content)) if err != nil { // handle error fmt.Println(err) } client := &amp;http.Client{} //è®¾ç½®è¯·æ±‚å¤´ req.Header.Set(&quot;Content-Type&quot;, &quot;application/json; charset=utf-8&quot;) //å‘é€è¯·æ±‚ resp, err := client.Do(req) //å…³é—­è¯·æ±‚ defer resp.Body.Close() if err != nil { // handle error fmt.Println(err) } } 2ã€ç¼–è¯‘è„šæœ¬ä¹‹åä¸Šä¼ åˆ°zabbix-serverã€‚ æŸ¥çœ‹zabbix-serveré…ç½®æ–‡ä»¶ï¼Œæ‰¾åˆ°AlertScriptsPathå‚æ•°æŸ¥çœ‹å­˜æ”¾è„šæœ¬ä½ç½®ï¼šAlertScriptsPath=/usr/lib/zabbix/alertscriptsï¼Œå°†ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶æ”¾å…¥ã€‚ é»˜è®¤ä¿¡æ¯: å‘Šè­¦ä¸»æœºï¼š{HOST.NAME} ä¸»æœºIPï¼š {HOST.IP} å‘Šè­¦æ—¶é—´ï¼š{EVENT.DATE} {EVENT.TIME} å‘Šè­¦ç­‰çº§ï¼š{TRIGGER.SEVERITY} å‘Šè­¦ä¿¡æ¯ï¼š{TRIGGER.NAME} é—®é¢˜è¯¦æƒ…ï¼š{ITEM.NAME}:{ITEM.VALUE} å½“å‰çŠ¶æ€: {TRIGGER.STATUS}:{ITEM.VALUE1} äº‹ä»¶IDï¼š {EVENT.ID}","categories":[{"name":"è¿ç»´","slug":"è¿ç»´","permalink":"http://blog.3amupupup.online/categories/%E8%BF%90%E7%BB%B4/"}],"tags":[{"name":"zabbix","slug":"zabbix","permalink":"http://blog.3amupupup.online/tags/zabbix/"}]},{"title":"æ•°æ®çš„å­˜å‚¨","slug":"æ•°æ®çš„å­˜å‚¨","date":"2021-03-18T03:09:52.051Z","updated":"2021-03-18T03:09:52.051Z","comments":true,"path":"2021/03/18/æ•°æ®çš„å­˜å‚¨/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AD%98%E5%82%A8/","excerpt":"","text":"åŸç ã€åç ã€è¡¥ç æœ‰ç¬¦å·ï¼šåŸåè¡¥ç›¸åŒã€‚ è®¡ç®—æœºä¸­çš„æ•´å½¢æœ‰ç¬¦å·æ•°æœ‰ä¸‰ç§è¡¨ç¤ºæ–¹æ³•ï¼Œå³åŸç ã€åç ã€è¡¥ç ã€‚ ä¸‰ç§è¡¨ç¤ºæ–¹æ³•å‡æœ‰ç¬¦å·ä½å’Œæ•°å€¼ä½ä¸¤éƒ¨åˆ†ï¼Œç¬¦å·ä½éƒ½æ˜¯ç”¨0è¡¨ç¤ºâ€œæ­£â€ï¼Œç”¨1è¡¨ç¤ºâ€œè´Ÿâ€ï¼Œè€Œæ•°å€¼ä½ä¸‰ç§è¡¨ç¤ºæ³•å„ä¸ç›¸åŒã€‚ æ–¹æ³•å æ–¹æ³• åŸç  ç›´æ¥æŒ‰ç…§æ­£è´Ÿæ•°çš„å½¢å¼ç¿»è¯‘æˆäºŒè¿›åˆ¶å°±å¯ä»¥ åç  åŸç çš„ç¬¦å·ä½ä¸å˜ï¼Œå°†å…¶å®ƒç»´ä¾æ¬¡æŒ‰ä½å–å è¡¥ç  åç åŠ ä¸€ #include &quot;stdio.h&quot; int main(){ int a = 20; // 0(ç¬¦å·ä½) 0000000 00000000 00000000 00010100 -åŸç  // 00000000 00000000 00000000 00010100 -åç  // 00000000 00000000 00000000 00010100 -è¡¥ç  // 0x00000014 åå…­è¿›åˆ¶ int b = -10; // 1(ç¬¦å·ä½) 0000000 00000000 00000000 00001010 -åŸç  // 11111111 11111111 11111111 11110101 -åç  // 11111111 11111111 11111111 11110110 -è¡¥ç  // 0xfffffff6 a+b; // 00000000000000000000000000010100 // 11111111111111111111111111110110 // 1 00000000000000000000000000001010 33ä½ï¼Œintåªèƒ½å­˜32ä½ æ‰€ä»¥ç¬¬ä¸€ä¸ª1èˆå¼ƒï¼Œæ‰€ä»¥ç»“æœä¸º10 return 0; } å¯¹äºæ•´å½¢æ¥è¯´ï¼šæ•°æ®å­˜æ”¾åœ¨å†…å­˜ä¸­å…¶å®å­˜æ”¾çš„æ˜¯è¡¥ç ã€‚ 10000000 ä¸è¿›è¡Œè®¡ç®—ï¼Œç›´æ¥ç­‰äº128 æµ®ç‚¹æ•°ï¼š 9.0 1001.0 1.001*2^3 == (-1)^0 * 1.001 * 2^3 //(-1)^s * M * 2^E [S 1bit][E 8bit][M 23bit] S:ç¬¦å·ä½ E:æŒ‡æ•°ä½(æ— ç¬¦å·) M:æœ‰æ•ˆæ•°å­— 5.5 101.1 (-1)^0 * 1.011 * 2^2 S = 0 E = 2 + 127 = 129 = 10000001(äºŒè¿›åˆ¶) M = 1.011 0 10000001 01100000000000000000000 0100 0000 1011 0000 0000 0000 0000 0000 4 0 b 0 0 0 0 0(16è¿›åˆ¶) å†…å­˜: 0x40b00000 (å¦‚ä¸‹å›¾ï¼Œå°ç«¯å­˜å‚¨æ³•) ä¾‹é¢˜ï¼š int n = 9; float *pFloat = (float *)&amp;n; printf(&quot;nçš„å€¼ä¸ºï¼š%d\\n&quot;,n); printf(&quot;*pFloatçš„å€¼ä¸ºï¼š%f\\n&quot;,*pFloat); *pFloat = 9.0; printf(&quot;numçš„å€¼ä¸ºï¼š%d\\n&quot;,n); printf(&quot;*pFloatçš„å€¼ä¸ºï¼š%f\\n&quot;,*pFloat); // 9.0: 1001.0 // 1.001 * 2^3 // (-1)^0 3+127 001 // 0 10000010 00100000000000000000000 // 0100 0001 0001 0000 0000 0000 0000 0000 å› ä¸ºæ˜¯æ­£æ•°ï¼Œæ‰€ä»¥ è¡¥ç ==åŸç ==åç  //è½¬æ¢æˆ10è¿›åˆ¶ä¸ºï¼š1091567616","categories":[{"name":"Cè¯­è¨€","slug":"Cè¯­è¨€","permalink":"http://blog.3amupupup.online/categories/C%E8%AF%AD%E8%A8%80/"}],"tags":[{"name":"cè¯­è¨€åŸºç¡€","slug":"cè¯­è¨€åŸºç¡€","permalink":"http://blog.3amupupup.online/tags/c%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80/"}]},{"title":"äºŒçº§è®¡ç®—æœº","slug":"äºŒçº§è®¡ç®—æœº","date":"2021-03-18T03:09:52.049Z","updated":"2021-03-18T03:09:52.049Z","comments":true,"path":"2021/03/18/äºŒçº§è®¡ç®—æœº/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/%E4%BA%8C%E7%BA%A7%E8%AE%A1%E7%AE%97%E6%9C%BA/","excerpt":"","text":"äºŒå‰æ ‘ åº¦ï¼šèŠ‚ç‚¹çš„å­©å­æ•°é‡ï¼ŒäºŒå‰æ ‘åªæœ‰ä¸‰ç§ï¼š0ï¼Œ1ï¼Œ2ã€‚åº¦ä¸º0çš„èŠ‚ç‚¹(å¶å­èŠ‚ç‚¹)æ€»æ˜¯æ¯”åº¦ä¸º2çš„èŠ‚ç‚¹å¤šä¸€ä¸ª æ·±åº¦ï¼šæ·±åº¦ä¸ºmçš„äºŒå‰æ ‘æœ€å¤šæœ‰2^m-1ä¸ªèŠ‚ç‚¹ æ»¡äºŒå‰æ ‘æ˜¯æŒ‡é™¤äº†æœ€åä¸€å±‚ä¹‹å¤–ï¼Œæ¯ä¸€å±‚ä¸Šçš„æ‰€æœ‰ç»“ç‚¹éƒ½æœ‰ä¸¤ä¸ªå­ç»“ç‚¹ã€‚ å®Œå…¨äºŒå‰æ ‘æ˜¯æŒ‡é™¤äº†æœ€åä¸€å±‚ä¹‹å¤–ï¼Œæ¯ä¸€å±‚ä¸Šçš„ç»“ç‚¹æ ‘å‡è¾¾åˆ°æœ€å¤§å€¼ï¼›åœ¨æœ€åä¸€å±‚ä¸Šåªç¼ºå°‘å³è¾¹çš„è‹¥å¹²èŠ‚ç‚¹ã€‚ ååºéå†ä¸ä¸­åºéå†ç›¸åŒï¼Œè¯´æ˜è¯¥äºŒå‰æ ‘é™¤äº†å¶å­ç»“ç‚¹å¤–ï¼Œæ‰€æœ‰ç»“ç‚¹éƒ½åªæœ‰å·¦å­ç»“ç‚¹ã€‚ å‰åºéå†å’Œä¸­åºéå†ç›¸åŒï¼Œè¯´æ˜è¯¥äºŒå‰æ ‘é™¤äº†å¶å­ç»“ç‚¹å¤–ï¼Œæ‰€æœ‰ç»“ç‚¹éƒ½åªæœ‰å³å­èŠ‚ç‚¹ã€‚","categories":[],"tags":[]},{"title":"cå­¦ä¹ ç¬”è®°","slug":"cå­¦ä¹ ç¬”è®°","date":"2021-03-18T03:09:52.049Z","updated":"2021-03-18T03:09:52.050Z","comments":true,"path":"2021/03/18/cå­¦ä¹ ç¬”è®°/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/c%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","excerpt":"","text":"1ã€æ•°ç»„åã€‚#include &lt;stdio.h&gt; /* int main(){ char *src = &quot;duabcdwei&quot;; char dest[100] = { 0 }; for (;(*dest++ = *src++);){ ; } printf(&quot;%s\\n&quot;,dest); return 0; } * æ•°ç»„åæ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œä¸èƒ½è¿›è¡Œè‡ªå¢ã€‚ * æ‰€ä»¥è¿™é‡Œçš„å†™æ³•æ˜¯é”™è¯¯çš„ã€‚ */ void strcpy_best2(char *src, char*dest) { printf(&quot;&amp;src in = %p\\n&quot;, &amp;src); printf(&quot;src = %p,line = %d\\n&quot;,src,__LINE__); *(*&amp;src+1) = &#39;A&#39;; while ((*dest++ = *src++)){ ; } /* * åœ¨æ­¤å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œæ•°ç»„çš„åœ°å€ä¼šæ‹·è´ç»™å½¢å‚å˜é‡ï¼Œsrcã€destæ˜¯å˜é‡ï¼Œæ‰€ä»¥èƒ½å¤Ÿè¿›è¡Œè‡ªå¢ * */ } int main() { char dest[10]; char src[] = &quot;duwei&quot;; printf(&quot;&amp;src out = %p\\n&quot;,&amp;src); printf(&quot;src out = %p\\n&quot;,src); strcpy_best2(src,dest); printf(&quot;dest = %s\\n&quot;, dest); printf(&quot;src = %s\\n&quot;,src); return 0; } output: &amp;src out = 0x7ffeed653a32 src out = 0x7ffeed653a32 &amp;src in = 0x7ffeed653a08 src = 0x7ffeed653a32,line = 64 dest = dAwei src = dAwei ç»“è®ºï¼šæ•°ç»„åæ˜¯å¸¸é‡ï¼Œä¸èƒ½å¤Ÿè¢«ä¿®æ”¹ã€‚ 2ã€å­—ç¬¦ä¸²+å†…å­˜å‡½æ•° size_t strlen(const char *); #include &lt;stdio.h&gt; #include &lt;string.h&gt; int main() { printf(&quot;length = %lu\\n&quot;,strlen(&quot;learn C&quot;)); return 0; } char * strcpy(char *dest, const char *src); #include &lt;stdio.h&gt; #include &lt;string.h&gt; int main() { char dest[100]; strcpy(dest,&quot;learn C&quot;); printf(&quot;dest = %s\\n&quot;,dest); return 0; } char * strcat(char *dest, const char *src); #include &lt;stdio.h&gt; #include &lt;string.h&gt; int main() { char str[100] = &quot;learn&quot;; strcat(str,&quot; C&quot;); printf(&quot;str = \\&quot;%s\\&quot;\\n&quot;, str); // strcat(str,str); // printf(&quot;str = \\&quot;%s\\&quot;\\n&quot;, str); return 0; } int strcmp(const char *str1, const char *str2); #include &lt;stdio.h&gt; #include &lt;string.h&gt; int main() { /* * æ¯”è¾ƒçš„æ˜¯asciiç  * */ int ret1 = strcmp(&quot;first&quot;, &quot;second&quot;); printf(&quot;ret = %d\\n&quot;,ret1); // -1 int ret2 = strcmp(&quot;first&quot;, &quot;first&quot;); printf(&quot;ret = %d\\n&quot;,ret2); // 0 int ret3 = strcmp(&quot;second&quot;, &quot;first&quot;); printf(&quot;ret = %d\\n&quot;,ret3); // 1 return 0; } char strstr(const char\\, const char*); int main() { char str[] = &quot;this is a simple string.&quot;; char *pch = NULL; pch = strstr(str, &quot;simple&quot;); strncpy(pch,&quot;simple&quot;,6); printf(&quot;str = \\&quot;%s\\&quot;&quot;, pch); return 0; } char *strtok(char *str, const char *sep); sepå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼ŒåŒ…å«åˆ†éš”ç¬¦çš„å­—ç¬¦é›†åˆã€‚ #include &lt;stdio.h&gt; #include &lt;string.h&gt; int main() { char str[] = &quot;-this,a simple string.&quot;; char *pch; printf(&quot;Splitting string \\&quot;%s\\&quot; into tokens:\\n&quot;,str); pch = strtok(str, &quot;,.-&quot;); while (pch != NULL){ printf(&quot;%s\\n&quot;,pch); pch = strtok(NULL,&quot;,.-&quot;); } return 0; } strtokä¼šæ”¹å˜è¢«æ“ä½œå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ä¸€èˆ¬å…ˆè¿›è¡Œæ‹·è´å†æ“ä½œ #include &lt;stdio.h&gt; #include &lt;string.h&gt; int main() { char *p = &quot;duwei19961021@163.com&quot;; const char *sep = &quot;@.&quot;; char cp[30]; strcpy(cp,p); char *str = NULL; for (str = strtok(cp,sep);str != NULL; str = strtok(NULL,sep)) { printf(&quot;%s\\n&quot;,str); } return 0; } char *strerror(int errnum); #include &lt;stdio.h&gt; #include &lt;string.h&gt; int main() { for (int i = 0; i &lt; 200; ++i) { printf(&quot;%d: %s\\n&quot;,i,strerror(i)); } return 0; } /* 0: Success 1: Operation not permitted 2: No such file or directory 3: No such process 4: Interrupted system call 5: Input/output error 6: No such device or address 7: Argument list too long 8: Exec format error 9: Bad file descriptor 10: No child processes 11: Resource temporarily unavailable 12: Cannot allocate memory 13: Permission denied 14: Bad address 15: Block device required 16: Device or resource busy 17: File exists 18: Invalid cross-device link 19: No such device 20: Not a directory 21: Is a directory 22: Invalid argument 23: Too many open files in system 24: Too many open files 25: Inappropriate ioctl for device 26: Text file busy 27: File too large 28: No space left on device 29: Illegal seek 30: Read-only file system 31: Too many links 32: Broken pipe 33: Numerical argument out of domain 34: Numerical result out of range 35: Resource deadlock avoided 36: File name too long 37: No locks available 38: Function not implemented 39: Directory not empty 40: Too many levels of symbolic links 41: Unknown error 41 42: No message of desired type 43: Identifier removed 44: Channel number out of range 45: Level 2 not synchronized 46: Level 3 halted 47: Level 3 reset 48: Link number out of range 49: Protocol driver not attached 50: No CSI structure available 51: Level 2 halted 52: Invalid exchange 53: Invalid request descriptor 54: Exchange full 55: No anode 56: Invalid request code 57: Invalid slot 58: Unknown error 58 59: Bad font file format 60: Device not a stream 61: No data available 62: Timer expired 63: Out of streams resources 64: Machine is not on the network 65: Package not installed 66: Object is remote 67: Link has been severed 68: Advertise error 69: Srmount error 70: Communication error on send 71: Protocol error 72: Multihop attempted 73: RFS specific error 74: Bad message 75: Value too large for defined data type 76: Name not unique on network 77: File descriptor in bad state 78: Remote address changed 79: Can not access a needed shared library 80: Accessing a corrupted shared library 81: .lib section in a.out corrupted 82: Attempting to link in too many shared libraries 83: Cannot exec a shared library directly 84: Invalid or incomplete multibyte or wide character 85: Interrupted system call should be restarted 86: Streams pipe error 87: Too many users 88: Socket operation on non-socket 89: Destination address required 90: Message too long 91: Protocol wrong type for socket 92: Protocol not available 93: Protocol not supported 94: Socket type not supported 95: Operation not supported 96: Protocol family not supported 97: Address family not supported by protocol 98: Address already in use 99: Cannot assign requested address 100: Network is down 101: Network is unreachable 102: Network dropped connection on reset 103: Software caused connection abort 104: Connection reset by peer 105: No buffer space available 106: Transport endpoint is already connected 107: Transport endpoint is not connected 108: Cannot send after transport endpoint shutdown 109: Too many references: cannot splice 110: Connection timed out 111: Connection refused 112: Host is down 113: No route to host 114: Operation already in progress 115: Operation now in progress 116: Stale file handle 117: Structure needs cleaning 118: Not a XENIX named type file 119: No XENIX semaphores available 120: Is a named type file 121: Remote I/O error 122: Disk quota exceeded 123: No medium found 124: Wrong medium type 125: Operation canceled 126: Required key not available 127: Key has expired 128: Key has been revoked 129: Key was rejected by service 130: Owner died 131: State not recoverable 132: Operation not possible due to RF-kill 133: Memory page has hardware error */ void *memcpy(void * dest, const void * src, size_t num); #include &lt;stdio.h&gt; #include &lt;string.h&gt; struct Person{ char name[40]; int age; } person,person_copy; int main() { char my_name[] = &quot;duwei19961021&quot;; memcpy(person.name,my_name,strlen(my_name)+1); person.age = 24; memcpy(&amp;person_copy, &amp;person, sizeof(person)); printf(&quot;person_copy:%s,%d\\n&quot;,person_copy.name,person_copy.age); return 0; } void *memmove(void * dest, const void * src, size_t num); #include &lt;stdio.h&gt; #include &lt;string.h&gt; int main() { char str[] = &quot;memmove can be very useful......&quot;; memmove(str+20,str+15,11); printf(&quot;str:\\&quot;%s\\&quot;&quot;,str); return 0; } int memcmp(const void *ptr1, const void *ptr2, size_t num); printf #include &lt;stdio.h&gt; int main(){ int a = 1234,b = -5678; printf(&quot;%+-6d%+-6d%\\n&quot;,a,b); return 0; } /* * %å’Œdä¹‹é—´çš„ * + è¡¨ç¤ºè¾“å‡ºæ•°å­—çš„æ­£è´Ÿå· * - å·è¡¨ç¤ºsè¾“å‡ºæ•°æ®å‘å·¦å¯¹é½ * 6è¡¨ç¤ºè¾“å‡ºå®½åº¦ * å¦‚æœæ•°æ®å®½åº¦ä¸å¤Ÿåˆ™å·¦å¯¹é½ï¼Œå³è¾¹è¡¥ç©ºæ ¼ * */ ||ã€&amp;&amp;ä¼˜å…ˆçº§ #include &lt;stdio.h&gt; int main(){ int a=1,b=1,c=1; if (a-- || b-- &amp;&amp; --c){ printf(&quot;%d,%d,%d\\n&quot;,a,b,c); } else{ printf(&quot;%d,%d,%d\\n&quot;,a,c,b); } } /* * é€»è¾‘ä¸(&amp;&amp;)çš„ä¼˜å…ˆçº§æ¯”é€»è¾‘æˆ–(||)çš„ä¼˜å…ˆçº§é«˜ * å…ˆè¿›è¡Œ b-- &amp;&amp; --c * å†å°†å…¶ç»“æœå’Œa--è¿›è¡Œé€»è¾‘æˆ– * */ switchä¸­ä½¿ç”¨continue #include &lt;stdio.h&gt; int main() { int a = 123456,b; while (a){ b=a%10; a/=10; switch (b) { default:printf(&quot;%d&quot;,b++); case 1:continue; case 2:printf(&quot;%d&quot;,b++);continue; case 3:printf(&quot;%d&quot;,b++); case 4:printf(&quot;%d&quot;,b++);continue; } } return 0; } /* * è¿™é‡Œä½¿ç”¨continueä¼šå¯¼è‡´switchæ‰€æœ‰åˆ†æ”¯åœ¨æ‰§è¡Œå®Œæˆä¹‹åè¿”å›åˆ°å¤–å±‚çš„whileå¾ªç¯ï¼Œ * å› æ­¤defaultä¸ä¼šè¢«æ‰§è¡Œ * */ å±€éƒ¨å˜é‡è¦†ç›–å…¨å±€å˜é‡ #include &lt;stdio.h&gt; int a=1; int func(int d) { int b=1; static int c =1; a++;b++;++c;++d; return a+b+c+d; } int main() { int k,a=4; for (k = 0; k &lt; 3; ++k) { printf(&quot;%d,&quot;,func(a)); } return 0; } /* * åœ¨main()å‡½æ•°ä½œç”¨åŸŸä¸­ï¼Œå±€éƒ¨å˜é‡aå±è”½å…¨å±€å˜é‡aã€‚ * func()å‡½æ•°å’Œmain()å‡½æ•°ä½œç”¨åŸŸå±äºåŒçº§ï¼Œfunc()ä¸­æ²¡æœ‰aå˜é‡ï¼Œæ‰€ä»¥å»å…¨å±€ä¸­æ‰¾ * */ ddddd","categories":[{"name":"Cè¯­è¨€","slug":"Cè¯­è¨€","permalink":"http://blog.3amupupup.online/categories/C%E8%AF%AD%E8%A8%80/"}],"tags":[{"name":"c","slug":"c","permalink":"http://blog.3amupupup.online/tags/c/"}]},{"title":"Cä¸“å®¶ç¼–ç¨‹","slug":"Cä¸“å®¶ç¼–ç¨‹","date":"2021-03-18T03:09:52.047Z","updated":"2021-03-18T03:09:52.047Z","comments":true,"path":"2021/03/18/Cä¸“å®¶ç¼–ç¨‹/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/C%E4%B8%93%E5%AE%B6%E7%BC%96%E7%A8%8B/","excerpt":"","text":"1.9 ä¼ å‚æ—¶çš„æ•°æ®ç±»å‹ void foo(const char **p){ } int main(int argc, char **argv){ foo(argv); } output: warning: passing &#39;char **&#39; to parameter of type &#39;const char **&#39; discards qualifiers in nested pointer types æ¯ä¸ªå®å‚éƒ½åº”è¯¥å…·æœ‰è‡ªå·±çš„ç±»å‹ï¼Œè¿™æ ·å®ƒçš„å€¼å°±å¯ä»¥èµ‹å€¼ç»™ä¸å®ƒæ‰€å¯¹åº”çš„å½¢å‚ç±»å‹çš„å¯¹è±¡(è¯¥å¯¹è±¡çš„ç±»å‹ä¸èƒ½å«æœ‰é™å®šç¬¦)ã€‚è¿™å°±æ˜¯è¯´å‡½æ•°ä¼ å‚ç±»ä¼¼äºèµ‹å€¼ã€‚ è¦ä½¿ä¸Šè¿°èµ‹å€¼åˆæ³•ï¼Œå¿…é¡»æ»¡è¶³ä¸‹åˆ—æ¡ä»¶ä¹‹ä¸€: ä¸¤ä¸ªæ“ä½œæ•°éƒ½æ˜¯æŒ‡å‘æœ‰é™å®šç¬¦æˆ–è€…æ— é™å®šç¬¦çš„ç›¸åŒç±»å‹æŒ‡é’ˆï¼Œå·¦è¾¹æŒ‡é’ˆæ‰€æŒ‡å‘çš„ç±»å‹å¿…é¡»å…·æœ‰å³è¾¹æŒ‡é’ˆæ‰€æŒ‡å‘ç±»å‹çš„å…¨éƒ¨é™å®šç¬¦ã€‚ int main(){ char *cp; const char *ccp; ccp = cp; return 0; } /* * å·¦æ“ä½œæ•°æ˜¯ä¸€ä¸ªæŒ‡å‘consté™å®šç¬¦çš„charæŒ‡é’ˆã€‚ * å³æ“ä½œæ•°æ˜¯ä¸€ä¸ªæŒ‡å‘æ²¡æœ‰é™å®šç¬¦çš„charæŒ‡é’ˆã€‚ * charç±»å‹ä¸charç±»å‹æ˜¯ç›¸å®¹çš„ï¼Œå·¦æ“ä½œæ•°æ‰€æŒ‡å‘çš„ç±»å‹å…·æœ‰å³æ“ä½œæ•°æ‰€æŒ‡å‘ç±»å‹çš„é™å®šç¬¦ï¼ŒåŠ ä¸Šè‡ªèº«çš„é™å®šç¬¦constã€‚ * åä¹‹: cp = ccp åœ¨ç¼–è¯‘æ—¶ä¼šäº§ç”Ÿè­¦å‘Šã€‚ * */ const float *p1; //æŒ‡å‘ä¸€ä¸ªå…·æœ‰consté™å®šç¬¦çš„floatç±»å‹çš„æŒ‡é’ˆï¼Œæ„æ€æ˜¯pæ‰€æŒ‡å‘çš„æŒ‡é’ˆèƒ½æ”¹å˜ï¼Œä½†æ˜¯*pæ‰€æŒ‡å‘çš„å€¼ä¸èƒ½æ”¹å˜ 3.2 å£°æ˜ int main(){ const int * grape1; int num1 = 10; *grape1 = 100; // error: read-only variable is not assignable grape1 = &amp;num1; int const * grape2; int num2 = 10; *grape2 = 10; // error: read-only variable is not assignable grape2 = &amp;num2; int * const grape_jelly; int num3 = 10; grape_jelly = &amp;num3; // error: read-only variable is not assignable *grape_jelly = 10; const int * const grape_jim; int const * const grape_jim2; //ä¸¤ç§å†™æ³•éƒ½è¡¨ç¤ºå¯¹è±¡å’ŒæŒ‡é’ˆéƒ½ä¸ºåªè¯» } å‡½æ•°çš„è¿”å›å€¼ä¸èƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåƒfoo()()æ˜¯éæ³•ã€‚ å‡½æ•°çš„è¿”å›å€¼ä¸èƒ½æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œfoo()[]æ˜¯éæ³•ã€‚ æ•°ç»„é‡Œé¢ä¸èƒ½æœ‰å‡½æ•°ï¼Œfooæ˜¯éæ³•ã€‚ å‡½æ•°çš„è¿”å›å€¼å…è®¸æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œå¦‚ï¼šint(* func())()ã€‚func() è¿”å› int (*)()å‡½æ•° å‡½æ•°çš„è¿”å›å€¼å…è®¸æ˜¯ä¸€ä¸ªæŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆï¼Œå¦‚ï¼šint(* foo())[]ã€‚foo()è¿”å› int (*)[]æ•°ç»„æŒ‡é’ˆã€‚ æ•°ç»„é‡Œé¢å…è®¸æœ‰å‡½æ•°æŒ‡é’ˆï¼Œå¦‚ï¼šint(* foo[])()ã€‚* foo[]æŒ‡é’ˆæ•°ç»„ï¼Œæ•°ç»„ç±»å‹æ˜¯ä¸€ä¸ªå‚æ•°ä¸ºvoidã€è¿”å›å€¼ä¸ºintçš„å‡½æ•°çš„æŒ‡é’ˆ 3.2.1 ç»“æ„ struct Person { char* name; int age; } stu1,*stu2; struct s_tag { int a[100]; }; struct s_tag orange,lime,lemon; struct s_tag twofold(struct s_tag s){ for (int i = 0; i &lt; 100; ++i) { s.a[i] *= 2; } return s; } int main(){ for (int i = 0; i &lt; 100; ++i) { lime.a[i] = i; } printf(&quot;line%d, lime[10] = %d\\n&quot;, __LINE__,lime.a[10]); lemon = twofold(lime); printf(&quot;line%d, lime[10] = %d\\n&quot;, __LINE__,lime.a[10]); // ç»“æ„ä½“æ˜¯å€¼ä¼ é€’ printf(&quot;line%d, lemon[10] = %d\\n&quot;, __LINE__,lemon.a[10]); orange = lemon; printf(&quot;line%d, orange[10] = %d\\n&quot;, __LINE__,orange.a[10]); return 0; } 4.3.1 æ•°ç»„å’ŒæŒ‡é’ˆæ˜¯å¦‚ä½•è®¿é—®çš„x = y; ç¬¦å·xçš„å«ä¹‰æ˜¯xæ‰€ä»£è¡¨çš„åœ°å€ï¼Œè¢«ç§°ä¸ºå·¦å€¼ï¼Œå·¦å€¼åœ¨ç¼–è¯‘æ—¶å¯çŸ¥ï¼Œå·¦å€¼è¡¨ç¤ºå­˜å‚¨ç»“æœçš„åœ°æ–¹ã€‚ ç¬¦å·yçš„å«ä¹‰æ˜¯yæ‰€ä»£è¡¨çš„åœ°å€çš„å†…å®¹ï¼Œè¢«ç§°ä¸ºå³å€¼ï¼Œå³å€¼çŸ¥é“è¿è¡Œæ—¶æ‰çŸ¥ã€‚ cè¯­è¨€æœ¯è¯­â€“å¯ä¿®æ”¹çš„å·¦å€¼ï¼Œè¡¨ç¤ºå…è®¸å·¦å€¼å‡ºç°åœ¨èµ‹å€¼è¯­å¥çš„å·¦è¾¹ã€‚æ•°ç»„åç”¨äºç¡®å®šå¯¹è±¡åœ¨å†…å­˜ä¸­çš„ä½ç½®ï¼Œä¹Ÿæ˜¯å·¦å€¼ï¼Œä½†å®ƒä¸èƒ½ä½œä¸ºèµ‹å€¼å¯¹è±¡ã€‚å› æ­¤ï¼Œæ•°ç»„åæ˜¯ä¸ªå·¦å€¼ä½†æ˜¯ä¸å¯ä¿®æ”¹çš„å·¦å€¼ã€‚ 4.3.2 å®šä¹‰ä¸ºæŒ‡é’ˆï¼Œä»¥æ•°ç»„æ–¹å¼å¼•ç”¨ã€‚ char *p = &quot;abcdefgh&quot;; // åˆå§‹åŒ–æŒ‡é’ˆæ—¶æ‰€åˆ›å»ºçš„å­—ç¬¦ä¸²å¸¸é‡é€šå¸¸è¢«å®šä¹‰ä¸ºåªè¯» char a[] = &quot;abcdefgh&quot;; char b = &#39;d&#39;; ps: æ¯ä¸ªç¬¦å·çš„åœ°å€åœ¨ç¼–è¯‘æ—¶å¯çŸ¥ã€‚ é€šè¿‡på–å¾—å­—ç¬¦ â€˜dâ€™: é€šè¿‡ç¼–è¯‘å™¨ç¬¦å·è¡¨æ‰¾åˆ°pçš„åœ°å€ï¼Œè§£å¼•ç”¨å¾—åˆ°ä¸€ä¸ªåœ°å€ï¼Œè¿™ä¸ªåœ°å€å†åŠ ä¸Šåç§»é‡å¾—åˆ°å­—ç¬¦ â€˜dâ€™ã€‚ é€šè¿‡æ•°ç»„åaå–å¾—å­—ç¬¦ â€˜dâ€™: æ•°ç»„åç”¨äºç¡®å®šå¯¹è±¡åœ¨å†…å­˜ä¸­çš„ä½ç½®ã€‚é€šè¿‡ç¼–è¯‘å™¨ç¬¦å·è¡¨æ‰¾åˆ°açš„åœ°å€ï¼Œå–åœ°å€(a+3)å¾—åˆ°å­—ç¬¦ â€˜dâ€™ã€‚ é€šè¿‡bå–å¾—å­—ç¬¦â€™dâ€™: #include &lt;stdio.h&gt; char p[] = &quot;duwei1996&quot;; void test(){ extern char *p; printf(&quot;%c\\n&quot;,p[1]); } int main(){ test(); return 0; } // ä¸€æ®µé”™è¯¯ä»£ç ï¼Œè¿™æ®µä»£ç ç”¨æˆ‘ç°åœ¨çš„ç¼–è¯‘å™¨éƒ½ç¼–è¯‘ä¸è¿‡å»ï¼Œä¹¦ä¸Šç”¨çš„ç¼–è¯‘å™¨å¯èƒ½æ¯”è¾ƒè€èƒ½ç¼–è¯‘è¿‡å»ã€‚ 4.5 æ•°ç»„å’ŒæŒ‡é’ˆçš„å…¶å®ƒåŒºåˆ« æŒ‡é’ˆ æ•°ç»„ ä¿å­˜æ•°æ®çš„åœ°å€ ä¿å­˜æ•°æ®çš„å€¼ é—´æ¥è®¿é—®æ•°æ®ï¼Œå…ˆå–å¾—æŒ‡é’ˆçš„å†…å®¹ï¼ŒæŠŠå®ƒä½œä¸ºåœ°å€ï¼Œç„¶åæå–è¿™ä¸ªåœ°å€çš„æ•°æ®ã€‚å¦‚æœæŒ‡é’ˆæœ‰ä¸ªä¸‹æ ‡[ i ]ï¼Œå°±æŠŠæŒ‡é’ˆçš„å†…å®¹åŠ ä¸Šiä½œä¸ºåœ°å€ï¼Œä»ä¸­æå–æ•°æ®ã€‚ ç›´æ¥è®¿é—®æ•°æ®ï¼Œa[i]åªæ˜¯æ„è§å•çš„a+iä¸ºåœ°å€å–å¾—æ•°æ® é€šå¸¸ç”¨äºåŠ¨æ€æ•°æ®ç»“æ„ é€šå¸¸ç”¨äºå­˜å‚¨å›ºå®šæ•°ç›®ä¸”æ•°æ®ç±»å‹ç›¸åŒçš„å…ƒç´  ç›¸å…³çš„å‡½æ•°ä¸ºmalloc()å’Œfree() éšå¼åˆ†é…å’Œåˆ é™¤ é€šå¸¸æŒ‡å‘åŒ¿åæ•°æ® è‡ªèº«å³ä¸ºæ•°æ®å 6.2 æ®µ ç¼–è¯‘â€hello worldâ€ç¨‹åºï¼ŒæŒ‡å‘ls -lå¾—åˆ°å¯æ‰§è¡Œæ–‡ä»¶æ€»ä½“å¤§å°ï¼Œè¿è¡Œsizeå¾—åˆ°æ–‡ä»¶é‡Œå„æ®µçš„å¤§å°ã€‚ å¢åŠ ä¸€ä¸ªå…¨å±€çš„int[1000]çš„æ•°ç»„å£°æ˜ã€‚ åœ¨æ•°ç»„å£°æ˜ä¸­å¢åŠ åˆå§‹å€¼ã€‚ åœ¨å‡½æ•°å†…éƒ¨å£°æ˜ä¸€ä¸ªå·¨å¤§çš„æ•°ç»„ã€‚ 6.6 autoã€staticchar * favorite_fruit(){ char deciduous[] = &quot;apple&quot;; retrun deciduous; } è¿›å…¥è¯¥å‡½æ•°æ—¶ï¼Œè‡ªåŠ¨å˜é‡deciduousåœ¨å †æ ˆä¸­åˆ†é…ï¼Œå‡½æ•°æ‰§è¡Œç»“æŸåï¼Œå˜é‡ä¸å¤å­˜åœ¨ï¼Œå®ƒæ‰€å ç”¨çš„å †æ ˆç©ºé—´è¢«å›æ”¶ï¼Œå¯èƒ½å†ä»»ä½•æ—¶å€™è¢«è¦†ç›–ï¼ŒæŒ‡é’ˆå°±å¤±å»äº†æœ‰æ•ˆæ€§(å¼•ç”¨ä¸å­˜åœ¨çš„ä¸œè¥¿)ï¼Œè¢«ç§°ä¸ºæ‚¬å‚æŒ‡é’ˆã€‚å¦‚æœæƒ³è¿”å›ä¸€ä¸ªæŒ‡å‘åœ¨å‡½æ•°å†…éƒ¨å®šä¹‰çš„å˜é‡çš„æŒ‡é’ˆï¼Œè¦æŠŠé‚£ä¸ªå˜é‡å£°æ˜ä¸ºstaticï¼Œè¿™æ ·å°±èƒ½ä¿è¯è¯¥å˜é‡è¢«ä¿å­˜åœ¨æ•°æ®æ®µä¸­è€Œä¸æ˜¯å †æ ˆä¸­ã€‚ 9.1 ä»€ä¹ˆæ—¶å€™æŒ‡é’ˆä¸æ•°ç»„ç›¸åŒ å£°æ˜ externï¼Œå¦‚extern char a[]; ä¸èƒ½æ”¹å†™æˆæŒ‡é’ˆçš„å½¢å¼(extern char *a)ã€‚ å®šä¹‰ï¼Œå¦‚char a[10]; ä¸èƒ½æ”¹å†™æˆæŒ‡é’ˆçš„å½¢å¼ã€‚ å‡½æ•°çš„å‚æ•°ï¼Œå¦‚ func(char a[]);æ—¢å¯ä»¥å†™æ•°ç»„å½¢å¼ä¹Ÿå¯ä»¥å†™æŒ‡é’ˆå½¢å¼ã€‚ åœ¨è¡¨è¾¾å¼ä¸­ä½¿ç”¨ å¦‚ a = c[i]; æ—¢å¯ä»¥å†™æ•°ç»„å½¢å¼ä¹Ÿå¯ä»¥å†™æŒ‡é’ˆå½¢å¼ã€‚ å¯¹äºç¼–è¯‘å™¨è€Œè¨€ï¼Œä¸€ä¸ªæ•°ç»„å°±æ˜¯ä¸€ä¸ªåœ°å€ï¼Œä¸€ä¸ªæŒ‡é’ˆæ˜¯ä¸€ä¸ªåœ°å€çš„åœ°å€ã€‚ æ•°ç»„å’ŒæŒ‡é’ˆæ˜¯ç›¸åŒçš„ä¸‰æ¡è§„åˆ™ è¡¨è¾¾å¼ä¸­çš„æ•°ç»„å(ä¸å£°æ˜ä¸åŒ)è¢«ç¼–è¯‘å™¨å½“åšä¸€ä¸ªæŒ‡å‘è¯¥æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆã€‚ int [10], *p, i = 2; // å¯ä»¥é€šè¿‡ä¸‹é¢ä»»ä½•ä¸€ç§æ–¹æ³•è®¿é—®a[i] p = a; p[i]; p = a; *(p+i); p = a + i; *p; cè¯­è¨€æŠŠæ•°ç»„ä¸‹æ ‡ä½œä¸ºæŒ‡é’ˆçš„åç§»é‡ã€‚ ä½œä¸ºå‡½æ•°å‚æ•°çš„æ•°ç»„åç­‰åŒäºæŒ‡é’ˆã€‚ 9.3 ä¸ºä»€ä¹ˆcè¯­è¨€æŠŠæ•°ç»„å½¢å‚å½“åšæŒ‡é’ˆæ‰€æœ‰éæ•°ç»„å½¢å¼çš„æ•°æ®å‡ä»¥ä¼ å€¼å½¢å¼(å¯¹å®å‚ä½œä¸€ä»½æ‹·è´å¹¶ä¼ é€’ç»™è°ƒç”¨çš„å‡½æ•°ï¼Œå‡½æ•°ä¸èƒ½ä¿®æ”¹ä½œä¸ºå®å‚çš„çš„å®é™…å˜é‡çš„å€¼ï¼Œè€Œåªèƒ½ä¿®æ”¹ä¼ é€’ç»™å®ƒçš„é‚£ä»½æ‹·è´ã€‚)è°ƒç”¨ï¼Œç„¶è€Œï¼Œå¦‚æœè¦æ‹·è´æ•´ä¸ªæ•°ç»„ï¼Œæ— è®ºåœ¨æ—¶é—´ä¸Šè¿˜æ˜¯åœ¨å†…å­˜ç©ºé—´ä¸Šçš„å¼€é”€éƒ½å¯èƒ½æ˜¯éå¸¸å¤§çš„ã€‚è€Œä¸”åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹å¹¶ä¸éœ€è¦æ•´ä¸ªæ•°ç»„çš„æ‹·è´ã€‚æ‰€æœ‰æ•°ç»„åœ¨ä¼ é€’æ—¶éƒ½è½¬æ¢ä¸ºæŒ‡å‘æ•°ç»„èµ·å§‹åœ°å€çš„æŒ‡é’ˆï¼Œè€Œå…¶å®ƒå‚æ•°å‡é‡‡ç”¨ä¼ å€¼ã€‚å‡½æ•°çš„è¿”å›å€¼å†³ä¸èƒ½æ˜¯ä¸€ä¸ªå‡½æ•°æ•°ç»„ï¼Œè€Œåªèƒ½æ˜¯æŒ‡å‘æ•°ç»„æˆ–è€…å‡½æ•°çš„æŒ‡é’ˆã€‚","categories":[{"name":"Cè¯­è¨€","slug":"Cè¯­è¨€","permalink":"http://blog.3amupupup.online/categories/C%E8%AF%AD%E8%A8%80/"}],"tags":[{"name":"book","slug":"book","permalink":"http://blog.3amupupup.online/tags/book/"}]},{"title":"Dockerfile","slug":"Dockerfile","date":"2021-03-18T03:09:52.045Z","updated":"2021-03-18T03:09:52.046Z","comments":true,"path":"2021/03/18/Dockerfile/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/Dockerfile/","excerpt":"","text":"NGINXFROM centos:centos7 RUN /usr/bin/cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \\ &amp;&amp; mkdir /data/logs -p \\ &amp;&amp; mkdir /data/www -p \\ &amp;&amp; rm -rf /etc/yum.repos.d/* \\ &amp;&amp; curl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo\\ &amp;&amp; yum -y install wget \\ &amp;&amp; curl -o /etc/yum.repos.d/nginx.repo http://172.16.72.173/nginx_config/nginx.repo \\ &amp;&amp; yum clean all \\ &amp;&amp; yum repolist \\ &amp;&amp; yum -y install nginx RUN rm -rf /etc/nginx/conf.d/default.conf \\ &amp;&amp; curl -o /etc/nginx/nginx.conf http://172.16.72.173/v2/nginx_config/nginx.conf \\ &amp;&amp; sed -i &#39;s/user nginx;/user www;/&#39; /etc/nginx/nginx.conf \\ &amp;&amp; useradd www -s /sbin/nologin CMD [&quot;nginx&quot;,&quot;-g&quot;,&quot;daemon off;&quot;] PHPFROM centos:centos7 RUN /usr/bin/cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \\ &amp;&amp; mkdir /data/www -p \\ &amp;&amp; mkdir /data/logs/ -p \\ &amp;&amp; rm -rf /etc/yum.repos.d/* \\ &amp;&amp; curl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo \\ &amp;&amp; curl -o /etc/yum.repos.d/Centos-7-epel.repo https://mirrors.aliyun.com/repo/epel.repo \\ &amp;&amp; yum clean all \\ &amp;&amp; yum repolist \\ &amp;&amp; curl -o /usr/local/src/php-7.1.3.tar.gz http://172.16.72.173/packages/php-7.1.3.tar.gz \\ &amp;&amp; cd /usr/local/src &amp;&amp; tar xf php-7.1.3.tar.gz \\ &amp;&amp; yum clean all \\ &amp;&amp; yum repolist \\ &amp;&amp; yum -y install cmake doxygen php-mysqlnd autoconf make freetype-devel openssl-devel gcc gcc-c++ bison libxml2-devel curl-devel libjpeg-devel libpng-devel libc-client-devel libmcrypt-devel librabbitmq-devel \\ &amp;&amp; cd /usr/local/src/php-7.1.3 \\ &amp;&amp; groupadd -g 1001 www \\ &amp;&amp; useradd -g 1001 -M -s /sbin/nologin www \\ &amp;&amp; ./configure --prefix=/usr/local/php \\ --exec-prefix=/usr/local/php \\ --bindir=/usr/local/php/bin \\ --sbindir=/usr/local/php/sbin \\ --includedir=/usr/local/php/include \\ --libdir=/usr/local/php/lib/php \\ --mandir=/usr/local/php/php/man \\ --with-config-file-path=/usr/local/php/etc \\ --with-mcrypt=/usr/include \\ --without-pear \\ --disable-phar \\ --with-mhash \\ --with-openssl \\ --with-pdo-mysql=shared,mysqlnd \\ --with-gd \\ --with-iconv \\ --with-zlib \\ --enable-zip \\ --enable-inline-optimization \\ --disable-debug \\ --disable-rpath \\ --enable-shared \\ --enable-xml \\ --enable-bcmath \\ --enable-shmop \\ --enable-sysvsem \\ --enable-mbregex \\ --enable-mbstring \\ --enable-ftp \\ --enable-gd-native-ttf \\ --enable-pcntl \\ --enable-sockets \\ --with-xmlrpc \\ --enable-soap \\ --without-pear \\ --with-gettext \\ --enable-session \\ --with-curl=/usr/include/x86_64-linux-gnu/curl \\ --with-jpeg-dir \\ --with-freetype-dir \\ --enable-opcache \\ --enable-fpm \\ --with-fpm-user=www \\ --with-fpm-group=www \\ --without-gdbm \\ &amp;&amp; make \\ &amp;&amp; make install \\ &amp;&amp; curl http://172.16.72.173/packages/redis-5.0.2.tgz -o /usr/local/src/php-7.1.3/ext/redis-5.0.2.tgz \\ &amp;&amp; cd /usr/local/src/php-7.1.3/ext/ \\ &amp;&amp; tar xf redis-5.0.2.tgz \\ &amp;&amp; cd redis-5.0.2 \\ &amp;&amp; /usr/local/php/bin/phpize \\ &amp;&amp; ./configure \\ --with-php-config=/usr/local/php/bin/php-config \\ &amp;&amp; make &amp;&amp; make install \\ &amp;&amp; cd /usr/local/src/php-7.1.3/ext/fileinfo \\ &amp;&amp; /usr/local/php/bin/phpize \\ &amp;&amp; ./configure \\ --with-php-config=/usr/local/php/bin/php-config --enable-fileinfo\\ &amp;&amp; make \\ &amp;&amp; make install \\ &amp;&amp; curl http://172.16.72.173/packages/amqp-1.9.3.tgz -o /usr/local/src/php-7.1.3/ext/amqp-1.9.3.tgz \\ &amp;&amp; cd /usr/local/src/php-7.1.3/ext \\ &amp;&amp; tar xf amqp-1.9.3.tgz \\ &amp;&amp; cd amqp-1.9.3 \\ &amp;&amp; /usr/local/php/bin/phpize \\ &amp;&amp; ./configure \\ --with-php-config=/usr/local/php/bin/php-config \\ &amp;&amp; make \\ &amp;&amp; make install \\ &amp;&amp; curl http://172.16.72.173/packages/mongodb-1.5.3.tgz -o /usr/local/src/php-7.1.3/ext/mongodb-1.5.3.tgz \\ &amp;&amp; cd /usr/local/src/php-7.1.3/ext \\ &amp;&amp; tar xf mongodb-1.5.3.tgz \\ &amp;&amp; cd mongodb-1.5.3 \\ &amp;&amp; /usr/local/php/bin/phpize \\ &amp;&amp; ./configure \\ --with-php-config=/usr/local/php/bin/php-config \\ &amp;&amp; make &amp;&amp; make install \\ &amp;&amp; cd /usr/local/src/php-7.1.3/ext/mysqli \\ &amp;&amp; /usr/local/php/bin/phpize \\ &amp;&amp; ./configure \\ --with-php-config=/usr/local/php/bin/php-config \\ &amp;&amp; make \\ &amp;&amp; make install \\ &amp;&amp; rm -rf /usr/local/src/* \\ &amp;&amp; yum -y autoremove gcc gcc-c++ make autoconf cmake\\ &amp;&amp; yum clean all \\ &amp;&amp; curl http://172.16.72.173/v2/php_config/php-fpm.conf -o /usr/local/php/etc/php-fpm.conf \\ &amp;&amp; curl http://172.16.72.173/v2/php_config/php.ini -o /usr/local/php/etc/php.ini \\ &amp;&amp; curl http://172.16.72.173/v2/php_config/www.conf -o /usr/local/php/etc/php-fpm.d/www.conf SUPERVISORFROM centos:centos7 RUN /usr/bin/cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \\ &amp;&amp; mkdir /data/www -p \\ &amp;&amp; mkdir /data/logs/ -p \\ &amp;&amp; rm -rf /etc/yum.repos.d/* \\ &amp;&amp; curl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo \\ &amp;&amp; curl -o /etc/yum.repos.d/Centos-7-epel.repo https://mirrors.aliyun.com/repo/epel.repo \\ &amp;&amp; yum clean all \\ &amp;&amp; yum repolist \\ &amp;&amp; curl -o /usr/local/src/php-7.1.3.tar.gz http://172.16.72.173/packages/php-7.1.3.tar.gz \\ &amp;&amp; cd /usr/local/src &amp;&amp; tar xf php-7.1.3.tar.gz \\ &amp;&amp; yum clean all \\ &amp;&amp; yum repolist \\ &amp;&amp; yum -y install cmake python-setuptools doxygen php-mysqlnd autoconf make freetype-devel openssl-devel gcc gcc-c++ bison libxml2-devel curl-devel libjpeg-devel libpng-devel libc-client-devel libmcrypt-devel librabbitmq-devel \\ &amp;&amp; cd /usr/local/src/php-7.1.3 \\ &amp;&amp; groupadd -g 1001 www \\ &amp;&amp; useradd -g 1001 -M -s /sbin/nologin www \\ &amp;&amp; ./configure --prefix=/usr/local/php \\ --exec-prefix=/usr/local/php \\ --bindir=/usr/local/php/bin \\ --sbindir=/usr/local/php/sbin \\ --includedir=/usr/local/php/include \\ --libdir=/usr/local/php/lib/php \\ --mandir=/usr/local/php/php/man \\ --with-config-file-path=/usr/local/php/etc \\ --with-mcrypt=/usr/include \\ --without-pear \\ --disable-phar \\ --with-mhash \\ --with-openssl \\ --with-pdo-mysql=shared,mysqlnd \\ --with-gd \\ --with-iconv \\ --with-zlib \\ --enable-zip \\ --enable-inline-optimization \\ --disable-debug \\ --disable-rpath \\ --enable-shared \\ --enable-xml \\ --enable-bcmath \\ --enable-shmop \\ --enable-sysvsem \\ --enable-mbregex \\ --enable-mbstring \\ --enable-ftp \\ --enable-gd-native-ttf \\ --enable-pcntl \\ --enable-sockets \\ --with-xmlrpc \\ --enable-soap \\ --without-pear \\ --with-gettext \\ --enable-session \\ --with-curl=/usr/include/x86_64-linux-gnu/curl \\ --with-jpeg-dir \\ --with-freetype-dir \\ --enable-opcache \\ --enable-fpm \\ --with-fpm-user=www \\ --with-fpm-group=www \\ --without-gdbm \\ &amp;&amp; make \\ &amp;&amp; make install \\ &amp;&amp; curl http://172.16.72.173/packages/redis-5.0.2.tgz -o /usr/local/src/php-7.1.3/ext/redis-5.0.2.tgz \\ &amp;&amp; cd /usr/local/src/php-7.1.3/ext/ \\ &amp;&amp; tar xf redis-5.0.2.tgz \\ &amp;&amp; cd redis-5.0.2 \\ &amp;&amp; /usr/local/php/bin/phpize \\ &amp;&amp; ./configure \\ --with-php-config=/usr/local/php/bin/php-config \\ &amp;&amp; make &amp;&amp; make install \\ &amp;&amp; cd /usr/local/src/php-7.1.3/ext/fileinfo \\ &amp;&amp; /usr/local/php/bin/phpize \\ &amp;&amp; ./configure \\ --with-php-config=/usr/local/php/bin/php-config --enable-fileinfo\\ &amp;&amp; make \\ &amp;&amp; make install \\ &amp;&amp; curl http://172.16.72.173/packages/amqp-1.9.3.tgz -o /usr/local/src/php-7.1.3/ext/amqp-1.9.3.tgz \\ &amp;&amp; cd /usr/local/src/php-7.1.3/ext \\ &amp;&amp; tar xf amqp-1.9.3.tgz \\ &amp;&amp; cd amqp-1.9.3 \\ &amp;&amp; /usr/local/php/bin/phpize \\ &amp;&amp; ./configure \\ --with-php-config=/usr/local/php/bin/php-config \\ &amp;&amp; make \\ &amp;&amp; make install \\ &amp;&amp; curl http://172.16.72.173/packages/mongodb-1.5.3.tgz -o /usr/local/src/php-7.1.3/ext/mongodb-1.5.3.tgz \\ &amp;&amp; cd /usr/local/src/php-7.1.3/ext \\ &amp;&amp; tar xf mongodb-1.5.3.tgz \\ &amp;&amp; cd mongodb-1.5.3 \\ &amp;&amp; /usr/local/php/bin/phpize \\ &amp;&amp; ./configure \\ --with-php-config=/usr/local/php/bin/php-config \\ &amp;&amp; make &amp;&amp; make install \\ &amp;&amp; cd /usr/local/src/php-7.1.3/ext/mysqli \\ &amp;&amp; /usr/local/php/bin/phpize \\ &amp;&amp; ./configure \\ --with-php-config=/usr/local/php/bin/php-config \\ &amp;&amp; make \\ &amp;&amp; make install \\ &amp;&amp; curl -o /usr/local/src/supervisor-3.4.0-1.el7.noarch.rpm http://172.16.72.173/packages/supervisor-3.4.0-1.el7.noarch.rpm \\ &amp;&amp; curl -o /usr/local/src/python-meld3-0.6.10-1.el7.x86_64.rpm http://172.16.72.173/packages/python-meld3-0.6.10-1.el7.x86_64.rpm \\ &amp;&amp; rpm -ivh /usr/local/src/python-meld3-0.6.10-1.el7.x86_64.rpm \\ &amp;&amp; rpm -ivh /usr/local/src/supervisor-3.4.0-1.el7.noarch.rpm \\ &amp;&amp; rm -rf /usr/local/src/* \\ &amp;&amp; yum -y autoremove gcc gcc-c++ make autoconf cmake\\ &amp;&amp; yum clean all \\ &amp;&amp; curl http://172.16.72.173/v2/php_config/php-fpm.conf -o /usr/local/php/etc/php-fpm.conf \\ &amp;&amp; curl http://172.16.72.173/v2/php_config/php.ini -o /usr/local/php/etc/php.ini \\ &amp;&amp; curl http://172.16.72.173/v2/php_config/www.conf -o /usr/local/php/etc/php-fpm.d/www.conf REDISFROM centos:centos7 RUN yum -y install epel-release \\ &amp;&amp; yum -y install redis \\ &amp;&amp; sed -i &#39;s/^bind 127.0.0.1/bind 0.0.0.0/&#39; /etc/redis.conf \\ &amp;&amp; sed -i &#39;s/^# requirepass foobared/requirepass 3IPvlX81kaflqzB/&#39; /etc/redis.conf CMD [&quot;/usr/bin/redis-server&quot;,&quot;/etc/redis.conf&quot;] GOLANGFROM centos:centos7 ADD go1.13.5.linux-amd64.tar.gz /usr/local/ RUN mkdir -p /data/www ENV GOROOT /usr/local/go/ ENV PATH $PATH:$GOROOT/bin:$GOPATH/bin ENV GOPATH /data/www/ ENV PATH $PATH:$GOPATH/bin ENV GO111MODULE on ENV GOPROXY https://goproxy.cn,direct WORKDIR /data/www/src/yanxiangbook CMD [&quot;bee&quot;,&quot;run&quot;] CODEBOXFROM registry.cn-hangzhou.aliyuncs.com/ysg_baseimage/codebox:v1 RUN mkdir /data/wwwroot/ -p &amp;&amp; adduser www -s /sbin/nologin -D -H","categories":[{"name":"Docker","slug":"Docker","permalink":"http://blog.3amupupup.online/categories/Docker/"}],"tags":[{"name":"Dockerfile","slug":"Dockerfile","permalink":"http://blog.3amupupup.online/tags/Dockerfile/"}]},{"title":"make","slug":"make","date":"2021-03-18T03:09:52.044Z","updated":"2021-03-18T03:09:52.045Z","comments":true,"path":"2021/03/18/make/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/make/","excerpt":"","text":"makeç®€ä»‹Linuxè‡ªåŠ¨åŒ–æ„å»ºå·¥å…·ï¼Œæ–¹ä¾¿å·¥ç¨‹çš„ç¼–è¯‘ã€‚ å•æ–‡ä»¶Makefile#include &lt;stdio.h&gt; int main() { int arr[10] = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}; int i; for(i = 0; i &lt; 10; i++) printf(&quot;%d &quot;,arr[i]); return 0; } for:for.c @gcc -o $@ for.c .PHONY:clean clean: @rm -rf for #åŠ ä¸Š@ç¬¦å·ï¼Œåœ¨æ‰§è¡Œmakeæ—¶å°±ä¸ä¼šå°†è¾“å‡ºæ˜¾ç¤ºåœ¨ç»ˆç«¯ä¸Š å¤šæ–‡ä»¶Makefileroot$ tree . â”œâ”€â”€ bar.c â”œâ”€â”€ bar.h â”œâ”€â”€ Makefile â””â”€â”€ test.c bar.h #pragma onece #include &lt;stdio.h&gt; #include &lt;string.h&gt; #include &lt;unistd.h&gt; #define N 101 bar.c #include &quot;bar.h&quot; void bar(void) { char bar[N]; memset(bar,&#39;\\0&#39;,sizeof(bar)); const char label[5]=&quot;|/-\\\\&quot;; int i = 0; while(i &lt; 100) { fflush(stdout); bar[i++] = &#39;#&#39;; printf(&quot;[%-100s][%3d%%][%c]\\r&quot;,bar,i,label[i%4]); usleep(10000); } printf(&quot;\\n&quot;); } test.c #include &quot;bar.h&quot; int main() { bar(); return 0; } Makefile cc = gcc #å®šä¹‰å˜é‡ä¸éœ€è¦å¸¦å¼•å· targetFile = test.o bar.o bin=test $(bin):$(targetFile) # è¡¨ç¤ºä¸€ä¸ªä¾èµ–å…³ç³» $(bin) çš„ç¼–è¯‘ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ä¾èµ–äº $(targetFile) $(cc) -o $@ $^ # $@ ä»£è¡¨ä¾èµ–å…³ç³»ä¸­çš„ç›®æ ‡æ–‡ä»¶ä¹Ÿå°±æ˜¯$(bin)=test,$^ ä»£è¡¨ä¾èµ–æ–‡ä»¶åˆ—è¡¨ä¹Ÿå°±æ˜¯$(targetFile)=test.o bar.o %.o:%.c $(cc) -c $&lt; # $&lt; ä»£è¡¨å½“å‰ç›®å½•ä¸‹æ‰€æœ‰ %.cæ–‡ä»¶çš„é›†åˆ .PHONY:clean clean: rm -rf $(targetFile) $(bin)","categories":[{"name":"Cè¯­è¨€","slug":"Cè¯­è¨€","permalink":"http://blog.3amupupup.online/categories/C%E8%AF%AD%E8%A8%80/"}],"tags":[{"name":"c","slug":"c","permalink":"http://blog.3amupupup.online/tags/c/"}]},{"title":"zabbix_key","slug":"zabbix_key","date":"2021-03-18T03:09:52.043Z","updated":"2021-03-18T03:09:52.044Z","comments":true,"path":"2021/03/18/zabbix_key/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/zabbix_key/","excerpt":"","text":"proc.num[&lt;name&gt;,&lt;user&gt;,&lt;state&gt;,&lt;cmdline&gt;] ï¼ˆè¿›ç¨‹æ•°é‡ã€‚ï¼‰ [operate@zabbix ~]$ zabbix_get -s 47.98.232.109 -p 10050 -k &quot;proc.num[,www,,]&quot; 428 [operate@zabbix ~]$ zabbix_get -s 47.98.232.109 -p 10050 -k &quot;proc.num[nginx,www,,]&quot; 8 [operate@zabbix ~]$ zabbix_get -s 47.98.232.109 -p 10050 -k &quot;proc.num[php-fpm,www,,]&quot; 420 net.if.in[if,&lt;mode&gt;]ï¼ˆç½‘å¡æµå…¥é‡ç»Ÿè®¡ã€‚ï¼‰ [operate@zabbix ~]$ zabbix_get -s 47.98.232.109 -p 10050 -k &quot;net.if.in[eth0,]&quot; 7439402782114 [operate@zabbix ~]$ zabbix_get -s 47.98.232.109 -p 10050 -k &quot;net.if.in[eth0,errors]&quot; 0 [operate@zabbix ~]$ zabbix_get -s 47.98.232.109 -p 10050 -k &quot;net.if.in[eth0,packets]&quot; 19550922396 [operate@zabbix ~]$ zabbix_get -s 47.98.232.109 -p 10050 -k &quot;net.if.in[eth0,dropped]&quot; 0 net.if.out[if,&lt;mode&gt;] ï¼ˆç½‘å¡æµå‡ºé‡ç»Ÿè®¡ã€‚ï¼‰ net.if.total[if,&lt;mode&gt;] ï¼ˆç½‘å¡çš„è¿›å‡ºæµé‡ç»Ÿè®¡ä¿¡æ¯çš„æ€»å’Œã€‚ï¼‰ net.tcp.listen[port] ï¼ˆæ£€æŸ¥æ­¤TCPç«¯å£æ˜¯å¦å¤„äºç›‘å¬çŠ¶æ€ã€‚ï¼‰ [operate@zabbix ~]$ zabbix_get -s 47.98.232.109 -p 10050 -k &quot;net.tcp.listen[443]&quot; 0 [operate@zabbix ~]$ zabbix_get -s 47.98.232.109 -p 10050 -k &quot;net.tcp.listen[80]&quot; 1 [operate@zabbix ~]$ zabbix_get -s 47.98.232.109 -p 10050 -k &quot;net.tcp.listen[9000]&quot; 1 net.tcp.port[&lt;ip&gt;,port] (æ£€æŸ¥æ˜¯å¦å¯ä»¥å°†TCPè¿æ¥åˆ°æŒ‡å®šçš„ç«¯å£ã€‚) [operate@zabbix ~]$ zabbix_get -s 47.98.232.109 -p 10050 -k &quot;net.tcp.port[,80]&quot; 1 [operate@zabbix ~]$ zabbix_get -s 47.98.232.109 -p 10050 -k &quot;net.tcp.port[,8080]&quot; 0 [operate@zabbix ~]$ zabbix_get -s 47.98.232.109 -p 10050 -k &quot;net.tcp.port[,9000]&quot; 1 [operate@zabbix ~]$ zabbix_get -s 47.98.232.109 -p 10050 -k &quot;net.tcp.port[47.98.232.213,9000]&quot; 0 [operate@zabbix ~]$ zabbix_get -s 47.98.232.109 -p 10050 -k &quot;net.tcp.port[47.98.232.213,80]&quot; 1 net.tcp.service[service,&lt;ip&gt;,&lt;port&gt;] (æ£€æŸ¥æœåŠ¡æ˜¯å¦æ­£åœ¨è¿è¡Œå¹¶æ¥å—TCPè¿æ¥ã€‚) [operate@zabbix ~]$ zabbix_get -s 47.98.232.109 -p 10050 -k &quot;net.tcp.service[http,47.98.232.109,80]&quot; 1 [operate@zabbix ~]$ zabbix_get -s 47.98.232.109 -p 10050 -k &quot;net.tcp.service[https,47.98.232.109,443]&quot; 0 net.tcp.service.perf ï¼ˆæ£€æµ‹TCPæœåŠ¡æ€§èƒ½ã€‚ï¼‰ [operate@zabbix ~]$ zabbix_get -s 47.98.232.109 -p 10050 -k &quot;net.tcp.service.perf[http,47.98.232.109,80]&quot; 0.001654 net.tcp.service.perf[service,&lt;ip&gt;,&lt;port&gt;] ï¼ˆè¿›ç¨‹CPUåˆ©ç”¨ç‡ç™¾åˆ†æ¯”ã€‚ï¼‰ proc.mem[&lt;name&gt;,&lt;user&gt;,&lt;mode&gt;,&lt;cmdline&gt;,&lt;memtype&gt;] ï¼ˆç”¨æˆ·è¿›ç¨‹ä½¿ç”¨çš„å†…å­˜ã€‚ï¼‰ [operate@zabbix ~]$ zabbix_get -s 47.98.232.109 -p 10050 -k &quot;proc.mem[,root]&quot; 101788995584 system.cpu.load[&lt;cpu&gt;,&lt;mode&gt;] ï¼ˆCPUè´Ÿè½½ã€‚ï¼‰ system.cpu.util[&lt;cpu&gt;,&lt;type&gt;,&lt;mode&gt;] ï¼ˆCPUåˆ©ç”¨ç‡ã€‚ï¼‰ system.run[command,&lt;mode&gt;] ï¼ˆåœ¨ä¸»æœºä¸Šè¿è¡ŒæŒ‡å®šçš„å‘½ä»¤,æ³¨æ„: è¦å¯ç”¨æ­¤åŠŸèƒ½ï¼ŒZabbix agenté…ç½®æ–‡ä»¶ å¿…é¡»åŒ…å«EnableRemoteCommands=1 é€‰é¡¹ã€‚ï¼‰ vfs.file.cksum[file] ï¼ˆæ–‡ä»¶checksumæ ¡éªŒï¼Œç”±UNIX cksumç®—æ³•è®¡ç®—å®ç°ã€‚ï¼‰ zabbix_get -s 47.98.232.109 -p 10050 -k &quot;vfs.file.cksum[/usr/local/nginx/conf/vhost/novel.conf]&quot; vfs.file.exists[file] ï¼ˆæ£€æµ‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚ï¼‰ vfs.file.size[file] ï¼ˆæ–‡ä»¶å¤§å°(æŒ‰å­—èŠ‚)ã€‚ï¼‰ vfs.fs.inode[fs,&lt;mode&gt;] ï¼ˆinodeçš„æ•°é‡æˆ–ç™¾åˆ†æ¯”ã€‚ï¼‰ [root@zabbix ~]# zabbix_get -s 47.98.232.109 -p 10050 -k &quot;vfs.fs.inode[/,used]&quot; 228387 [root@zabbix ~]# zabbix_get -s 47.98.232.109 -p 10050 -k &quot;vfs.fs.inode[/,pused]&quot; 8.712273 vfs.fs.size[fs,&lt;mode&gt;]ï¼ˆç£ç›˜ç©ºé—´ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œç”¨ç™¾åˆ†æ¯”è¡¨ç¤ºã€‚ï¼‰ [root@zabbix ~]# zabbix_get -s 47.98.232.109 -p 10050 -k &quot;vfs.fs.size[/,pused]&quot; 32.847219 vm.memory.size[&lt;mode&gt;] ï¼ˆå†…å­˜å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œä»¥ç™¾åˆ†æ¯”è¡¨ç¤ºã€‚ï¼‰ [root@zabbix ~]# zabbix_get -s 47.98.232.109 -p 10050 -k &quot;vm.memory.size[cached]&quot; 8009416704 [root@zabbix ~]# zabbix_get -s 47.98.232.109 -p 10050 -k &quot;vm.memory.size[buffers]&quot; 329150464 [root@zabbix ~]# zabbix_get -s 47.98.232.109 -p 10050 -k &quot;vm.memory.size[used]&quot; 12454846464 [root@zabbix ~]# zabbix_get -s 47.98.232.109 -p 10050 -k &quot;vm.memory.size[pused]&quot; 74.776654 web.page.get[host,&lt;path&gt;,&lt;port&gt;] ï¼ˆè·å–ç½‘é¡µå†…å®¹ï¼‰ [root@zabbix ~]# zabbix_get -s 47.98.232.109 -p 10050 -k &quot;web.page.get[www.baidu.com,/,80]&quot; web.page.perf[host,&lt;path&gt;,&lt;port&gt;] ï¼ˆåŠ è½½å®Œæ•´ç½‘é¡µçš„æ—¶é—´ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰ã€‚ï¼‰ [root@zabbix ~]# zabbix_get -s 47.98.232.109 -p 10050 -k &quot;web.page.perf[www.baidu.com,/,80]&quot; 0.023391 web.page.regexp[host,&lt;path&gt;,&lt;port&gt;,&lt;regexp&gt;,&lt;length&gt;,&lt;output&gt;] ï¼ˆåœ¨ç½‘é¡µä¸ŠæŸ¥æ‰¾å­—ç¬¦ä¸²ã€‚ï¼‰ [root@zabbix ~]# zabbix_get -s 47.98.232.109 -p 10050 -k &quot;web.page.regexp[www.baidu.com,/,80,baidu,100,1]&quot; 1","categories":[{"name":"è¿ç»´","slug":"è¿ç»´","permalink":"http://blog.3amupupup.online/categories/%E8%BF%90%E7%BB%B4/"}],"tags":[{"name":"zabbix","slug":"zabbix","permalink":"http://blog.3amupupup.online/tags/zabbix/"}]},{"title":"æŒ‡é’ˆ","slug":"æŒ‡é’ˆ","date":"2021-03-18T03:09:52.041Z","updated":"2021-03-18T03:09:52.042Z","comments":true,"path":"2021/03/18/æŒ‡é’ˆ/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/%E6%8C%87%E9%92%88/","excerpt":"","text":"1ã€å‡½æ•°æŒ‡é’ˆvoid(* signal( int, void(*)(int)) )(int); // signalæ˜¯ä¸€ä¸ªå‡½æ•°å£°æ˜ // signalå‡½æ•°çš„å‚æ•°æœ‰2ä¸ªï¼Œç¬¬ä¸€ä¸ªæ˜¯intï¼Œç¬¬äºŒä¸ªæ˜¯å‡½æ•°æŒ‡é’ˆï¼Œæ”¹å‡½æ•°æŒ‡é’ˆçš„å‚æ•°æ˜¯intï¼Œè¿”å›ç±»å‹æ˜¯void // signalå‡½æ•°çš„è¿”å›ç±»å‹ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼šè¯¥å‡½æ•°æŒ‡é’ˆæŒ‡å‘çš„å‡½æ•°çš„å‚æ•°æ˜¯intï¼Œè¿”å›ç±»å‹æ˜¯void //ç®€åŒ– typedef void(*pfun_t)(int); pfun_t signal(int, pfun_t); char* my_strcpy(char* dest, const char* src); char* (*pf)(char *, const char*)(); char* (*pfArr[4])(char *,const char *); 2ã€qsort demo#include &quot;stdlib.h&quot; #include &quot;string.h&quot; struct student{ char name[10]; int age; }; int CmpStudentAge(const void * e1, const void * e2){ return ((struct student*)e1)-&gt;age-((struct student*)e2)-&gt;age; } int CmpStudentName(const void * e1, const void * e2){ return strcmp(((struct student*)e1)-&gt;name, ((struct student*)e2)-&gt;name); } int main(){ struct student s[3] = {{\"zhangsan\",14}, {\"lisi\", 5}, {\"duwei\", 8}}; int len = sizeof(s) / sizeof(struct student); int sz = sizeof(struct student); qsort(s, len, sz, CmpStudentName); /* * ç¬¬ä¸€ä¸ªå‚æ•°ï¼šå¾…æ’åºæ•°ç»„çš„é¦–å…ƒç´ åœ°å€ * ç¬¬äºŒä¸ªå‚æ•°ï¼šå¾…æ’åºæ•°ç»„çš„å…ƒç´ ä¸ªæ•° * ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šå¾…æ’åºæ•°ç»„çš„æ¯ä¸ªå…ƒç´ çš„å¤§å°ï¼Œå•ä½æ˜¯å­—èŠ‚ * ç¬¬å››ä¸ªå‚æ•°ï¼šæ˜¯å‡½æ•°æŒ‡é’ˆï¼Œæ¯”è¾ƒä¸¤ä¸ªå…ƒç´ çš„å‡½æ•°çš„åœ°å€ï¼Œéœ€è¦è‡ªå·±å®ç° * å‡½æ•°æŒ‡é’ˆçš„ä¸¤ä¸ªå‚æ•°æ˜¯ï¼šå¾…æ¯”è¾ƒçš„ä¸¤ä¸ªå…ƒç´ çš„åœ°å€ * */ for (int i = 0; i &lt; 3; ++i) { printf(&quot;%s &quot;,s[i].name); } return 0; } 3ã€ç®€å•å®ç°qsort()ï¼Œå†’æ³¡æ’åºç‰ˆã€‚struct person{ char name[10]; int age; }; void Swap(char* buf1, char* buf2, int width){ for (int i = 0; i &lt; width; ++i) { char tmp = *buf1; *buf1 = *buf2; *buf2 = tmp; buf1++; buf2++; } } void bubble_sort(void*base, int sz, int width,int (*cmp)(const void * e1, const void * e2)){ for (int i = 0; i &lt; sz -1; ++i) { for (int j = 0; j &lt; sz - 1 - i; ++j) { if (cmp((char*)base+j*width, (char*)base+(j+1)*width) &gt; 0){ /* * å†’æ³¡æ’åºæ­¤å¤„çœç•¥ã€‚ * voidç±»å‹çš„æŒ‡é’ˆæ— æ³•è¿›è¡ŒæŒ‡é’ˆåŠ å‡æ“ä½œï¼Œæ‰€ä»¥å…ˆå°†å…¶è½¬æ¢æˆchar*ç±»å‹ï¼Œç„¶åé€šè¿‡å‡½æ•°ä¼ å‚ä¼ å…¥å¾…æ’åºæ•°ç»„ä¸­å…ƒç´ çš„size(å³widthï¼Œå•ä½å­—èŠ‚)ï¼Œ * ç„¶åé€šè¿‡ base + j*width è¿›è¡Œåœ°å€æ“ä½œï¼Œä¿è¯æ¯æ¬¡æ“ä½œéƒ½èƒ½å¤Ÿè·³è·ƒä¸€ä¸ªå…ƒç´ ã€‚ * */ Swap((char*)base+j*width, (char*)base+(j+1)*width, width); } } } } int CmpPersonAge(const void * e1, const void * e2){ return ((struct person*)e1)-&gt;age-((struct person*)e2)-&gt;age; } int CmpPersonName(const void * e1, const void * e2){ return strcmp(((struct person*)e1)-&gt;name, ((struct person*)e2)-&gt;name); } int cmp_int(const void * e1, const void * e2){ return *(int *)e1 - *(int *)e2; } int main(){ struct person p[3] = {{\"zhangsan\",14}, {\"lisi\", 5}, {\"duwei\", 8}}; int sz = sizeof(p) / sizeof(struct person); int width = sizeof(struct person); bubble_sort(p,sz,width,CmpPersonAge); for (int i = 0; i &lt; 3; ++i) { printf(&quot;%s &quot;,p[i].name); } printf(&quot;\\n&quot;); int num[10] = {1,5,2,6,3,9,0,8,7,4}; bubble_sort(num,10,sizeof(int), cmp_int); for (int i = 0; i &lt; 10; ++i) { printf(&quot;%d &quot;,num[i]); } printf(&quot;\\n&quot;); } 4ã€ç»ƒä¹ é¢˜int main(){ /* * é’ˆå¯¹64ä½æ“ä½œç³»ç»Ÿ * 1. sizeof(æ•°ç»„å) - æ•°ç»„åè¡¨ç¤ºæ•´ä¸ªæ•°ç»„ * 2. &amp;æ•°ç»„å - æ•°ç»„åè¡¨ç¤ºæ•´ä¸ªæ•°ç»„ * */ int a[] = {1,2,3,4}; printf(&quot;%d\\n&quot;,sizeof(a)); // 16 è¡¨ç¤ºè®¡ç®—æ•°ç»„çš„å¤§å°(ç‰¹æ®Š) printf(&quot;%d\\n&quot;,sizeof(a+0)); // 8 è¡¨ç¤ºæ•°ç»„aä¸­ç¬¬ä¸€ä¸ªå…ƒç´ çš„åœ°å€ printf(&quot;%d\\n&quot;,sizeof(*a)); // 4 è¡¨ç¤ºæ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼ printf(&quot;%d\\n&quot;,sizeof(a+1)); // 8 è¡¨ç¤ºæ•°ç»„aä¸­ç¬¬äºŒä¸ªå…ƒç´ çš„åœ°å€ printf(&quot;%d\\n&quot;,sizeof(a[1])); // 4 è¡¨ç¤ºæ•°ç»„ä¸­ç¬¬äºŒä¸ªå…ƒç´ çš„å€¼ printf(&quot;%d\\n&quot;,sizeof(&amp;a)); // 8 è¡¨ç¤ºæ•°ç»„çš„åœ°å€ printf(&quot;%d\\n&quot;,sizeof(*&amp;a)); // 16 *å’Œ&amp;æŠµæ¶ˆï¼Œaè¡¨ç¤ºæ•°ç»„ï¼Œåœ¨æ­¤è¡¨ç¤ºè®¡ç®—æ•°ç»„çš„å¤§å° printf(&quot;%d\\n&quot;,sizeof(&amp;a+1)); // 8 &amp;aæ˜¯åœ°å€ï¼Œåœ°å€åŠ ä¸€è¿˜æ˜¯åœ°å€ä¸”æ­¥é•¿ä¸ºè¢«åŠ åœ°å€çš„é•¿åº¦ printf(&quot;%d\\n&quot;,sizeof(&amp;a[0])); // 8 []çš„ä¼˜å…ˆçº§æ¯”&amp;é«˜ï¼Œå› æ­¤è¡¨ç¤ºæ•°ç»„aç¬¬ä¸€ä¸ªå…ƒç´ çš„åœ°å€ printf(&quot;%d\\n&quot;,sizeof(&amp;a[0]+1)); // 8 åœ°å€åŠ 1è¿˜æ˜¯åœ°å€ printf(&quot;-------\\n&quot;); char arr[] = {&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, &#39;f&#39;}; //è¿™ç§æ–¹å¼åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œéœ€è¦æ‰‹åŠ¨åŠ ä¸Š&#39;\\0&#39;ä½œä¸ºå­—ç¬¦ä¸²ç»“æŸç¬¦ printf(&quot;%d\\n&quot;,sizeof(arr)); // 6 è®¡ç®—æ•°ç»„çš„å¤§å°ï¼Œè€Œéå­—ç¬¦ä¸²çš„é•¿åº¦ printf(&quot;%d\\n&quot;,sizeof(arr+0)); // 1 ç¬¬ä¸€ä¸ªå­—ç¬¦çš„åœ°å€ printf(&quot;%d\\n&quot;,sizeof(*arr)); // 1 ç¬¬ä¸€ä¸ªå­—ç¬¦çš„é•¿åº¦ printf(&quot;%d\\n&quot;,sizeof(arr[1])); // 1 ç¬¬äºŒä¸ªå­—ç¬¦çš„é•¿åº¦ printf(&quot;%d\\n&quot;,sizeof(&amp;arr)); // 8 è¡¨ç¤ºæ•°ç»„çš„åœ°å€ printf(&quot;%d\\n&quot;,sizeof(&amp;arr+1)); // 8 è·³è¿‡æ•´ä¸ªæ•°ç»„ä¹‹åçš„åœ°å€ printf(&quot;%d\\n&quot;,sizeof(&amp;arr[0]+1)); // 8 è·³è¿‡ç¬¬ä¸€ä¸ªå…ƒç´ ä¹‹åçš„åœ°å€ printf(&quot;-------\\n&quot;); printf(&quot;strlen(arr)=%d\\n&quot;,strlen(arr)); // éšæœºå€¼ï¼Œå› ä¸ºæ²¡æœ‰&#39;\\0&#39;çš„ä½ç½®ä¸ç¡®å®š printf(&quot;strlen(arr+0)=%d\\n&quot;,strlen(arr+0)); // éšæœºå€¼ printf(&quot;strlen(&amp;arr)=%d\\n&quot;,strlen(&amp;arr)); // éšæœºå€¼ printf(&quot;strlen(&amp;arr+1)=%d\\n&quot;,strlen(&amp;arr+1)); // éšæœºå€¼ printf(&quot;strlen(&amp;arr[0]+1)=%d\\n&quot;,strlen(&amp;arr[0]+1)); // éšæœºå€¼ // printf(&quot;strlen(*arr)=%d\\n&quot;,strlen(*arr)); // error // printf(&quot;strlen(arr[1])=%d\\n&quot;,strlen(arr[1])); // err printf(&quot;\\n&quot;); char arr2[] = &quot;abcdef&quot;; //è¿™ç§æ–¹å¼ä¼šè‡ªåŠ¨åœ¨å­—ç¬¦ä¸²æœ«å°¾åŠ ä¸Š&#39;\\0&#39; printf(&quot;%d\\n&quot;,sizeof(arr2)); // 7 è¿˜æœ‰ä¸ªå­—ç¬¦ç»“æŸç¬¦ &#39;\\0&#39;ï¼Œæ‰€ä»¥æ•°ç»„å®é™…é•¿åº¦ä¸º7 printf(&quot;%d\\n&quot;,sizeof(arr2+0)); // 8 printf(&quot;%d\\n&quot;,sizeof(*arr2)); // 1 printf(&quot;%d\\n&quot;,sizeof(arr2[1])); // 1 printf(&quot;%d\\n&quot;,sizeof(&amp;arr2)); // 8 printf(&quot;%d\\n&quot;,sizeof(&amp;arr2+1)); // 8 printf(&quot;%d\\n&quot;,sizeof(&amp;arr2[0]+1)); // 8 printf(&quot;-------\\n&quot;); printf(&quot;%d\\n&quot;,strlen(arr2)); // 6 printf(&quot;%d\\n&quot;,strlen(arr2+0)); //6 printf(&quot;%d\\n&quot;,strlen(&amp;arr2)); //6 printf(&quot;%d\\n&quot;,strlen(&amp;arr2+1)); // éšæœºå€¼ printf(&quot;%d\\n&quot;,strlen(&amp;arr2[0]+1)); // 5 // printf(&quot;%d\\n&quot;,strlen(*arr2)); // error,a[0]ä¸ºa,açš„é˜¿æ–¯å¡ç ä¸º97ï¼Œstrlen(97)æŠ¥é”™ // printf(&quot;%d\\n&quot;,strlen(arr2[1])); // error,arr2[1]ä¸ºbï¼Œbçš„é˜¿æ–¯å¡ç å€¼ä¸º98ï¼Œstrlen(98)æŠ¥é”™ printf(&quot;-------\\n&quot;); char *p = &quot;abcdef&quot;; // char p[] = &quot;abcdef&quot;; printf(&quot;%d\\n&quot;,sizeof(p)); // 8 pæ˜¯æŒ‡é’ˆ printf(&quot;%d\\n&quot;,sizeof(p+1)); // 8 printf(&quot;%d\\n&quot;,sizeof(*p)); // 1 å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ printf(&quot;%d\\n&quot;,sizeof(p[0])); // 1 ç­‰ä»·äº *(p+0) printf(&quot;%d\\n&quot;,sizeof(&amp;p)); // 8 printf(&quot;%d\\n&quot;,sizeof(&amp;p+1)); // 8 printf(&quot;%d\\n&quot;,sizeof(&amp;p[0]+1)); // 8 printf(&quot;-------\\n&quot;); printf(&quot;%d\\n&quot;,strlen(p)); // 6 printf(&quot;%d\\n&quot;,strlen(p+1)); // 5 printf(&quot;%d\\n&quot;,strlen(&amp;p)); // éšæœºå€¼ printf(&quot;%d\\n&quot;,strlen(&amp;p+1)); // éšæœºå€¼ printf(&quot;%d\\n&quot;,strlen(&amp;p[0]+1)); // 5 // printf(&quot;%d\\n&quot;,strlen(*p)); // error // printf(&quot;%d\\n&quot;,strlen(p[0])); // error printf(&quot;-------\\n&quot;); int a2[3][4] = {0}; printf(&quot;sizeof(a2)=%d\\n&quot;,sizeof(a2)); // 48 printf(&quot;sizeof(a2[0][0])=%d\\n&quot;,sizeof(a2[0][0])); // 4 printf(&quot;sizeof(a2[0]=%d\\n&quot;,sizeof(a2[0])); // *(a2+0) = 16 printf(&quot;sizeof(a2[0]+1)=%d\\n&quot;,sizeof(a2[0]+1)); // 8 printf(&quot;sizeof(*(a2[0]+1))=%d\\n&quot;,sizeof(*(a2[0]+1))); // a2[0]è¡¨ç¤ºç¬¬ä¸€ä¸ªæ•°ç»„(å…ƒç´ ä¸ªæ•°ä¸º3çš„)ï¼Œåœ°å€+1è¡¨ç¤ºè·³è·ƒåˆ°ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥è¡¨ç¤ºa[0][1]=4 printf(&quot;sizeof(a2+1)=%d\\n&quot;,sizeof(a2+1)); // 8 printf(&quot;sizeof(*(a2+1)=%d\\n&quot;,sizeof(*(a2+1))); // è¡¨ç¤ºç¬¬äºŒä¸ªæ•°ç»„(å…ƒç´ ä¸ªæ•°ä¸º3çš„) æ‰€ä»¥ä¸º16 printf(&quot;sizeof(&amp;a2[0]+1)=%d\\n&quot;,sizeof(&amp;a2[0]+1)); // 8 printf(&quot;sizeof(*(&amp;a2[0]+1))=%d\\n&quot;,sizeof(*(&amp;a2[0]+1))); // 16 printf(&quot;sizeof(*a2)=%d\\n&quot;,sizeof(*a2)); // 16 printf(&quot;sizeof(a2[3])=%d\\n&quot;,sizeof(a2[3])); // 16 return 0; } 5ã€æ˜“é”™é¢˜int main(){ int a[5] = {1,2,3,4,5}; int *ptr = (int *)(&amp;a+1); printf(&quot;%d,%d\\n&quot;,*(a+1),*(ptr-1)); return 0; /* (&amp;a+1)è¡¨ç¤ºè·³è·ƒä¸€ä¸ªæ•°ç»„çš„é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯å…ƒç´ 5åçš„ç¬¬ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå†å°†å…¶è½¬æ¢æˆint*æŒ‡é’ˆã€‚ *(a+1)ç­‰ä»·äºa[1]ï¼Œç»“æœä¸º2ï¼›*(ptr-1)ï¼Œptræ˜¯å…ƒç´ 5åçš„åœ°å€ï¼Œå…¶ç±»å‹ä¸ºint*ï¼Œåœ¨å¯¹å…¶è¿›è¡ŒæŒ‡é’ˆæ“ä½œçš„æ—¶å€™å…¶æ­¥é•¿ä¸º4ï¼Œæ‰€ä»¥åœ¨-1æ—¶ä¼šå°†å…¶å†…å­˜åœ°å€å¾€å‰ç§»å››ä¸ªå­—èŠ‚ä¹Ÿå°±æ˜¯å…ƒç´ 5çš„åœ°å€ï¼Œæ‰€ä»¥ç»“æœä¸º5. _______________________ | 1 | 2 | 3 | 4 | 5 |ptr| */ } struct Test{ int Num; char *pcName; short sDate; char cha[2]; short sBa[4]; }*p; /* * å‡è®¾pçš„å€¼ä¸º0x100000 * å·²çŸ¥ï¼Œç»“æ„ä½“Testç±»å‹çš„å˜é‡å¤§å°æ˜¯20å­—èŠ‚ * */ int main(){ p = (struct Test*)0x100000; printf(&quot;%p\\n&quot;,p+0x1); // 0x100014 printf(&quot;%p\\n&quot;,(unsigned long)p + 0x1); // 0x100001, 0x100000è½¬æ¢æˆ10è¿›åˆ¶ä¸º1048576ï¼Œå†+1ä½1048577ï¼Œå› ä¸ºæ‰“å°çš„æ˜¯%pï¼Œæ‰€æœ‰ä¼šå°†å…¶æ˜¾ç¤ºä¸º16è¿›åˆ¶ï¼Œç»“æœä¸º0x100001 printf(&quot;%p\\n&quot;,(unsigned int*)p + 0x1); // 0x100004 return 0; } int main(){ /* * å°ç«¯å­˜å‚¨ * */ int a[4] = {1,2,3,4}; int *ptr1 = (int *)(&amp;a+1); int *ptr2 = (int *)((int)a +1); printf(&quot;%x\\n&quot;,ptr1[-1]); // 0x4 printf(&quot;%x\\n&quot;,*ptr2); // 2000000 return 0; /* * aæ•°ç»„çš„å†…å­˜åˆ†éƒ¨å¦‚ä¸‹ï¼š * |01 00 00 00|02 00 00 00|03 00 00 00|04 00 00 00| * int(a)+1è¡¨ç¤ºæŒ‡å‘aåœ°å€çš„åä¸€ä¸ªå­—èŠ‚(01åçš„é‚£ä¸ªä½ç½®ä¹Ÿå°±æ˜¯00)ï¼Œç„¶åå†è½¬æ¢æˆint*ç±»å‹ï¼Œè§£å¼•ç”¨ptr2æ—¶ä¼šå¾€åè¯»å–å››ä¸ªå­—èŠ‚å³ï¼š00 00 00 02 * å› ä¸ºæ˜¯å°ç«¯å­˜å‚¨ï¼Œæ‰€ä»¥ç»“æœä¸º 02000000 * */ } int main(){ int a[5][5]; int(*p)[4]; p = a; printf(&quot;%p,%d\\n&quot;,&amp;p[4][2] - &amp;a[4][2],&amp;p[4][2] - &amp;a[4][2]); } int main(){ int aa[2][5] = {1,2,3,4,5,6,7,8,9,10}; int *ptr = (int *)(&amp;aa+1); int *ptr2 = (int *)(*(aa+1)); // *(aa+1) ç­‰ä»·äº aa[1]ä¹Ÿå°±æ˜¯ç¬¬äºŒä¸ªæ•°ç»„çš„æ•°ç»„å printf(&quot;%d,%d\\n&quot;, *(ptr-1), *(ptr2-1)); // 10,5 return 0; } int main(){ char *a[] = {&quot;work&quot;,&quot;at&quot;,&quot;alibaba&quot;}; char**pa = a; pa++; printf(&quot;%s\\n&quot;,*pa); return 0; /* * aæ˜¯ä¸€ä¸ªæŒ‡é’ˆæ•°ç»„ï¼Œæ•°ç»„æœ‰ä¸‰ä¸ªchar*ç±»å‹çš„æŒ‡é’ˆï¼Œå°†aèµ‹å€¼ç»™char**paï¼Œpaè¿˜æ˜¯ä¸€ä¸ªæŒ‡é’ˆ * æŒ‡é’ˆ+1ä¼šæ ¹æ®è‡ªå·±çš„ç±»å‹æ¥å†³å®šæ­¥é•¿ï¼Œè€Œpaçš„ç±»å‹å°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œæ‰€ä»¥æ­¥é•¿ä¸º8å­—èŠ‚(64ä½æ“ä½œç³»ç»Ÿ)ï¼Œ * paä¹Ÿå°±æ˜¯aï¼Œå†åŠ ä¸Šå…«ä¸ªå­—èŠ‚ï¼ŒæŒ‡å‘äº†aæ•°ç»„ä¸­çš„ç¬¬äºŒä¸ªå…ƒç´ ã€‚æ‰€ä»¥æ‰“å°ç»“æœä¸ºat * */ } int main(){ char *c[] = {&quot;ENTER&quot;, &quot;NEW&quot;, &quot;POINT&quot;, &quot;FIRST&quot;}; char**cp[] = {c+3,c+2,c+1,c}; char***cpp = cp; printf(&quot;%s\\n&quot;,**++cpp); // POINT printf(&quot;%s\\n&quot;,*--*++cpp + 3); // ER printf(&quot;%s\\n&quot;,*cpp[-2]+3); // cpp[-2] ç­‰ä»·äº *(cpp-2),æ‰€ä»¥å¾—åˆ° **(cpp-2) + 3 ,ç»“æœST printf(&quot;%s\\n&quot;,cpp[-1][-1]+1); // *(*(cpp-1)-1) + 1 ,ç»“æœEW } #include &quot;stdio.h&quot; #define OFFSETOF(struct_name, member_name) (int)&amp;(((struct_name*)0)-&gt;member_name) struct S{ char c1; int a; char c2; }; int main(){ printf(&quot;%d\\n&quot;,sizeof(struct S)); printf(&quot;%d\\n&quot;,OFFSETOF(struct S,c1)); printf(&quot;%d\\n&quot;,OFFSETOF(struct S,a)); printf(&quot;%d\\n&quot;,OFFSETOF(struct S,c2)); return 0; } //é¢„å¤„ç†ä¹‹å: /* struct S{ char c1; int a; char c2; }; int main(){ printf(&quot;%d\\n&quot;,sizeof(struct S)); printf(&quot;%d\\n&quot;,(int)&amp;(((struct S*)0)-&gt;c1)); printf(&quot;%d\\n&quot;,(int)&amp;(((struct S*)0)-&gt;a)); printf(&quot;%d\\n&quot;,(int)&amp;(((struct S*)0)-&gt;c2)); return 0; } */","categories":[{"name":"Cè¯­è¨€","slug":"Cè¯­è¨€","permalink":"http://blog.3amupupup.online/categories/C%E8%AF%AD%E8%A8%80/"}],"tags":[{"name":"cè¯­è¨€åŸºç¡€","slug":"cè¯­è¨€åŸºç¡€","permalink":"http://blog.3amupupup.online/tags/c%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80/"}]},{"title":"jenkinsç»“åˆrsyncåŒæ­¥ä»£ç ","slug":"jenkinsç»“åˆrsyncåŒæ­¥ä»£ç ","date":"2021-03-18T03:09:52.040Z","updated":"2021-03-18T03:09:52.041Z","comments":true,"path":"2021/03/18/jenkinsç»“åˆrsyncåŒæ­¥ä»£ç /","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/jenkins%E7%BB%93%E5%90%88rsync%E5%90%8C%E6%AD%A5%E4%BB%A3%E7%A0%81/","excerpt":"","text":"èƒŒæ™¯ï¼šä¹‹å‰å‘å¸ƒä»£ç ä¸€ç›´ä½¿ç”¨çš„ä¸€ä¸ªjenkinsæ’ä»¶ Publish over SSHï¼Œå¦‚æœæ˜¯javaè¯­è¨€ä¸å­˜åœ¨é—®é¢˜ï¼Œæ¯æ¬¡åªæ‹·è´ä¸€ä¸ªjaråŒ…ï¼Œä½†æ˜¯å¦‚æœæ˜¯å‰ç«¯æˆ–è€…phpè¿™ç§ç±»å‹çš„ä»£ç ä¼šå­˜åœ¨é—®é¢˜ï¼šå‡å¦‚åœ¨gitlabä»“åº“åˆ é™¤ä¸€ä¸ªæ–‡ä»¶ï¼Œjenkinsæ‹‰å–æ›´æ–°å†é€šè¿‡Publish over SSHæ¨é€åˆ°æœåŠ¡å™¨ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­åœ¨gitlabä»“åº“è¢«åˆ é™¤çš„æ–‡ä»¶åœ¨è¿œç«¯æœåŠ¡å™¨ä¸Šæ˜¯ä¸ä¼šè¢«åˆ é™¤çš„ï¼Œå› ä¸ºPublish over SSHåªä¼šåšå¢é‡æ›´æ–°ã€‚å¦‚æœä»£ç ç»å¸¸æ·»åŠ åˆ é™¤æ–‡ä»¶ï¼Œé‚£ä¹ˆè¿œç¨‹æœºå™¨ä¸Šçš„ä»£ç æ–‡ä»¶å°±ä¼šè¶Šå †è¶Šå¤šã€‚ webæœºå™¨ï¼šå®‰è£…rsync [root@yanxiang_test webapp]# cat /etc/rsyncd.conf # /etc/rsyncd: configuration file for rsync daemon mode #åŒæ­¥è¿‡æ¥åæ–‡ä»¶çš„ä¸»ç»„ uid = nginx gid = nginx use chroot = yes max connections = 200 timeout = 300 pid file = /var/run/rsyncd.pid lock file = /var/run/rsync.lock log file = /var/log/rsyncd.log ignore errors read only = false list = false hosts allow = * hosts deny =10.0.8.9 #è¦åœ¨æœ¬æœºåˆ›å»ºçš„ç”¨æˆ· auth users = ysg #å†…å®¹æ ¼å¼ä¸º user:passwd #æ–‡ä»¶æƒé™600 secrets file = /etc/rsync.password #åŒæ­¥åˆ°æœ¬æœºçš„ç›®å½• [webapp] path = /var/webapp/ [root@yanxiang_test webapp]# cat /etc/rsync.password ysg:123456xxx [root@yanxiang_test webapp]# jenkinsæœºå™¨ï¼šå®‰è£…rsync [root@izbp1gldj1nzq5934tk5czz ~]# cat /etc/rsync.password #æ–‡ä»¶æƒé™600 #åªéœ€è¦å­˜å‚¨å¯†ç å°±è¡Œäº†ï¼Œå’Œwebæœºå™¨çš„å¯†ç ä¸€æ · 123456xxx [root@izbp1gldj1nzq5934tk5czz ~]# rsync -rltDqzp --no-o --no-g --delete /root/.jenkins/workspace/go_script ysg@172.16.72.173::webapp --exclude &quot;.git&quot; --password-file=/etc/rsync.password #å‚æ•°è§£é‡Š # -r é€’å½’ # -l å¤åˆ¶ç¬¦å·é“¾æ¥ä¸ºç¬¦å·é“¾æ¥ # -t ä¿ç•™ä¿®æ”¹æ—¶é—´ # --no-o --no-g ä¸æ”¹å˜ä¸»ç»„ # --delete åˆ é™¤å·®å¼‚æ–‡ä»¶ # /root/.jenkins/workspace/go_script åŒæ­¥ç›®å½• # --exclude &quot;.git&quot; éœ€è¦æ’é™¤çš„ç›®å½•æˆ–è€…æ–‡ä»¶ï¼Œå¤šä¸ª--excludeæŒ‡å®šå¤šä¸ªç›®å½•æˆ–æ–‡ä»¶ # --password-file ysgç”¨æˆ·å’Œè¿œç¨‹æœºå™¨è®¤è¯çš„å¯†ç  jenkinsä¸Šçš„é…ç½®ï¼š","categories":[{"name":"è¿ç»´","slug":"è¿ç»´","permalink":"http://blog.3amupupup.online/categories/%E8%BF%90%E7%BB%B4/"}],"tags":[{"name":"jenkins","slug":"jenkins","permalink":"http://blog.3amupupup.online/tags/jenkins/"}]},{"title":"ç¬¬ä¹ç«  è™šæ‹Ÿå†…å­˜","slug":"ç¬¬ä¹ç«  è™šæ‹Ÿå†…å­˜","date":"2021-03-18T03:09:52.039Z","updated":"2021-03-18T03:09:52.040Z","comments":true,"path":"2021/03/18/ç¬¬ä¹ç«  è™šæ‹Ÿå†…å­˜/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/%E7%AC%AC%E4%B9%9D%E7%AB%A0%20%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98/","excerpt":"","text":"ç¬¬ä¹ç« ï¼šè™šæ‹Ÿå†…å­˜9.1 ç‰©ç†å’Œè™šæ‹Ÿå¯»å€ç‰©ç†å¯»å€ï¼š è¯¥ç¤ºä¾‹çš„ä¸Šä¸‹æ–‡æ˜¯ä¸€æ¡åŠ è½½æŒ‡ä»¤ã€‚å½“cpuåŠ è½½è¿™æ¡æŒ‡ä»¤æ—¶ï¼Œä¼šç”Ÿæˆä¸€ä¸ªæœ‰æ•ˆç‰©ç†åœ°å€ï¼Œé€šè¿‡å†…å­˜æ€»çº¿ï¼ŒæŠŠå®ƒä¼ é€’ç»™ä¸»å­˜ã€‚ä¸»å­˜å–å‡ºä»ç‰©ç†åœ°å€4å¼€å§‹çš„å››ä¸ªå­—èŠ‚ï¼Œå¹¶å°†å®ƒè¿”å›ç»™cpuï¼Œcpuä¼šå°†å®ƒå­˜æ”¾åœ¨ä¸€ä¸ªå¯„å­˜å™¨é‡Œã€‚ è™šæ‹Ÿå¯»å€ï¼š ä½¿ç”¨è™šæ‹Ÿåœ°å€ï¼Œcpué€šè¿‡ç”Ÿæˆä¸€ä¸ªè™šæ‹Ÿåœ°å€(Virtual Address,VA)æ¥è®¿é—®ä¸»å­˜ï¼Œè¿™ä¸ªè™šæ‹Ÿåœ°å€åœ¨è¢«é€åˆ°ä¸»å­˜ä¹‹å‰å…ˆè½¬æ¢æˆé€‚å½“çš„è™šæ‹Ÿåœ°å€(Memory Manager Unitç®€ç§°MMUï¼šå†…å­˜ç®¡ç†å•å…ƒï¼Œåˆ©ç”¨å­˜æ”¾åœ¨ä¸»å­˜ä¸­çš„æŸ¥è¯¢è¡¨æ¥åŠ¨æ€ç¿»è¯‘è™šæ‹Ÿåœ°å€)ï¼Œä¸»å­˜æ”¶åˆ°ç¿»è¯‘è¿‡çš„åœ°å€(ç‰©ç†åœ°å€)ä¹‹åä»ç‰©ç†å†…å­˜ä¸Šå–å‡ºæ•°æ®å¹¶è¿”å›ç»™cpuã€‚ 9.2 åœ°å€ç©ºé—´åœ°å€ç©ºé—´ï¼šä¸€ä¸ªéè´Ÿæ•´æ•°åœ°å€çš„æœ‰åºé›†åˆã€‚ä¸ºäº†ç®€åŒ–è®¨è®ºï¼Œæ€»æ˜¯å‡è®¾ä½¿ç”¨çš„æ˜¯çº¿æ€§åœ°å€ç©ºé—´ã€‚ åœ¨ä¸€ä¸ªå¸¦è™šæ‹Ÿå†…å­˜çš„ç³»ç»Ÿï¼ŒCPUä»ä¸€ä¸ªæœ‰N=2^nä¸ªåœ°å€çš„ç©ºé—´ä¸­ç”Ÿæˆè™šæ‹Ÿåœ°å€ï¼Œç§°ä¸ºè™šæ‹Ÿåœ°å€ç©ºé—´ã€‚ {0, 1, 2, 3,â€¦,N-1} ä¸€ä¸ªåŒ…å«N=2^nä¸ªåœ°å€çš„è™šæ‹Ÿåœ°å€ç©ºé—´å«åšä¸€ä¸ªnä½åœ°å€ç©ºé—´ã€‚ä¾‹å¦‚32ä½æ“ä½œç³»ç»Ÿ(2^32)ã€64ä½æ“ä½œç³»ç»Ÿ(2^64)ã€‚ ä¸»å­˜ä¸­çš„æ¯ä¸ªå­—èŠ‚éƒ½æœ‰ä¸€ä¸ªé€‰è‡ªè™šæ‹Ÿç©ºé—´çš„åœ°å€å’Œä¸€ä¸ªé€‰è‡ªç‰©ç†ç©ºé—´çš„åœ°å€ã€‚ è™šæ‹Ÿåœ°å€ä½æ•°(n) è™šæ‹Ÿåœ°å€æ•°(N) æœ€å¤§çš„å¯èƒ½è™šæ‹Ÿåœ°å€ 8 2^8=256 byte 2^8-1=255 16 2^16=64 K 2^16-1 32 2^32 = 4096M = 4G 2^32-1 48 2^48 = 256T 2^48-1 64 2^64 = 16E 2^64-1 9.3 è™šæ‹Ÿå†…å­˜ä½œä¸ºç¼“å­˜å·¥å…·1ã€ä»€ä¹ˆæ˜¯è™šæ‹Ÿå†…å­˜ï¼Ÿè™šæ‹Ÿå†…å­˜æ˜¯ç£ç›˜ä¸Š(è¾ƒä½å±‚)è¿ç»­Nä¸ªå­—èŠ‚ç»„æˆçš„æ•°ç»„ï¼Œæ¯ä¸ªå­—èŠ‚éƒ½æœ‰å”¯ä¸€çš„è™šæ‹Ÿåœ°å€ä½œä¸ºæ•°ç»„çš„ç´¢å¼•ï¼Œç£ç›˜ä¸Šæ•°ç»„çš„å†…å®¹(æŒ‡çš„æ˜¯æ•°æ®)è¢«ç¼“å­˜åœ¨ä¸»å­˜ä¸­ã€‚(è™šæ‹Ÿé¡µå­˜åœ¨äºç£ç›˜ä¸Š) ç‰©ç†å†…å­˜è¢«åˆ†éš”æˆç‰©ç†é¡µ(Physical Page,PP)ã€‚ VMç³»ç»Ÿå°†è™šæ‹Ÿå†…å­˜åˆ†éš”æˆè™šæ‹Ÿé¡µ(Virtual Page,VP)ã€‚ è™šæ‹Ÿé¡µé¢çš„é›†åˆåˆ†ä¸ºä¸‰ä¸ªä¸ç›¸äº¤çš„å­é›†ï¼š æœªåˆ†é…çš„(VMç³»ç»Ÿè¿˜æœªåˆ†é…æˆ–è€…æœªåˆ›å»ºçš„é¡µï¼Œæœªåˆ†é…çš„å—æ²¡æœ‰ä»»ä½•æ•°æ®å’Œä»–ä»¬ç›¸å…³è”ï¼Œæ‰€ä»¥ä¸å ç”¨ä»»ä½•ç£ç›˜ç©ºé—´ï¼Œlinuxå‘½ä»¤freeåœ¨è®¡ç®—å†…å­˜ä½¿ç”¨é‡æ—¶ï¼Œæœªåˆ†é…çš„ ä¸ä¼šè¢«è®°å…¥)ã€‚ ç¼“å­˜çš„(å·²ç¼“å­˜åœ¨ç‰©ç†å†…å­˜ä¸­çš„å·²åˆ†é…é¡µ)ã€‚ æœªç¼“å­˜çš„(æœªç¼“å­˜åœ¨ç‰©ç†å†…å­˜ä¸­çš„å·²åˆ†é…é¡µ)ã€‚ 2ã€DRAMç¼“å­˜ç»„ç»‡ç»“æ„ SRAMï¼šè¡¨ç¤ºä½äºcpuå’Œä¸»å­˜ä¹‹é—´çš„L1ã€L2ã€L3é«˜é€Ÿç¼“å­˜ã€‚ DRAMï¼šè¡¨ç¤ºè™šæ‹Ÿå†…å­˜ç³»ç»Ÿçš„ç¼“å­˜ï¼Œå®ƒåœ¨ä¸»å­˜ä¸­ç¼“å­˜è™šæ‹Ÿé¡µã€‚ ç›´ å†™ï¼šå½“ CPU è¦å°†æ•°æ®å†™å…¥å†…å­˜æ—¶ é™¤äº†æ›´æ–°ç¼“å†²å†…å­˜(é«˜é€Ÿç¼“å­˜L1ã€L2ã€L3)ä¸Šçš„æ•°æ®å¤–ä¹Ÿå°†æ•°æ®å†™åœ¨ DRAM ä¸­ ä»¥ç»´æŒä¸»å­˜ä¸ç¼“å†²å†…å­˜çš„ä¸€è‡´æ€§ å½“è¦å†™å…¥å†…å­˜çš„æ•°æ®ä¸€å¤š é€Ÿåº¦è‡ªç„¶å°±æ…¢äº†ä¸‹æ¥ å› å†™ï¼šæ¯å½“ CPU è¦å°†æ•°æ®å†™å…¥å†…å­˜æ—¶ åªä¼šå…ˆæ›´æ–°ç¼“å†²å†…å­˜(é«˜é€Ÿç¼“å­˜L1ã€L2ã€L3)ä¸Šçš„æ•°æ® éšåå†è®©ç¼“å†²å†…å­˜åœ¨æ€»çº¿ä¸å¡è½¦çš„æ—¶å€™ æ‰æŠŠæ•°æ®å†™å› DRAM æ‰€ä»¥é€Ÿåº¦è‡ªç„¶å¿«å¾—å¤š 3ã€é¡µè¡¨(å°†è™šæ‹Ÿé¡µæ˜ å°„åˆ°ç‰©ç†é¡µ)è™šæ‹Ÿå†…å­˜å¿…é¡»æœ‰æŸç§æ–¹æ³•æ¥åˆ¤å®šä¸€ä¸ªè™šæ‹Ÿé¡µæ˜¯å¦ç¼“å­˜åœ¨DRAMä¸­çš„æŸä¸ªåœ°æ–¹ã€‚å¦‚æœæ˜¯ï¼Œç³»ç»Ÿè¿˜å¿…é¡»ç¡®å®šè¿™ä¸ªè™šæ‹Ÿé¡µå­˜æ”¾åœ¨å“ªä¸ªç‰©ç†é¡µ(ä¸»å­˜)ã€‚å¦‚æœä¸å‘½ä¸­è¿˜å¿…é¡»åˆ¤æ–­è¿™ä¸ªè™šæ‹Ÿé¡µå­˜æ”¾åœ¨ç£ç›˜çš„å“ªä¸ªä½ç½®ä¸Šï¼Œåœ¨ç‰©ç†é¡µä¸­é€‰æ‹©ä¸€ä¸ªç‰ºç‰²é¡µï¼Œå¹¶å°†è™šæ‹Ÿé¡µä»ç£ç›˜å¤åˆ¶åˆ°DRAMä¸­ï¼Œæ›¿æ¢è¿™ä¸ªç‰ºç‰²é¡µã€‚(æ“ä½œç³»ç»Ÿä¸ºæ¯ä¸ªè¿›ç¨‹éƒ½ç»´æŠ¤ä¸€ä¸ªç‹¬ç«‹çš„é¡µè¡¨) é¡µè¡¨ï¼šå°†è™šæ‹Ÿé¡µæ˜ å°„åˆ°ç‰©ç†é¡µã€‚æ¯æ¬¡åœ°å€ç¿»è¯‘ç¡¬ä»¶å°†ä¸€ä¸ªè™šæ‹Ÿåœ°å€è½¬æ¢ä¸ºç‰©ç†åœ°å€æ—¶ï¼Œéƒ½ä¼šè¯»å–é¡µè¡¨ï¼Œæ“ä½œç³»ç»Ÿè´Ÿè´£ç»´æŠ¤é¡µè¡¨çš„å†…å®¹ï¼Œä»¥åŠåœ¨ç£ç›˜ä¸DRAMä¹‹é—´æ¥å›ä¼ é€é¡µã€‚ æˆ‘ä»¬å°†å‡è®¾æ¯ä¸ªPTEæ˜¯ç”±ä¸€ä¸ªæœ‰æ•ˆä½(valid bit)å’Œä¸€ä¸ªnä½åœ°å€å­—æ®µç»„æˆï¼Œæœ‰æ•ˆä½è¡¨æ˜äº†è¯¥è™šæ‹Ÿé¡µå½“å‰æ˜¯å¦è¢«ç¼“å­˜åœ¨DRAMä¸­ã€‚å¦‚æœè®¾ç½®äº†æœ‰æ•ˆä½ï¼Œé‚£ä¹ˆåœ°å€å­—æ®µå°±è¡¨ç¤ºDRAMä¸­ç›¸åº”çš„ç‰©ç†é¡µçš„èµ·å§‹ä½ç½®ï¼Œè¿™ä¸ªç‰©ç†é¡µä¸­ç¼“å­˜äº†è¯¥è™šæ‹Ÿé¡µã€‚ å¦‚æœæ²¡æœ‰è®¾ç½®æœ‰æ•ˆä½ï¼Œé‚£ä¹ˆä¸€ä¸ªç©ºåœ°å€è¡¨ç¤ºè¿™ä¸ªè™šæ‹Ÿé¡µè¿˜æœªè¢«åˆ†é…ã€‚å¦åˆ™ï¼Œè¿™ä¸ªåœ°å€å°±æŒ‡å‘è¯¥è™šæ‹Ÿé¡µåœ¨ç£ç›˜ä¸Šçš„èµ·å§‹ä½ç½®ã€‚ ç¡®å®šè™šæ‹Ÿåœ°å€å¤§å°(n)å’Œé¡µå¤§å°(P)çš„ç»„åˆéœ€è¦çš„PTEæ•°é‡ã€‚ n(ä½) P=2^p PTEæ•°é‡ 16 4K 2^16 / 2^12 = 16 16 8K 2^16 / 2^13 = 8 32 4K 2^32 / 2^12 = 2^20 32 8K 2^32 / 2^13 = 2^19 4ã€ç¼ºé¡µDRAMç¼“å­˜ä¸å‘½ä¸­ç§°ä¸ºç¼ºé¡µã€‚ è‡ªå·±çš„ç†è§£ï¼šåœ¨cpuè·å–è™šæ‹Ÿé¡µä¸­çš„æ•°æ®æ—¶ï¼Œåœ°å€ç¿»è¯‘ç¡¬ä»¶å»è¯»é¡µè¡¨çš„é¡µè¡¨è®°å½•çš„æœ‰æ•ˆä½ï¼Œå¦‚æœæœ‰æ•ˆä½ä¸º0åˆ™æ¨æ–­å‡ºè¯¥è™šæ‹Ÿé¡µæœªè¢«ç¼“å­˜ï¼Œå¹¶ä¸”è§¦å‘ä¸€ä¸ªç¼ºé¡µå¼‚å¸¸ã€‚ç¼ºé¡µå¼‚å¸¸è°ƒç”¨å†…æ ¸ä¸­çš„ç¼ºé¡µå¼‚å¸¸å¤„ç†ç¨‹åºï¼Œè¯¥ç¨‹åºä¼šåœ¨ä¸»å­˜çš„PP(ç‰©ç†é¡µ)ä¸­é€‰æ‹©ä¸€ä¸ªè¢«ç¼“å­˜çš„VPä½œä¸ºç‰ºç‰²é¡µ(å¦‚æœç‰ºç‰²é¡µä¸­çš„æ•°æ®è¢«ä¿®æ”¹è¿‡é‚£ä¹ˆå°±ä¼šå°†æ•°æ®å†™ä¼šç£ç›˜)ï¼Œæ¥ä¸‹æ¥å°†è¦è¢«ç¼“å­˜çš„vpä»ç£ç›˜ä¸­åŠ è½½å‡ºæ¥ç¼“å­˜åˆ°ä¸»å­˜ä¸Šå»(æ›¿æ¢ç‰ºç‰²é¡µ)ã€‚ CPUå¼•ç”¨VP3ä¸­çš„ä¸€ä¸ªå­—ï¼Œåœ°å€ç¿»è¯‘ç¡¬ä»¶å°†è™šæ‹Ÿåœ°å€ä½œä¸ºä¸€ä¸ªç´¢å¼•(è™šæ‹Ÿåœ°å€åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šè™šæ‹Ÿé¡µå·[VPN:virtual page number]å’Œè™šæ‹Ÿé¡µåç§»é‡[VPO:virtual page offset]ï¼Œä½¿ç”¨è™šæ‹Ÿé¡µå·ä½œä¸ºç´¢å¼•)æ¥å®šä½PTE3ï¼Œé€šè¿‡è¯»å–PTE3ï¼šæœ‰æ•ˆä¸ºä¸º0ä¸”åœ°å€ä¸ä¸ºnullï¼Œæ‰€ä»¥å¾—å‡ºVP3æ²¡æœ‰è¢«ç¼“å­˜åœ¨ç‰©ç†å†…å­˜ä¸­ä¸”å¾—åˆ°äº†VP3çš„ç£ç›˜åœ°å€ï¼Œæ­¤æ—¶è§¦å‘ç¼ºé¡µå¼‚å¸¸ï¼Œç¼ºé¡µå¼‚å¸¸è°ƒç”¨å†…æ ¸ä¸­çš„ç¼ºé¡µå¼‚å¸¸å¤„ç†ç¨‹åºï¼Œè¯¥ç¨‹åºä¼šé€‰æ‹©ä¸€ä¸ªç‰ºç‰²é¡µ(PP3ä¸­çš„VP4ï¼Œå¦‚æœVP4çš„å†…å®¹è¢«ä¿®æ”¹äº†ï¼Œé‚£ä¹ˆå†…æ ¸å°±ä¼šå°†VP4çš„æ•°æ®å¤åˆ¶å›ç£ç›˜)ï¼Œæ— è®ºå“ªç§æƒ…å†µï¼Œå†…æ ¸éƒ½ä¼šä¿®æ”¹VP4çš„é¡µè¡¨æ¡ç›®ï¼Œåæ˜ VP4ä¸åœ¨ç¼“å­˜åœ¨ä¸»å­˜ä¸­çš„äº‹å®ã€‚ éšåï¼Œå†…æ ¸ä»ç£ç›˜å¤åˆ¶VP3åˆ°å†…å­˜PP3ï¼Œå¹¶æ›´æ–°PTE3(å°†æœ‰æ•ˆä¸ºè®¾ç½®ä¸º1ï¼Œåœ°å€ä½è®¾ç½®ä¸ºç‰©ç†é¡µå·)ï¼Œéšåè¿”å›ï¼Œå½“å¼‚å¸¸å¤„ç†ç¨‹åºè¿”å›çš„æ—¶å€™ï¼Œå®ƒä¼šé‡å¯å¯¼è‡´ç¼ºé¡µçš„æŒ‡ä»¤ï¼Œè¯¥æŒ‡ä»¤ä¼šæŠŠç¼ºé¡µçš„è™šæ‹Ÿåœ°å€é‡æ–°å‘é€ç»™åœ°å€ç¿»è¯‘ç¡¬ä»¶ï¼Œä½†æ˜¯æ­¤æ—¶VP3å·²ç»ç¼“å­˜åœ¨ç‰©ç†å†…å­˜ä¸­äº†ï¼Œé‚£ä¹ˆé¡µå‘½ä¸­å°±èƒ½ç”±åœ°å€ç¿»è¯‘ç¡¬ä»¶æ­£å¸¸å¤„ç†äº†ã€‚ 5ã€åˆ†é…é¡µé¢ æ“ä½œç³»ç»Ÿåˆ†é…ä¸€ä¸ªæ–°çš„è™šæ‹Ÿå†…å­˜é¡µæ—¶å¯¹é¡µè¡¨çš„å½±å“ï¼Œä¾‹å¦‚ï¼šè°ƒç”¨malloocï¼Œåœ¨è¿™ä¸ªå®ä¾‹ä¸­ï¼ŒVP5çš„åˆ†é…è¿‡ç¨‹æ˜¯åœ¨ç£ç›˜åˆ›å»ºç©ºé—´å¹¶æ›´æ–°PTE5ï¼Œå¹¶ä½¿å®ƒæŒ‡å‘ç£ç›˜ä¸Šè¿™ä¸ªæ–°åˆ›å»ºçš„é¡µé¢ã€‚æ­¤è¿‡ç¨‹ä¸­å¹¶æ²¡æœ‰åˆ†é…ç‰©ç†å†…å­˜å“¦ã€‚ 9.6 åœ°å€ç¿»è¯‘ åœ°å€ç¿»è¯‘ç¬¦å· MMUåˆ©ç”¨è™šæ‹Ÿåœ°å€åŒ…å«çš„VPNå¯»æ‰¾PTEï¼Œå°†é¡µè¡¨æ¡ç›®ä¸­çš„PPNå’ŒVPOä¸²è”èµ·æ¥å°±å¾—åˆ°å“åº”çš„ç‰©ç†åœ°å€(å› ä¸ºvpå’Œppéƒ½æ˜¯På­—èŠ‚ï¼Œæ‰€ä»¥ç‰©ç†é¡µå’Œè™šæ‹Ÿé¡µçš„åç§»é‡ç›¸åŒ) å½“é¡µé¢å‘½ä¸­æ—¶ï¼ŒCPUç¡¬ä»¶æ‰§è¡Œçš„æ­¥éª¤ï¼š å¤„ç†å™¨ç”Ÿæˆä¸€ä¸ªè™šæ‹Ÿåœ°å€ï¼Œå¹¶æŠŠå®ƒä¼ é€ç»™MMUã€‚ MMUç”ŸæˆPTEåœ°å€ï¼Œå¹¶ä»é«˜é€Ÿç¼“å­˜/ä¸»å­˜è¯·æ±‚å¾—åˆ°å®ƒã€‚ é«˜é€Ÿç¼“å­˜/ä¸»å­˜å‘MMUè¿”å›PTEã€‚ MMUæ„é€ ç‰©ç†åœ°å€ï¼Œå¹¶æŠŠå®ƒä¼ ç»™å‘Šè¯‰ç¼“å­˜/ä¸»å­˜ã€‚ é«˜é€Ÿç¼“å­˜/ä¸»å­˜è¿”å›æ‰€è¯·æ±‚çš„æ•°æ®å­—ç»™å¤„ç†å™¨ã€‚ ç¼ºé¡µï¼ŒCPUç¡¬ä»¶æ‰§è¡Œæ­¥éª¤ï¼š å¤„ç†å™¨ç”Ÿæˆä¸€ä¸ªè™šæ‹Ÿåœ°å€ï¼Œå¹¶æŠŠå®ƒä¼ é€ç»™MMUã€‚ MMUç”ŸæˆPTEåœ°å€ï¼Œå¹¶ä»é«˜é€Ÿç¼“å­˜/ä¸»å­˜è¯·æ±‚å¾—åˆ°å®ƒã€‚ é«˜é€Ÿç¼“å­˜/ä¸»å­˜å‘MMUè¿”å›PTEã€‚ PTEä¸­çš„æœ‰æ•ˆä¸ºæ˜¯0ï¼Œæ‰€ä»¥MMUè§¦å‘äº†ä¸€æ¬¡å¼‚å¸¸ï¼Œä¼ é€’CPUä¸­çš„æ§åˆ¶åˆ°æ“ä½œç³»ç»Ÿå†…æ ¸ä¸­çš„ç¼ºé¡µå¼‚å¸¸å¤„ç†ç¨‹åºã€‚ ç¼ºé¡µå¤„ç†ç¨‹åºç¡®å®šå‡ºç‰©ç†å†…å­˜ä¸­çš„ç‰ºç‰²é¡µï¼Œå¦‚æœè¿™ä¸ªé¡µé¢ä¿®æ”¹äº†åˆ™æŠŠå®ƒæ¢å‡ºåˆ°ç£ç›˜ã€‚ ç¼ºé¡µå¤„ç†ç¨‹åºé¡µé¢è°ƒå…¥æ–°çš„é¡µé¢ï¼Œå¹¶æ›´æ–°å†…å­˜ä¸­çš„PTEã€‚ ç¼ºé¡µå¤„ç†ç¨‹åºè¿”å›åˆ°åŸæ¥çš„è¿›ç¨‹ï¼Œå†æ¬¡æ‰§è¡Œå¯¼è‡´ç¼ºé¡µçš„æŒ‡ä»¤ï¼ŒCPUå°†å¼•èµ·ç¼ºé¡µçš„è™šæ‹Ÿåœ°å€é‡æ–°å‘é€ç»™MMUã€‚ ç»™å®šä¸€ä¸ª32ä½çš„è™šæ‹Ÿåœ°å€ç©ºé—´å’Œä¸€ä¸ª24ä½çš„ç‰©ç†åœ°å€ï¼Œå¯¹äºä¸‹åˆ—é¡µé¢å¤§å°Pã€‚ P VPNä½æ•° VPOä½æ•° PPNä½æ•° PPOä½æ•° 1KB (2^p=1024,p=10) 22 10 14 10 2KB(2^p=2048,p=11) 21 11 13 11 4KB(2^p=4096,p=12) 20 12 12 12 8KB(2^p=8192,p=13) 19 13 11 13 (å¸¸è¯´çš„32ä½å’Œ64ä½æ“ä½œç³»ç»Ÿï¼ŒæŒ‡çš„å°±æ˜¯é¡µè¡¨æ¡ç›®PTEçš„é•¿åº¦ã€‚) 1ã€å¤šçº§é¡µè¡¨åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä¸€ç›´å‡è®¾ç³»ç»Ÿåªç”¨ä¸€ä¸ªå•ç‹¬çš„é¡µè¡¨è¿›è¡Œåœ°å€ç¿»è¯‘ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ª32ä½åœ°å€ç©ºé—´ã€4kbçš„é¡µå’Œä¸€ä¸ª4å­—èŠ‚çš„PTEï¼Œé‚£ä¹ˆå³ä½¿åº”ç”¨æ‰€å¼•ç”¨çš„åªæ˜¯è™šæ‹Ÿç©ºé—´ä¸­å¾ˆå°çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿæ€»æ˜¯éœ€è¦4MBçš„é¡µè¡¨é©»ç•™å†…å­˜ã€‚(32ä½åœ°å€ç©ºé—´ï¼Œæ€»å…±æœ‰2^32ä¸ªå†…å­˜åœ°å€ï¼Œä¸€ä¸ªè™šæ‹Ÿé¡µçš„å¤§å°æ˜¯4KBï¼Œé‚£ä¹ˆæ€»å…±æœ‰ 2^32/2^12=2^20 ä¸ªå†…å­˜é¡µï¼Œä¸€ä¸ªå†…å­˜é¡µéœ€è¦ä¸€ä¸ªPTEï¼Œä¸€ä¸ªPTEæ˜¯4å­—èŠ‚ï¼Œé‚£ä¹ˆé¡µè¡¨æ€»å…±å¤§å°æ˜¯ï¼š2^20 * 2^12 = 2^32å­—èŠ‚ = 2^32 / 2^10 KB = 2^12 / 2^10 MB = 4MBã€‚åœ¨æ²¡æœ‰ä¼˜åŒ–çš„æƒ…å†µä¸‹ï¼Œä¸€å¼ ç‹¬ç«‹é¡µè¡¨åœ¨å†…å­˜ä¸­è¦å ç”¨4Mç‰©ç†å†…å­˜) è®¡ç®—æœºä¸­çš„å­—ï¼ŒåŒå­—ä»¥åŠå­˜å‚¨ å­—èŠ‚(byte)ï¼šä¸€ä¸ªå­—èŠ‚ç”±8ä½äºŒè¿›åˆ¶æ•°ç»„æˆ å­—(word)ï¼š","categories":[{"name":"æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ","slug":"æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ","permalink":"http://blog.3amupupup.online/categories/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/"}],"tags":[{"name":"æ“ä½œç³»ç»Ÿ","slug":"æ“ä½œç³»ç»Ÿ","permalink":"http://blog.3amupupup.online/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"}]},{"title":"Jenkinsfile","slug":"Jenkinsfile","date":"2021-03-18T03:09:52.038Z","updated":"2021-03-18T03:09:52.039Z","comments":true,"path":"2021/03/18/Jenkinsfile/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/Jenkinsfile/","excerpt":"","text":"pipeline { agent any //agentæŒ‡ä»¤æ˜¯å¿…é¡»çš„ï¼Œå®ƒä¸ºjenkinsæµæ°´çº¿åˆ†é…ä¸€ä¸ªæ‰§è¡Œå™¨å’Œå·¥ä½œåŒº stages { stage(&#39;Build&#39;) { steps { echo &#39;Building..&#39; } } stage(&#39;Test&#39;) { steps { echo &#39;Testing..&#39; } } stage(&#39;Deploy&#39;) { steps { echo &#39;Deploying....&#39; } } stage(&#39;Deploy&#39;) { when { expression { currentBuild.result == null || currentBuild.result == &#39;SUCCESS&#39; } } steps { sh &#39;make publish&#39; } } } } jenkinsfileæ”¯æŒä½¿ç”¨å•å¼•å·å’ŒåŒå¼•å·å£°æ˜ä¸€ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯åªæœ‰åŒå¼•å·çš„å­—ç¬¦ä¸²æ‰æ”¯æŒ$ç¬¦çš„å­—ç¬¦ä¸²æ’å…¥å€¼ã€‚ def singlyQuoted = &#39;Hello&#39; def doublyQuoted = &quot;World&quot; def username = &#39;Jenkins&#39; echo &#39;Hello Mr. ${username}&#39; echo &quot;I said, Hello Mr. ${username}&quot; æ‰§è¡Œç»“æœä¸ºï¼š Hello Mr. ${username} I said, Hello Mr. Jenkins ä½¿ç”¨ç¯å¢ƒå˜é‡ ç¬¬ä¸€ç§æ˜¯jenkinsè‡ªå¸¦çš„å…¨å±€å˜é‡ï¼šBUILD_IDã€BUILD_URLã€BUILD_TAGç­‰ pipeline { agent any stages { stage(&#39;Example&#39;) { steps { echo &quot;Running ${env.BUILD_ID} on ${env.JENKINS_URL}&quot; } } } } ç¬¬äºŒç§æ˜¯è‡ªå®šä¹‰çš„ç¯å¢ƒå˜é‡ pipeline { agent any environment { CC = &#39;clang&#39; } stages { stage(&#39;Example&#39;) { environment { DEBUG_FLAGS = &#39;-g&#39; } steps { sh &#39;printenv&#39; } } } } //ç”¨åœ¨æœ€é«˜å±‚çš„ pipeline å—çš„ environment æŒ‡ä»¤é€‚ç”¨äºæµæ°´çº¿çš„æ‰€æœ‰æ­¥éª¤ã€‚ //å®šä¹‰åœ¨ stage ä¸­çš„ environment æŒ‡ä»¤åªé€‚ç”¨äº stage ä¸­çš„æ­¥éª¤ã€‚","categories":[{"name":"è¿ç»´","slug":"è¿ç»´","permalink":"http://blog.3amupupup.online/categories/%E8%BF%90%E7%BB%B4/"}],"tags":[{"name":"Jenkinsfile","slug":"Jenkinsfile","permalink":"http://blog.3amupupup.online/tags/Jenkinsfile/"}]},{"title":"Nginxæ—¥å¿—è·å–header","slug":"Nginxæ—¥å¿—è·å–header","date":"2021-03-18T03:09:52.038Z","updated":"2021-03-18T03:09:52.038Z","comments":true,"path":"2021/03/18/Nginxæ—¥å¿—è·å–header/","link":"","permalink":"http://blog.3amupupup.online/2021/03/18/Nginx%E6%97%A5%E5%BF%97%E8%8E%B7%E5%8F%96header/","excerpt":"","text":"å¯¹äºä¸€ä¸ªå‘é€ç»™nginxçš„è¯·æ±‚ï¼Œå¦‚æœåœ¨æƒ³è¦åœ¨nginxæ—¥å¿—ä¸­è®°å½•headerä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ å°† $http_HeaderName é…ç½®åˆ°æ—¥å¿—æ ¼å¼å³log_formatä¸­ã€‚ log_format headd escape=json &#39;[$time_local] $remote_addr $status $body_bytes_sent $request_time $host $request_method $server_protocol [$http_referer] [$request_body] [$http_user_agent] [$request_uri] &quot;content_type&quot;: &quot;$http_content_type&quot; &quot;androidid&quot;: &quot;$http_androidid&quot; &quot;appsystem&quot;: &quot;$http_appsystem&quot; &quot;brand&quot;: &quot;$http_brand&quot; &quot;brandname&quot;:&quot;http_brandname&quot; &quot;imei&quot;:&quot;$http_imei&quot; &quot;key&quot;: &quot;$http_key&quot; &quot;language&quot;: &quot;$http_language&quot; &quot;mac&quot;:&quot;$http_mac&quot; &quot;manufacturer&quot;: &quot;$http_manufacturer&quot; &quot;model&quot;: &quot;$http_model&quot; &quot;modelname&quot;: &quot;$http_modelname&quot; &quot;os&quot;: &quot;$http_os&quot; &quot;osType&quot;: &quot;$http_osType&quot; &quot;osVersionCode&quot;: &quot;$http_osVersionCode&quot; &quot;osVersionName&quot;: &quot;$http_osVersionName&quot; &quot;platformVersionCode&quot;: &quot;$http_platformVersionCode&quot; &quot;platformVersionName&quot;: &quot;$http_platformVersionName&quot; &quot;product&quot;: &quot;$http_product&quot;&#39;;","categories":[{"name":"è¿ç»´","slug":"è¿ç»´","permalink":"http://blog.3amupupup.online/categories/%E8%BF%90%E7%BB%B4/"}],"tags":[{"name":"Nginx","slug":"Nginx","permalink":"http://blog.3amupupup.online/tags/Nginx/"}]}],"categories":[{"name":"Cè¯­è¨€","slug":"Cè¯­è¨€","permalink":"http://blog.3amupupup.online/categories/C%E8%AF%AD%E8%A8%80/"},{"name":"è¿ç»´","slug":"è¿ç»´","permalink":"http://blog.3amupupup.online/categories/%E8%BF%90%E7%BB%B4/"},{"name":"k8s","slug":"k8s","permalink":"http://blog.3amupupup.online/categories/k8s/"},{"name":"æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ","slug":"æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ","permalink":"http://blog.3amupupup.online/categories/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/"},{"name":"mysql","slug":"mysql","permalink":"http://blog.3amupupup.online/categories/mysql/"},{"name":"Docker","slug":"Docker","permalink":"http://blog.3amupupup.online/categories/Docker/"}],"tags":[{"name":"nginx","slug":"nginx","permalink":"http://blog.3amupupup.online/tags/nginx/"},{"name":"æ’åº","slug":"æ’åº","permalink":"http://blog.3amupupup.online/tags/%E6%8E%92%E5%BA%8F/"},{"name":"sonar","slug":"sonar","permalink":"http://blog.3amupupup.online/tags/sonar/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://blog.3amupupup.online/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"name":"ecs","slug":"ecs","permalink":"http://blog.3amupupup.online/tags/ecs/"},{"name":"linuxæ€§èƒ½ä¼˜åŒ–å®æˆ˜ç¬”è®°","slug":"linuxæ€§èƒ½ä¼˜åŒ–å®æˆ˜ç¬”è®°","permalink":"http://blog.3amupupup.online/tags/linux%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E7%AC%94%E8%AE%B0/"},{"name":"cicd","slug":"cicd","permalink":"http://blog.3amupupup.online/tags/cicd/"},{"name":"è™šæ‹Ÿå†…å­˜","slug":"è™šæ‹Ÿå†…å­˜","permalink":"http://blog.3amupupup.online/tags/%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98/"},{"name":"è¿›ç¨‹","slug":"è¿›ç¨‹","permalink":"http://blog.3amupupup.online/tags/%E8%BF%9B%E7%A8%8B/"},{"name":"book","slug":"book","permalink":"http://blog.3amupupup.online/tags/book/"},{"name":"mongodb","slug":"mongodb","permalink":"http://blog.3amupupup.online/tags/mongodb/"},{"name":"c primer plus","slug":"c-primer-plus","permalink":"http://blog.3amupupup.online/tags/c-primer-plus/"},{"name":"c","slug":"c","permalink":"http://blog.3amupupup.online/tags/c/"},{"name":"sql_base","slug":"sql-base","permalink":"http://blog.3amupupup.online/tags/sql-base/"},{"name":"kubectl","slug":"kubectl","permalink":"http://blog.3amupupup.online/tags/kubectl/"},{"name":"Nginx","slug":"Nginx","permalink":"http://blog.3amupupup.online/tags/Nginx/"},{"name":"zabbix","slug":"zabbix","permalink":"http://blog.3amupupup.online/tags/zabbix/"},{"name":"cè¯­è¨€åŸºç¡€","slug":"cè¯­è¨€åŸºç¡€","permalink":"http://blog.3amupupup.online/tags/c%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80/"},{"name":"Dockerfile","slug":"Dockerfile","permalink":"http://blog.3amupupup.online/tags/Dockerfile/"},{"name":"jenkins","slug":"jenkins","permalink":"http://blog.3amupupup.online/tags/jenkins/"},{"name":"æ“ä½œç³»ç»Ÿ","slug":"æ“ä½œç³»ç»Ÿ","permalink":"http://blog.3amupupup.online/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"},{"name":"Jenkinsfile","slug":"Jenkinsfile","permalink":"http://blog.3amupupup.online/tags/Jenkinsfile/"}]}